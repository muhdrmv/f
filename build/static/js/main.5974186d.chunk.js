(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[0],{389:function(e,t,n){},543:function(e,t,n){},564:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),i=n(49),s=n.n(i),c=(n(543),n(388),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,694)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),i(e),s(e)}))}),o=n(22),l=n(7),d=(n(389),n(5)),u=n(8),b=n.n(u),j=n(13),p=n(11),m=n(165),O=n(60),h=n(25),g=n(10),x=n(132),f=n(668),v=n(97),_=n(669),y=n(565),w=n(352),k=n(617),S=n(487),C=n(637),T=n(691),N=n(670),P=n(624),D=n(673),I=n(572),$=n(618),A=n(667),F=n(482),U=n.n(F),M=n(484),L=n.n(M),E=n(483),q=n.n(E),R=n(151),B=n.n(R),W=n(0);var z=n(255),G=(n(452),n(238)),K=n.n(G),H=n(100),V=n.n(H);Object(x.a)({depositContext:{flex:1}});var Y,Q,J,X=n(377),Z=n(111),ee=n(619),te=n(348),ne=n.n(te),ae=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=ne()(e).locale("fa").format("HH:mm:ss"),a=ne()(e).locale("fa").format("YYYY/MM/DD"),r=ne()(e).locale("en").format("ddd");return"".concat(a," ").concat(r," ").concat(t?n:"")}catch(i){return"N/A"}},re=function(e,t){e.document.addEventListener("mousemove",t,!0),e.document.addEventListener("mousedown",t,!0),e.document.addEventListener("mouseup",t,!0),e.document.addEventListener("keydown",t),e.document.addEventListener("keyup",t)},ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=1024,a=t<0?0:t,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(1024*e)/Math.log(n));return parseFloat((1024*e/Math.pow(n,i)).toFixed(a))+" "+r[i]},se=n(34),ce=n(299),oe=n.n(ce),le=n(300),de=n.n(le),ue=Object(x.a)((function(e){return{root:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(se.f)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}})),be=function(e){var t,n=ue(),a=e.toolbarTitle,r=e.backLinkUrl,i=e.onClickDone,s=e.inProgress,c=e.toolbarIcon,l=e.extraIcons;return l&&(t=l),Object(W.jsxs)(y.a,{className:n.root,children:[Object(W.jsxs)(v.a,{className:n.title,variant:"h6",id:"tableTitle",component:"div",style:{textAlign:"left"},children:[c,a]}),r&&Object(W.jsx)(k.a,{title:"Back",children:Object(W.jsx)(w.a,{"aria-label":"back",component:o.b,to:r,children:Object(W.jsx)(oe.a,{})})}),i&&Object(W.jsx)(k.a,{title:"Done",children:s?Object(W.jsx)(w.a,{"aria-label":"Done",color:"primary",children:Object(W.jsx)($.a,{size:24})}):Object(W.jsx)(w.a,{"aria-label":"Done",onClick:i,color:"primary",children:Object(W.jsx)(de.a,{})})}),l&&Object(W.jsx)(t,{})]})},je=n(498),pe=n(306),me=n.n(pe),Oe=(Object(x.a)((function(e){return{container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},parentPaper:{backgroundColor:"#eeeeee",padding:e.spacing(2)}}})),Object(Z.b)(Y||(Y=Object(p.a)(["\nquery ($user_id: uuid!) {\n  \n  access_rules(where: {access_rule_users: {user_id: {_eq: $user_id}}}) {\n    \n    id\n    name\n    \n    # user to connection\n    access_rule_connections {\n      connection {\n        id\n        name\n        protocol\n        hostname\n        meta\n      }\n    }\n    \n    # user to connection_group to connection\n    access_rule_connection_groups {\n      connection_group {\n        connection_group_connections {\n          connection {\n            id\n            name\n            protocol\n            hostname  \n            meta          \n          }\n        }\n      }\n    }\n  }\n\n  user_group_user(where: {user_id: {_eq: $user_id}}) {\n    user_group {\n      access_rule_user_groups {\n        access_rule {\n          \n          id\n          name\n          \n          # user to user_group to connection\n          access_rule_connections {\n            connection {\n              id\n              name\n              protocol\n              hostname       \n              meta     \n            }       \n          }\n          \n          # user to user_group to connection_group to connection\n          access_rule_connection_groups {\n            connection_group {\n              connection_group_connections {\n                connection {\n                  id\n                  name\n                  protocol\n                  hostname      \n                  meta      \n                }\n              }\n            }            \n          }\n          \n        }\n      }\n    }\n  }\n}\n\n"]))),Object(Z.b)(Q||(Q=Object(p.a)(["\n\n  query Query($user_id: uuid!, $filter: String!) {\n    access_rules( \n      where: { \n        _and: [ \n          { access_rule_users: {user_id: {_eq: $user_id}}}, \n          { _or: [\n            { access_rule_connections: {connection: {name: {_ilike: $filter}}}},\n            { access_rule_connection_groups: {connection_group: {connection_group_connections: {connection: {name: {_ilike: $filter}}}}}}\n          ]}\n        ]\n      } \n    ){\n\n      id\n      name\n      access_rule_connections (where: {connection: {name: {_ilike: $filter}}}){\n        connection {\n          id\n          name\n          protocol\n          hostname\n          meta\n        }\n      }\n      access_rule_connection_groups (where: {connection_group: {connection_group_connections: {connection: {name: {_ilike: $filter}}}}}) {\n        connection_group {\n          connection_group_connections {\n            connection {\n              id\n              name\n              protocol\n              hostname\n              meta\n            }\n          }\n        }\n      }\n    }\n\n\n\n    user_group_user(\n      where: { \n        user_id: {_eq: $user_id}, \n      }\n    ){\n      user_group {\n        access_rule_user_groups {\n          access_rule {\n            \n            id\n            name\n            \n            # user to user_group to connection\n            access_rule_connections (where: {connection: {name: {_ilike: $filter}}}) {\n              connection {\n                id\n                name\n                protocol\n                hostname       \n                meta     \n              }       \n            }\n            \n            # user to user_group to connection_group to connection\n            access_rule_connection_groups {\n              connection_group {\n                connection_group_connections (where: {connection: {name: {_ilike: $filter }}}) {\n                  connection {\n                    id\n                    name\n                    protocol\n                    hostname      \n                    meta      \n                  }\n                }\n              }            \n            }\n            \n          }\n        }\n      }\n    }\n  }\n"]))),n(70)),he=n(625),ge=n(570),xe=n(626),fe=n(627),ve=n(244),_e=n.n(ve),ye=n(307),we=n.n(ye),ke=n(120),Se=n.n(ke),Ce=n(191),Te=n.n(Ce),Ne=n(455),Pe=n.n(Ne),De=n(456),Ie=n.n(De),$e=n(167),Ae=n.n($e),Fe=n(347),Ue=n(104),Me=n.n(Ue),Le=n(309),Ee=n.n(Le),qe=n(93),Re=n.n(qe),Be=n(308),We=n.n(Be),ze=n(168),Ge=n.n(ze),Ke=Object(Z.a)(J||(J=Object(p.a)(['\nquery MyQuery {\n  settings(where: {name: {_eq: "roleOfTicketsManagement"}}) {\n    value\n  }\n}\n']))),He=function(e){var t=e.loggedInUser;console.log(t);var n=Object(Oe.h)(),i=Object(ee.a)(Ke,{variables:{},notifyOnNetworkStatusChange:!0}).data,s=r.a.useState(["administrator"]),c=Object(d.a)(s,2),l=c[0],u=c[1];return Object(a.useEffect)((function(){i&&u((function(e){var t,n;return[].concat(Object(O.a)(e),[null===i||void 0===i||null===(t=i.settings)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.value])}))}),[i]),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(he.a,{}),Object(W.jsxs)("div",{children:[Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard",style:{backgroundColor:"/dashboard"===n.pathname?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Pe.a,{})}),Object(W.jsx)(fe.a,{primary:"Dashboard"})]}),["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/users",style:{backgroundColor:n.pathname.startsWith("/dashboard/users")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(B.a,{})}),Object(W.jsx)(fe.a,{primary:"Users"})]}),Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/user-groups",style:{backgroundColor:n.pathname.startsWith("/dashboard/user-groups")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(we.a,{})}),Object(W.jsx)(fe.a,{primary:"User Groups"})]}),Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/connections",style:{backgroundColor:n.pathname.startsWith("/dashboard/connections")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Se.a,{})}),Object(W.jsx)(fe.a,{primary:"Connections"})]}),Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/connection-groups",style:{backgroundColor:n.pathname.startsWith("/dashboard/connection-groups")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Te.a,{})}),Object(W.jsx)(fe.a,{primary:"Connection Groups"})]}),Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/access-rules",style:{backgroundColor:n.pathname.startsWith("/dashboard/access-rules")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(V.a,{})}),Object(W.jsx)(fe.a,{primary:"Access Rules"})]}),Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/notifications",style:{backgroundColor:n.pathname.startsWith("/dashboard/notifications")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Re.a,{})}),Object(W.jsx)(fe.a,{primary:"Notifications"})]})]}),l.includes(t.role)&&Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/tickets",style:{backgroundColor:n.pathname.startsWith("/dashboard/tickets")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(We.a,{})}),Object(W.jsx)(fe.a,{primary:"Tickets"})]})]}),Object(W.jsx)(he.a,{}),Object(W.jsxs)("div",{children:[["administrator","moderator"].includes(t.role)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/network-tools",style:{backgroundColor:n.pathname.startsWith("/dashboard/network-tools")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Ee.a,{})}),Object(W.jsx)(fe.a,{primary:"Network Tools"})]})}),["sessionMonitoring"].includes(t.role)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/live-sessions",style:{backgroundColor:n.pathname.startsWith("/dashboard/live-sessions")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(_e.a,{})}),Object(W.jsx)(fe.a,{primary:"Live Sessions"})]})}),["administrator","auditor"].includes(t.role)&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/live-sessions",style:{backgroundColor:n.pathname.startsWith("/dashboard/live-sessions")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(_e.a,{})}),Object(W.jsx)(fe.a,{primary:"Live Sessions"})]}),Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/sessions-history",style:{backgroundColor:n.pathname.startsWith("/dashboard/sessions-history")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Ae.a,{})}),Object(W.jsx)(fe.a,{primary:"Sessions History"})]})]}),["administrator","moderator","auditor"].includes(t.role)&&Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/logs",style:{backgroundColor:n.pathname.startsWith("/dashboard/logs")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Me.a,{})}),Object(W.jsx)(fe.a,{primary:"System Logs"})]}),["administrator","moderator"].includes(t.role)&&Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/user-behavior-analytics",style:{backgroundColor:n.pathname.startsWith("/dashboard/user-behavior-analytics")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Ge.a,{})}),Object(W.jsx)(fe.a,{primary:"UBA"})]}),["administrator","moderator"].includes(t.role)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(ge.a,{button:!0,component:o.b,to:"/dashboard/settings",style:{backgroundColor:n.pathname.startsWith("/dashboard/settings")?Fe.a[50]:""},children:[Object(W.jsx)(xe.a,{children:Object(W.jsx)(Ie.a,{})}),Object(W.jsx)(fe.a,{primary:"Settings"})]})})]})]})},Ve=n(632),Ye=n(82),Qe=n.n(Ye),Je=n(684),Xe=n(571),Ze=n(574),et=n(573),tt=n(629),nt=n(628),at=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function rt(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=at(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var it=n(635),st=n(636),ct=n(633),ot=n(630),lt=n(680),dt=n(631),ut=n(688),bt=n(679),jt=n(312),pt=n.n(jt),mt=n(170),Ot=n.n(mt),ht=n(457),gt=n.n(ht),xt=n(634);function ft(e,t,n){if((null===e||void 0===e?void 0:e.user)&&(null===t||void 0===t?void 0:t.user)&&"username"==n){if((null===t||void 0===t?void 0:t.user[n])<(null===e||void 0===e?void 0:e.user[n]))return-1;if((null===t||void 0===t?void 0:t.user[n])>(null===e||void 0===e?void 0:e.user[n]))return 1}if((null===e||void 0===e?void 0:e.connection)&&(null===t||void 0===t?void 0:t.connection)&&"connection"==n){var a,r,i,s;if((null===t||void 0===t||null===(a=t.connection)||void 0===a?void 0:a.name)<(null===e||void 0===e||null===(r=e.connection)||void 0===r?void 0:r.name))return-1;if((null===t||void 0===t||null===(i=t.connection)||void 0===i?void 0:i.name)>(null===e||void 0===e||null===(s=e.connection)||void 0===s?void 0:s.name))return 1}return t[n]<e[n]?-1:t[n]>e[n]?1:0}function vt(e,t){return"desc"===e?function(e,n){return ft(e,n,t)}:function(e,n){return-ft(e,n,t)}}function _t(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))}function yt(e){var t=e.classes,n=e.onSelectAllClick,a=e.order,r=e.orderBy,i=e.numSelected,s=e.rowCount,c=e.onRequestSort,o=e.headCells,l=e.rowsSelectable;return Object(W.jsx)(ot.a,{children:Object(W.jsxs)(dt.a,{children:[!1!==l&&Object(W.jsx)(Ve.a,{padding:"checkbox",children:Object(W.jsx)(bt.a,{indeterminate:i>0&&i<s,checked:s>0&&i===s,onChange:n,inputProps:{"aria-label":"select all desserts"}})}),o.map((function(e){return Object(W.jsx)(Ve.a,{align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",sortDirection:r===e.id&&a,children:e.notSortable?Object(W.jsx)(W.Fragment,{children:e.label}):Object(W.jsxs)(ut.a,{active:r===e.id,direction:r===e.id?a:"asc",onClick:(n=e.id,function(e){c(e,n)}),children:[e.label,r===e.id?Object(W.jsx)("span",{className:t.visuallyHidden,children:"desc"===a?"sorted descending":"sorted ascending"}):null]})},e.id);var n}))]})})}var wt=Object(x.a)((function(e){return{root:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(se.f)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}})),kt=function(e){var t=wt(),n=e.numSelected,a=e.onClickRefresh,r=e.onClickFilter,i=e.addLinkUrl,s=e.onClickDelete,c=e.tableTitle,l=e.rowsAddable,d=e.rowsFilterable,u=e.toolbarIcon,b=e.extraToolbar;return Object(W.jsxs)(y.a,{className:Object(g.a)(t.root,Object(h.a)({},t.highlight,n>0)),children:[n>0?Object(W.jsxs)(v.a,{className:t.title,color:"inherit",variant:"subtitle1",component:"div",children:[n," selected"]}):Object(W.jsxs)(v.a,{className:t.title,variant:"h6",id:"tableTitle",component:"div",style:{textAlign:"left"},children:[u,c]}),n>0?Object(W.jsx)(k.a,{title:"Delete",children:Object(W.jsx)(w.a,{"aria-label":"delete",onClick:s,children:Object(W.jsx)(pt.a,{})})}):Object(W.jsxs)(W.Fragment,{children:[b&&Object(W.jsx)(b,{}),Object(W.jsx)(k.a,{title:"Refresh",children:Object(W.jsx)(w.a,{"aria-label":"refresh",onClick:a,children:Object(W.jsx)(Ot.a,{})})}),!1!==d&&Object(W.jsx)(k.a,{title:"Filter",children:Object(W.jsx)(w.a,{"aria-label":"filter",onClick:r,children:Object(W.jsx)(me.a,{})})}),!1!==l&&Object(W.jsx)(k.a,{title:"Add",children:Object(W.jsx)(w.a,{"aria-label":"add",component:o.b,to:i,children:Object(W.jsx)(gt.a,{})})})]})]})},St=Object(x.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(1)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Ct(e){var t=e.rows,n=e.showProgress,i=e.showFilterPanel,s=e.onClickRefresh,c=e.onClickFilter,o=e.addLinkUrl,u=e.onChangeFilterText,b=e.onClickDelete,j=e.tableTitle,p=e.headCells,m=e.rowCells,O=e.rowsSelectable,h=e.rowsAddable,g=e.rowsFilterable,x=e.toolbarIcon,f=e.extraToolbar,v=e.customFilter,_=e.customFilterProps,y=m,w=St(),k=r.a.useState("asc"),S=Object(d.a)(k,2),C=S[0],T=S[1],N=r.a.useState(""),P=Object(d.a)(N,2),D=P[0],I=P[1],$=r.a.useState([]),A=Object(d.a)($,2),F=A[0],U=A[1],M=r.a.useState(0),L=Object(d.a)(M,2),E=L[0],q=L[1],R=r.a.useState(!0),B=Object(d.a)(R,2),z=B[0],G=(B[1],r.a.useState(10)),K=Object(d.a)(G,2),H=K[0],V=K[1];Object(a.useEffect)((function(){U([])}),[t]);var Y=H-Math.min(H,t.length-E*H),Q=v;return Object(W.jsxs)("div",{className:w.root,children:[i&&Object(W.jsxs)(X.a,{className:w.paper,children:[v&&Object(W.jsx)(Q,Object(l.a)({},_)),!v&&Object(W.jsx)("div",{children:Object(W.jsx)(je.a,{id:"outlined-basic",label:"Search",variant:"outlined",autoFocus:!0,onChange:u,style:{margin:"1%",width:"98%"}})})]}),Object(W.jsxs)(X.a,{className:w.paper,children:[Object(W.jsx)(kt,{rowsAddable:h,rowsFilterable:g,numSelected:F.length,onClickRefresh:s,onClickFilter:c,onClickDelete:function(e,t){b(F)},addLinkUrl:o,tableTitle:j,toolbarIcon:x,extraToolbar:f}),Object(W.jsxs)(ct.a,{children:[n&&Object(W.jsx)(xt.a,{}),Object(W.jsxs)(it.a,{className:w.table,"aria-labelledby":"tableTitle",size:z?"small":"medium","aria-label":"enhanced table",children:[Object(W.jsx)(yt,{classes:w,numSelected:F.length,order:C,orderBy:D,onSelectAllClick:function(e){if(e.target.checked){var n=t.map((function(e){return e.id}));U(n)}else U([])},onRequestSort:function(e,t){T(D===t&&"asc"===C?"desc":"asc"),I(t)},rowCount:t.length,headCells:p,rowsSelectable:O}),Object(W.jsxs)(st.a,{children:[_t(t,vt(C,D)).slice(E*H,E*H+H).map((function(e,t){var n,a=(n=e.id,-1!==F.indexOf(n)),r="enhanced-table-checkbox-".concat(t);return Object(W.jsxs)(dt.a,{hover:!0,onClick:function(t){return function(e,t){if(!1!==O){var n=F.indexOf(t),a=[];-1===n?a=a.concat(F,t):0===n?a=a.concat(F.slice(1)):n===F.length-1?a=a.concat(F.slice(0,-1)):n>0&&(a=a.concat(F.slice(0,n),F.slice(n+1))),U(a)}}(0,e.id)},role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,children:[!1!==O&&Object(W.jsx)(Ve.a,{padding:"checkbox",children:Object(W.jsx)(bt.a,{checked:a,inputProps:{"aria-labelledby":r}})}),Object(W.jsx)(y,{row:e})]},e.id)})),Y>0&&Object(W.jsx)(dt.a,{style:{height:(z?13:53)*Y},children:Object(W.jsx)(Ve.a,{colSpan:6})})]})]})]}),Object(W.jsx)(lt.a,{rowsPerPageOptions:[5,10,50,100],component:"div",count:t.length,rowsPerPage:H,page:E,onChangePage:function(e,t){q(t)},onChangeRowsPerPage:function(e){V(parseInt(e.target.value,10)),q(0)}})]})]})}var Tt,Nt,Pt,Dt=n(214),It=n.n(Dt),$t=n(215),At=n.n($t),Ft=n(314),Ut=n.n(Ft),Mt=n(641),Lt=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}}}})),Et=Object(Z.b)(Tt||(Tt=Object(p.a)(["\nquery {\n  users(\n    order_by: {created_at: desc}\n  ) {\n    id\n    username\n    name\n    role\n    meta\n  }\n}\n"]))),qt=Object(Z.b)(Nt||(Nt=Object(p.a)(["\nquery Query($filter: String!) {\n  users(\n    order_by: {created_at: desc}, \n    where: {\n    _or: [\n      {name: {_like: $filter}}, \n      {username: {_like: $filter}}\n    ]\n  }) {\n    id\n    username\n    name\n    role\n    meta\n  }\n}\n"]))),Rt=Object(Z.b)(Pt||(Pt=Object(p.a)(["\nmutation ($ids: [uuid!]) {\n  delete_users(where: {id: {_in: $ids}}) {\n    affected_rows\n  }\n}\n"]))),Bt=[{id:"edit",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"username",numeric:!1,disablePadding:!1,label:"Username"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"role",numeric:!1,disablePadding:!1,label:"Role"},{id:"authentication-type",numeric:!1,disablePadding:!1,label:"Authentication"}],Wt=function(e){var t,n=e.loggedInUser,r=Lt(),i=Object(a.useState)(!1),s=Object(d.a)(i,2),c=s[0],l=s[1],u=Object(a.useState)(Et),p=Object(d.a)(u,2),m=p[0],O=p[1],h=Object(a.useState)(!1),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)({}),_=Object(d.a)(v,2),y=_[0],S=_[1],C=Object(ee.a)(m,{variables:y,notifyOnNetworkStatusChange:!0}),T=C.loading,N=(C.error,C.data),P=C.refetch,D=Object(Je.a)(Rt),I=Object(d.a)(D,1)[0];Object(a.useEffect)((function(){$()}),[x]),Object(a.useEffect)((function(){P()}),[]);var $=function(e){x&&e&&""!==e.target.value.trim()?A("%"+e.target.value.trim()+"%"):F()},A=function(e){O(qt),S({filter:e})},F=function(){O(Et),S({})},U=Object(Oe.g)(),M=function(e){U.push("/dashboard/users/"+e)},L=Object(a.useState)([]),E=Object(d.a)(L,2),q=E[0],R=E[1],z=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting"),console.log(q),e.next=4,I({variables:{ids:q}});case 4:return e.next=6,P();case 6:l(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(e){var t=e.onClick;return Object(W.jsx)(k.a,{title:"Edit",children:Object(W.jsx)(w.a,{onClick:t,color:"primary","aria-label":"edit",children:Object(W.jsx)(Qe.a,{fontSize:"small"})})})};return Object(W.jsxs)("div",{className:r.root,children:[Object(W.jsx)(Ct,{tableTitle:"Users",rows:null!==(t=null===N||void 0===N?void 0:N.users)&&void 0!==t?t:[],showProgress:T,headCells:Bt,rowCells:function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(Ve.a,{align:"right",style:{width:180},children:["administrator"===n.role&&Object(W.jsx)(G,{onClick:function(e){return M(t.id)}}),"moderator"===n.role&&["user","supervisor","moderator"].includes(t.role)&&Object(W.jsx)(G,{onClick:function(e){return M(t.id)}}),"supervisor"===n.role&&["user","supervisor"].includes(t.role)&&Object(W.jsx)(G,{onClick:function(e){return M(t.id)}}),Object(W.jsx)(k.a,{title:"Details",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void U.push("/dashboard/users/"+n+"/view");var n},color:"primary","aria-label":"edit",children:Object(W.jsx)(Me.a,{fontSize:"small"})})}),Object(W.jsx)(k.a,{title:"Access Rules",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void U.push("/dashboard/users/"+n+"/access-rules");var n},color:"primary","aria-label":"edit",children:Object(W.jsx)(Mt.a,{fontSize:"small"})})})]}),Object(W.jsx)(Ve.a,{children:t.username}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.role}),Object(W.jsxs)(Ve.a,{align:"right",style:{width:50,textAlign:"center"},children:["internal"===t.meta.authType&&Object(W.jsx)(k.a,{title:"Internal",children:Object(W.jsx)(It.a,{fontSize:"small"})}),"external"===t.meta.authType&&Object(W.jsx)(k.a,{title:"External",children:Object(W.jsx)(At.a,{fontSize:"small"})})]})]})},onClickDelete:function(e){console.log(e),R(e),l(!0)},onClickRefresh:function(){P()},onClickFilter:function(){f((function(e){return!e}))},showFilterPanel:x,onChangeFilterText:$,addLinkUrl:"/dashboard/users/add",extraToolbar:function(){return Object(W.jsx)(k.a,{title:"Locked users",children:Object(W.jsx)(w.a,{"aria-label":"refresh",component:o.b,to:"users-locked",children:Object(W.jsx)(Ut.a,{})})})},toolbarIcon:Object(W.jsx)(B.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(rt,{isOpen:c,closeMe:function(){l(!1)},onConfirm:z,itemsCount:q.length})]})},zt=n(682),Gt=n(681),Kt=n(459),Ht=n.n(Kt),Vt=n(460),Yt=n.n(Vt),Qt=Object(W.jsx)(Ht.a,{fontSize:"small"}),Jt=Object(W.jsx)(Yt.a,{fontSize:"small"});function Xt(e){var t=e.id,n=e.label,a=e.placeholder,i=e.items,s=e.selectedIds,c=e.onChange,o=i.filter((function(e){return s.includes(e.id)})).sort((function(e,t){return s.indexOf(e.id)>s.indexOf(t.id)?1:-1}));return Object(W.jsx)(Gt.a,{multiple:!0,id:t,options:i,value:o,onChange:c,disableCloseOnSelect:!0,getOptionLabel:function(e){return e.title},renderOption:function(e,t){var n=t.selected;return Object(W.jsxs)(r.a.Fragment,{children:[Object(W.jsx)(bt.a,{icon:Qt,checkedIcon:Jt,style:{marginRight:8},checked:n}),e.title]})},renderInput:function(e){return Object(W.jsx)(je.a,Object(l.a)(Object(l.a)({},e),{},{variant:"outlined",label:n,placeholder:a}))}})}var Zt,en,tn,nn,an,rn,sn,cn,on,ln=n(645),dn=n(646),un=Object(x.a)((function(e){return{formFooter:{textAlign:"right",padding:e.spacing(1)},wrapper:{margin:e.spacing(1),position:"relative",display:"inline"},buttonProgress:{color:e.palette.primary.main,position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),bn=function(e){var t=un(),n=e.backLinkUrl,a=e.onClickDone,r=e.inProgress,i=e.extraButtons;return Object(W.jsxs)("div",{className:t.formFooter,children:[n&&Object(W.jsx)(z.a,{component:o.b,to:n,size:"large",style:{marginRight:7,marginLeft:7},children:"Back"}),i&&Object(W.jsx)(i,{}),Object(W.jsxs)("div",{className:t.wrapper,children:[Object(W.jsx)(z.a,{color:"primary",onClick:a,size:"large",disabled:r,children:"Done"}),r&&Object(W.jsx)($.a,{size:24,className:t.buttonProgress})]})]})},jn=n(461),pn=n.n(jn),mn=n(622),On=n(647),hn=n(648),gn=n(649),xn=n(71),fn=n(254),vn=n(488),_n=n(642),yn=n(245),wn=n.n(yn),kn=function(e){var t={};return e.value&&(t={startAdornment:Object(W.jsx)(w.a,{onClick:function(t){t.stopPropagation(),e.onChange(null)},style:{order:1},children:Object(W.jsx)(wn.a,{color:"disabled",fontSize:"small"})})}),Object(W.jsx)(xn.a,{utils:vn.a,children:Object(W.jsx)(_n.a,Object(l.a)({inputVariant:"outlined",autoOk:!0,fullWidth:!0,disableToolbar:!0,variant:"inline",format:"jYYYY-jMM-jDD",margin:"normal",InputProps:t,InputAdornmentProps:{position:"end",style:{order:2,marginLeft:0}}},e))})},Sn=n(576),Cn=n(643),Tn=n(644),Nn=function(e){var t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],i=n[1];return Object(W.jsx)(je.a,Object(l.a)({type:r?"text":"password",InputProps:{endAdornment:Object(W.jsx)(Sn.a,{position:"end",children:Object(W.jsx)(w.a,{"aria-label":"toggle password visibility",onClick:function(){return i(!r)},children:r?Object(W.jsx)(Cn.a,{}):Object(W.jsx)(Tn.a,{})})})}},e))},Pn=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),Dn=Object(Z.b)(Zt||(Zt=Object(p.a)(["\nquery ($id: uuid!) {\n  users_by_pk(id: $id){\n    id\n    username\n    password\n    name\n    role\n    meta\n    user_group_users {\n        user_group_id\n    }\n  }\n}\n"]))),In=Object(Z.b)(en||(en=Object(p.a)(["\nquery ($username: String!) {\n  users(where: {username: {_eq: $username}}){\n    id\n  }\n}\n"]))),$n=Object(Z.b)(tn||(tn=Object(p.a)(["\nmutation ($username: String!, $name: String!, $password: String!, $role: String!, $meta: jsonb!, $user_groups: [user_group_user_insert_input!]!) {\n  insert_users(objects: {\n      username: $username, \n      name: $name, \n      password: $password, \n      role: $role, \n      meta: $meta,\n      user_group_users: {data: $user_groups},\n    }) {\n    returning {\n      id\n    }\n  }\n}\n"]))),An=Object(Z.b)(nn||(nn=Object(p.a)(["\nmutation ($username: String!, $name: String!, $password: String!, $role: String!, $meta: jsonb!, $user_groups: [user_group_user_insert_input!]!, $id: uuid!) {\n  update_users_by_pk(pk_columns: {id: $id}, _set: {\n      username: $username, \n      name: $name, \n      password: $password, \n      role: $role,\n      meta: $meta,\n    }) {\n    id\n  }\n  delete_user_group_user (where: {user_id: {_eq: $id}}) {\n    affected_rows\n  }\n  insert_user_group_user (objects: $user_groups) {\n    affected_rows\n  }\n}\n"]))),Fn=Object(Z.b)(an||(an=Object(p.a)(["\nquery {\n  user_groups {\n    id\n    name\n  }\n}\n"]))),Un=Object(Z.b)(rn||(rn=Object(p.a)(["\n  mutation ($userId: uuid!, $accountPassword: String!, $oneTimePassword: String!, $secret: String!) {\n    action_auth_set_2fa(userId: $userId, accountPassword: $accountPassword, oneTimePassword: $oneTimePassword, secret: $secret) {\n      success\n    }\n  }\n"]))),Mn=function(e){var t=e.insertMode,n=void 0!==t&&t,r=e.loggedInUser,i=Pn(),s=Object(a.useState)(!1),c=Object(d.a)(s,2),o=c[0],u=c[1],p=Object(a.useState)(""),m=Object(d.a)(p,2),O=m[0],h=m[1],g=Object(a.useState)([]),x=Object(d.a)(g,2),f=x[0],v=x[1],_=Object(a.useState)([]),y=Object(d.a)(_,2),w=y[0],k=y[1],S=Object(a.useState)({name:"",firstname:"",lastname:"",username:"",authType:"internal",isDisabled:!1,auth2FASecret:null,mustChangePassword:!0,expiresAt:null,allowedIPAddress:"",password:"",passwordConfirm:"",currentPassword:"",role:"user"}),T=Object(d.a)(S,2),N=T[0],D=T[1],I=Object(a.useState)({username:!1,password:!1,passwordConfirm:!1}),$=Object(d.a)(I,2),A=$[0],F=$[1],U=Object(a.useState)({isOpen:!1,message:""}),M=Object(d.a)(U,2),L=M[0],E=M[1],q=Object(Oe.i)().id;Object(ee.a)(Fn,{onCompleted:function(e){var t=e.user_groups.map((function(e){return{id:e.id,title:e.name}}));k(t)}});var R=Object(ln.a)(Dn,{variables:{id:q}}),B=Object(d.a)(R,2),G=B[0],K=B[1].data;Object(a.useEffect)((function(){n||G()}),[]),Object(a.useEffect)((function(){if(K){var e=K.users_by_pk;h(e.username);var t=e.user_group_users.map((function(e){return e.user_group_id}));v(t),u(!1),D((function(t){var n,a,r;return Object(l.a)(Object(l.a)({},t),{},{name:e.name,firstname:null===(n=e.name.split("\n"))||void 0===n?void 0:n[0],lastname:null===(a=e.name.split("\n"))||void 0===a?void 0:a[1],username:e.username,role:e.role,authType:e.meta.authType,isDisabled:e.meta.isDisabled,auth2FASecret:e.meta.auth2FASecret,mustChangePassword:e.meta.mustChangePassword,allowedIPAddress:e.meta.allowedIPAddress,expiresAt:null!==(r=e.meta.expiresAt)&&void 0!==r?r:null,currentPassword:e.password})}))}else!n&&u(!0)}),[K]);var H=Object(Je.a)($n),V=Object(d.a)(H,1)[0],Y=Object(Je.a)(An),Q=Object(d.a)(Y,1)[0],J=Object(dn.a)(),Z=Object(Oe.g)(),te=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.query({query:In,variables:{username:t}});case 2:return r=e.sent,e.abrupt("return",null===r||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.users)||void 0===a?void 0:a.length);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(j.a)(b.a.mark((function e(t){var a,r,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==N.username.trim()){e.next=3;break}return F((function(e){return Object(l.a)(Object(l.a)({},e),{},{username:!0})})),e.abrupt("return");case 3:if(!n||"internal"!==N.authType||""!==N.password&&N.password===N.passwordConfirm){e.next=6;break}return F((function(e){return Object(l.a)(Object(l.a)({},e),{},{password:!0,passwordConfirm:!0})})),e.abrupt("return");case 6:if(n||"internal"!==N.authType||N.password===N.passwordConfirm){e.next=9;break}return F((function(e){return Object(l.a)(Object(l.a)({},e),{},{password:!0,passwordConfirm:!0})})),e.abrupt("return");case 9:if(a=f.map((function(e){return{user_id:q,user_group_id:e}})),"xJrH2hht",r=(new pn.a.SHA1).hex("xJrH2hht"+N.password),i=""===N.password?N.currentPassword:r,u(!0),e.prev=14,e.t0=N.username!==O,!e.t0){e.next=20;break}return e.next=19,te(N.username);case 19:e.t0=e.sent;case 20:if(!e.t0){e.next=23;break}throw alert('A user already exists with username "'.concat(N.username,'"')),Error("Duplicate username");case 23:if(!n){e.next=29;break}return e.next=26,V({variables:{name:N.firstname+"\n"+N.lastname,username:N.username,password:i,role:N.role,meta:{authType:N.authType,isDisabled:N.isDisabled,mustChangePassword:"external"!==N.authType&&N.mustChangePassword,allowedIPAddress:N.allowedIPAddress,expiresAt:N.expiresAt},user_groups:a}});case 26:s=e.sent,e.next=32;break;case 29:return e.next=31,Q({variables:{name:N.firstname+"\n"+N.lastname,username:N.username,password:i,role:N.role,meta:{authType:N.authType,isDisabled:N.isDisabled,mustChangePassword:N.mustChangePassword,allowedIPAddress:N.allowedIPAddress,expiresAt:N.expiresAt},user_groups:a,id:q}});case 31:s=e.sent;case 32:console.log(s),E({message:"Successful",isOpen:!0}),setTimeout((function(){E((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),Z.push("/dashboard/users"),e.next=42;break;case 38:e.prev=38,e.t1=e.catch(14),console.log(e.t1),alert("Data access error");case 42:u(!1);case 43:case"end":return e.stop()}}),e,null,[[14,38]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:i.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:i.paper,children:[Object(W.jsx)(be,{toolbarTitle:(n?"Add":"Edit")+" User",backLinkUrl:"/dashboard/users",onClickDone:ne,inProgress:o}),Object(W.jsx)("div",{className:i.root,children:Object(W.jsxs)("form",{className:i.form,noValidate:!0,autoComplete:"off",onSubmit:ne,children:[Object(W.jsx)("input",{type:"password",hidden:!0}),Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{id:"username",label:"Username",variant:"outlined",fullWidth:!0,type:"text",onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{username:e.target.value})})),F((function(e){return Object(l.a)(Object(l.a)({},e),{},{username:!1})}))},value:N.username,error:A.username,required:!0})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(je.a,{label:"First Name",variant:"outlined",fullWidth:!0,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{firstname:e.target.value})}))},value:N.firstname})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(je.a,{label:"Last Name",variant:"outlined",fullWidth:!0,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{lastname:e.target.value})}))},value:N.lastname})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(je.a,{id:"role",select:!0,label:"Role",value:N.role,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{role:e.target.value})}))},variant:"outlined",fullWidth:!0,children:[Object(W.jsx)(C.a,{value:"user",children:"User"},"user"),"administrator"===r.role&&Object(W.jsx)(C.a,{value:"sessionMonitoring",children:"Session Monitoring"},"sessionMonitoring"),["administrator","moderator","supervisor"].includes(r.role)&&Object(W.jsx)(C.a,{value:"supervisor",children:"Supervisor"},"supervisor"),["administrator","moderator"].includes(r.role)&&Object(W.jsx)(C.a,{value:"moderator",children:"Moderator"},"moderator"),"administrator"===r.role&&Object(W.jsx)(C.a,{value:"auditor",children:"Auditor"},"auditor"),"administrator"===r.role&&Object(W.jsx)(C.a,{value:"administrator",children:"Administrator"},"administrator")]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(je.a,{id:"authType",select:!0,label:"Authentication Type",value:N.authType,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{authType:e.target.value})}))},helperText:"Use internal password, or use external services to authenticate user",variant:"outlined",fullWidth:!0,children:[Object(W.jsx)(C.a,{value:"internal",children:"Internal"},"internal"),Object(W.jsx)(C.a,{value:"external",children:"External"},"external")]})}),"internal"===N.authType&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(Nn,{id:"password",label:n?"Password":"Change Password",variant:"outlined",fullWidth:!0,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{password:e.target.value})})),F((function(e){return Object(l.a)(Object(l.a)({},e),{},{password:!1,passwordConfirm:!1})}))},value:N.password,error:A.password})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(Nn,{id:"password-confirm",label:n?"Password Confirm":"Change Password Confirm",variant:"outlined",fullWidth:!0,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{passwordConfirm:e.target.value})})),F((function(e){return Object(l.a)(Object(l.a)({},e),{},{password:!1,passwordConfirm:!1})}))},value:N.passwordConfirm,error:A.passwordConfirm})})]}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{id:"allowed-ip-address",label:"Allowed user IP address",type:"text",variant:"outlined",fullWidth:!0,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{allowedIPAddress:e.target.value})}))},value:N.allowedIPAddress,helperText:"Example: 192.168.1.0/24, 10.10.1.2/32"})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(Xt,{id:"usergroups",label:"User Groups",placeholder:"Group Name",items:w,fullWidth:!0,selectedIds:f,onChange:function(e,t){var n=t.map((function(e){return e.id}));v(n)}})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(xn.a,{utils:fn.a,children:Object(W.jsx)(kn,{onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{expiresAt:e})}))},label:"Account expiry date",value:N.expiresAt,id:"expiresAt"})})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:N.isDisabled,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{isDisabled:e.target.checked})}))},name:"is-disabled"}),label:"Account is disabled"})}),"internal"===N.authType&&Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:N.mustChangePassword,onChange:function(e){D((function(t){return Object(l.a)(Object(l.a)({},t),{},{mustChangePassword:e.target.checked})}))},name:"mustChangePassword"}),label:"User must change password on next sign in"})})]})})]}),Object(W.jsx)(bn,{backLinkUrl:"/dashboard/users",onClickDone:ne,inProgress:o,extraButtons:function(){var e=Object(Je.a)(Un),t=Object(d.a)(e,1)[0],n=function(){var e=Object(j.a)(b.a.mark((function e(){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({variables:{userId:q,accountPassword:"",oneTimePassword:"",secret:""}});case 3:n=e.sent,console.log(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0.message);case 10:Z.push("/dashboard/users");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsx)(W.Fragment,{children:N.auth2FASecret&&Object(W.jsx)(z.a,{onClick:n,size:"large",style:{marginRight:7,marginLeft:7},children:"Disable 2FA"})})}})]})})]}),Object(W.jsx)(zt.a,{open:L.isOpen,message:L.message})]})},Ln=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function En(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=Ln(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var qn,Rn,Bn,Wn,zn,Gn,Kn,Hn=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}}}})),Vn=Object(Z.b)(sn||(sn=Object(p.a)(["\nquery Query {\n  user_groups\n    (order_by: {created_at: desc}) {\n    description\n    id\n    name\n    user_group_users_aggregate {\n        aggregate {\n          count\n        }\n    }\n  }\n}\n"]))),Yn=Object(Z.b)(cn||(cn=Object(p.a)(["\nquery Query($filter: String!) {\n  user_groups(\n    order_by: {created_at: desc}, \n    where: {\n    _or: [\n      {name: {_like: $filter}}, \n      {description: {_like: $filter}}\n    ]\n  }) {\n    description\n    id\n    name\n    user_group_users_aggregate {\n        aggregate {\n          count\n        }\n    }\n  }\n}\n"]))),Qn=Object(Z.b)(on||(on=Object(p.a)(["\nmutation ($ids: [uuid!]) {\n  delete_user_groups(where: {id: {_in: $ids}}) {\n    affected_rows\n  }\n}\n"]))),Jn=[{id:"edit",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"description",numeric:!1,disablePadding:!1,label:"Description"},{id:"users_count",numeric:!1,disablePadding:!1,label:"Users Count"}],Xn=function(){var e,t=Hn(),n=Object(a.useState)(!1),r=Object(d.a)(n,2),i=r[0],s=r[1],c=Object(a.useState)(Vn),o=Object(d.a)(c,2),l=o[0],u=o[1],p=Object(a.useState)(!1),m=Object(d.a)(p,2),O=m[0],h=m[1],g=Object(a.useState)({}),x=Object(d.a)(g,2),f=x[0],v=x[1],_=Object(ee.a)(l,{variables:f,notifyOnNetworkStatusChange:!0}),y=_.loading,S=(_.error,_.data),C=_.refetch,T=Object(Je.a)(Qn),N=Object(d.a)(T,1)[0];Object(a.useEffect)((function(){P()}),[O]),Object(a.useEffect)((function(){C()}),[]);var P=function(e){O&&e&&""!==e.target.value.trim()?D("%"+e.target.value.trim()+"%"):I()},D=function(e){u(Yn),v({filter:e})},I=function(){u(Vn),v({})},$=Object(Oe.g)(),A=function(e){$.push("/dashboard/user-groups/"+e)},F=Object(a.useState)([]),U=Object(d.a)(F,2),M=U[0],L=U[1],E=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting"),console.log(M),e.next=4,N({variables:{ids:M}});case 4:return e.next=6,C();case 6:s(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:t.root,children:[Object(W.jsx)(Ct,{tableTitle:"User Groups",rows:null!==(e=null===S||void 0===S?void 0:S.user_groups)&&void 0!==e?e:[],showProgress:y,headCells:Jn,rowCells:function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Edit",children:Object(W.jsx)(w.a,{onClick:function(e){return A(t.id)},color:"primary","aria-label":"edit",children:Object(W.jsx)(Qe.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.description}),Object(W.jsx)(Ve.a,{children:t.user_group_users_aggregate.aggregate.count})]})},onClickEdit:A,onClickDelete:function(e){console.log(e),L(e),s(!0)},onClickRefresh:function(){C()},onClickFilter:function(){h((function(e){return!e}))},showFilterPanel:O,onChangeFilterText:P,addLinkUrl:"/dashboard/user-groups/add",toolbarIcon:Object(W.jsx)(we.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(En,{isOpen:i,closeMe:function(){s(!1)},onConfirm:E,itemsCount:M.length})]})},Zn=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),ea=Object(Z.b)(qn||(qn=Object(p.a)(["\nquery ($id: uuid!) {\n  user_groups_by_pk(id: $id){\n    id\n    name\n    description\n    user_group_users {\n        user_id\n    }\n  }\n}\n"]))),ta=Object(Z.b)(Rn||(Rn=Object(p.a)(["\nmutation ($name: String!, $description: String!, $users: [user_group_user_insert_input!]!) {\n  insert_user_groups(objects: {\n      name: $name, \n      description: $description, \n      user_group_users: {data: $users},\n    }) {\n    returning {\n      id\n    }\n  }\n}\n"]))),na=Object(Z.b)(Bn||(Bn=Object(p.a)(["\nmutation ($name: String!, $description: String!, $users: [user_group_user_insert_input!]!, $id: uuid!) {\n  update_user_groups_by_pk(pk_columns: {id: $id}, _set: {\n      name: $name, \n      description: $description,\n    }) {\n    id\n  }\n  delete_user_group_user (where: {user_group_id: {_eq: $id}}) {\n    affected_rows\n  }\n  insert_user_group_user (objects: $users) {\n    affected_rows\n  }\n}\n"]))),aa=Object(Z.b)(Wn||(Wn=Object(p.a)(["\nquery {\n  users {\n    id\n    username\n  }\n}\n"]))),ra=function(e){var t=e.insertMode,n=void 0!==t&&t,r=Zn(),i=Object(a.useState)(!1),s=Object(d.a)(i,2),c=s[0],o=s[1],u=Object(a.useState)(""),p=Object(d.a)(u,2),m=p[0],O=p[1],h=Object(a.useState)(""),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)([]),_=Object(d.a)(v,2),y=_[0],w=_[1],k=Object(a.useState)([]),S=Object(d.a)(k,2),C=S[0],T=S[1],N=Object(a.useState)(!1),P=Object(d.a)(N,2),D=P[0],I=P[1],$=Object(a.useState)({isOpen:!1,message:""}),A=Object(d.a)($,2),F=A[0],U=A[1],M=Object(Oe.i)().id,L=Object(ln.a)(ea,{variables:{id:M}}),E=Object(d.a)(L,2),q=E[0],R=E[1].data;Object(a.useEffect)((function(){n||q()}),[]),Object(a.useEffect)((function(){if(R){var e=R.user_groups_by_pk;O(e.name),f(e.description);var t=e.user_group_users.map((function(e){return e.user_id}));w(t),o(!1)}else!n&&o(!0)}),[R]),Object(ee.a)(aa,{onCompleted:function(e){var t=e.users.map((function(e){return{id:e.id,title:e.username}}));T(t)}});var B=Object(Je.a)(ta),z=Object(d.a)(B,1)[0],G=Object(Je.a)(na),K=Object(d.a)(G,1)[0],H=Object(Oe.g)(),V=function(){var e=Object(j.a)(b.a.mark((function e(t){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==m.trim()){e.next=3;break}return I(!0),e.abrupt("return");case 3:if(o(!0),r=y.map((function(e){return{user_id:e,user_group_id:M}})),e.prev=5,!n){e.next=12;break}return e.next=9,z({variables:{name:m,description:x,users:r}});case 9:a=e.sent,e.next=15;break;case 12:return e.next=14,K({variables:{name:m,description:x,users:r,id:M}});case 14:a=e.sent;case 15:console.log(a),U({message:"Successful",isOpen:!0}),setTimeout((function(){U((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),H.push("/dashboard/user-groups"),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(5),console.log(e.t0),alert("Data access error");case 25:o(!1);case 26:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:r.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)(be,{toolbarTitle:(n?"Add":"Edit")+" User Group",backLinkUrl:"/dashboard/user-groups",onClickDone:V,inProgress:c}),Object(W.jsx)("div",{className:r.root,children:Object(W.jsxs)("form",{className:r.form,noValidate:!0,autoComplete:"off",onSubmit:V,children:[Object(W.jsx)(je.a,{id:"name",label:"Group Name",variant:"outlined",onChange:function(e){O(e.target.value),I(!1)},fullWidth:!0,value:m,error:D,required:!0}),Object(W.jsx)(je.a,{id:"description",label:"Description",variant:"outlined",fullWidth:!0,onChange:function(e){f(e.target.value)},value:x}),Object(W.jsx)(Xt,{id:"users",label:"Users",placeholder:"Username",items:C,fullWidth:!0,selectedIds:y,onChange:function(e,t){console.log(t);var n=t.map((function(e){return e.id}));w(n)}}),Object(W.jsx)(bn,{backLinkUrl:"/dashboard/user-groups",onClickDone:V,inProgress:c})]})})]}),Object(W.jsx)(zt.a,{open:F.isOpen,message:F.message})]})},ia=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function sa(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=ia(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var ca,oa=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}}}})),la=Object(Z.b)(zn||(zn=Object(p.a)(["\nquery Query {\n  connections\n    (order_by: {created_at: desc}) {\n    id\n    name\n    protocol\n    hostname\n  }\n}\n"]))),da=Object(Z.b)(Gn||(Gn=Object(p.a)(["\nquery Query($filter: String!) {\n  connections(\n    order_by: {created_at: desc}, \n    where: {\n    _or: [\n      {name: {_ilike: $filter}}, \n      {hostname: {_ilike: $filter}}\n    ]\n  }) {\n    id\n    name\n    protocol\n    hostname\n  }\n}\n"]))),ua=Object(Z.b)(Kn||(Kn=Object(p.a)(["\nmutation ($ids: [uuid!]) {\n  delete_connections(where: {id: {_in: $ids}}) {\n    affected_rows\n  }\n}\n"]))),ba=[{id:"edit",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"protocol",numeric:!1,disablePadding:!1,label:"Protocol"},{id:"hostname",numeric:!1,disablePadding:!1,label:"Hostname"}],ja=function(){var e,t=oa(),n=Object(a.useState)(!1),r=Object(d.a)(n,2),i=r[0],s=r[1],c=Object(a.useState)(la),o=Object(d.a)(c,2),l=o[0],u=o[1],p=Object(a.useState)(!1),m=Object(d.a)(p,2),O=m[0],h=m[1],g=Object(a.useState)({}),x=Object(d.a)(g,2),f=x[0],v=x[1],_=Object(ee.a)(l,{variables:f,notifyOnNetworkStatusChange:!0}),y=_.loading,S=(_.error,_.data),C=_.refetch,T=Object(Je.a)(ua),N=Object(d.a)(T,1)[0];Object(a.useEffect)((function(){P()}),[O]),Object(a.useEffect)((function(){C()}),[]);var P=function(e){O&&e&&""!==e.target.value.trim()?D("%"+e.target.value.trim()+"%"):I()},D=function(e){u(da),v({filter:e})},I=function(){u(la),v({})},$=Object(Oe.g)(),A=Object(a.useState)([]),F=Object(d.a)(A,2),U=F[0],M=F[1],L=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting"),console.log(U),e.next=4,N({variables:{ids:U}});case 4:return e.next=6,C();case 6:s(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:t.root,children:[Object(W.jsx)(Ct,{tableTitle:"Connections",rows:null!==(e=null===S||void 0===S?void 0:S.connections)&&void 0!==e?e:[],showProgress:y,headCells:ba,rowCells:function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(Ve.a,{align:"right",style:{width:130},children:[Object(W.jsx)(k.a,{title:"Edit",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void $.push("/dashboard/connections/"+n);var n},color:"primary","aria-label":"edit",children:Object(W.jsx)(Qe.a,{fontSize:"small"})})}),Object(W.jsx)(k.a,{title:"Access Rules",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void $.push("/dashboard/connections/"+n+"/access-rules");var n},color:"primary","aria-label":"edit",children:Object(W.jsx)(Mt.a,{fontSize:"small"})})})]}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.protocol}),Object(W.jsx)(Ve.a,{children:t.hostname})]})},onClickDelete:function(e){console.log(e),M(e),s(!0)},onClickRefresh:function(){C()},onClickFilter:function(){h((function(e){return!e}))},showFilterPanel:O,onChangeFilterText:P,addLinkUrl:"/dashboard/connections/add",toolbarIcon:Object(W.jsx)(Se.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(sa,{isOpen:i,closeMe:function(){s(!1)},onConfirm:L,itemsCount:U.length})]})},pa=n(683),ma=n(650),Oa=n(651),ha=n(568),ga=n(217),xa=n.n(ga),fa=Object(x.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}}}));function va(e){var t=e.onChange,n=e.ignoreCert,a=e.enableFontSmoothing,r=e.security,i=e.remoteAppProgram,s=e.remoteAppParameters,c=e.remoteAppPath,o=e.hasFeatureTtransparentMode,l=fa();return Object(W.jsx)("div",{className:l.root,children:Object(W.jsxs)(pa.a,{elevation:3,children:[Object(W.jsx)(ma.a,{expandIcon:Object(W.jsx)(xa.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(W.jsxs)(v.a,{className:l.heading,children:["Options for RDP Connection ",o&&Object(W.jsx)("p",{style:{color:"gray",fontSize:"12px",paddingLeft:"8px"},children:" (Just for none transparent connections)"})]})}),Object(W.jsx)(Oa.a,{children:Object(W.jsxs)(P.a,{container:!0,spacing:2,children:[Object(W.jsx)(P.a,{item:!0,md:4,children:Object(W.jsxs)(je.a,{id:"security",name:"security",select:!0,label:"Security Mode",value:r,onChange:t,variant:"outlined",fullWidth:!0,children:[Object(W.jsx)(C.a,{value:"nla",children:"NLA"},"nla"),Object(W.jsx)(C.a,{value:"tls",children:"RDP"},"tls"),Object(W.jsx)(C.a,{value:"basic",children:"TLS"},"basic"),Object(W.jsx)(C.a,{value:"none",children:"Any"},"none")]})}),Object(W.jsx)(P.a,{item:!0,md:4,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Font smoothing"}),Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:a,onChange:t,name:"enableFontSmoothing"}),label:"Enable font smoothing"})})]})}),Object(W.jsx)(P.a,{item:!0,md:4,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Server certification"}),Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:n,onChange:t,name:"ignoreCert"}),label:"Ignore certification"})})]})}),Object(W.jsx)(P.a,{item:!0,md:4,children:Object(W.jsx)(je.a,{id:"remote-app-program",name:"remoteAppProgram",label:"Remote App Program",variant:"outlined",fullWidth:!0,onChange:t,value:i})}),Object(W.jsx)(P.a,{item:!0,md:4,children:Object(W.jsx)(je.a,{id:"remote-app-program",name:"remoteAppParameters",label:"Remote App Parameters",variant:"outlined",fullWidth:!0,onChange:t,value:s})}),Object(W.jsx)(P.a,{item:!0,md:4,children:Object(W.jsx)(je.a,{id:"remote-app-program",name:"remoteAppPath",label:"Remote App Path",variant:"outlined",fullWidth:!0,onChange:t,value:c})})]})})]})})}var _a,ya,wa,ka,Sa,Ca=Object(x.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}}}));Object(Z.b)(ca||(ca=Object(p.a)(["\nquery ACTION_AUTH_STATUS {\n    action_auth_status {\n        id\n        role\n        username\n        meta\n    }\n}\n"])));function Ta(e){var t=e.onChange,n=e.credentialsType,a=e.credentialsUsername,r=e.credentialsPassword,i=e.credentialsKey,s=e.protocol,c=e.hasFeatureTtransparentMode,o=Ca();return Object(W.jsx)("div",{className:o.root,children:Object(W.jsxs)(pa.a,{elevation:3,children:[Object(W.jsx)(ma.a,{expandIcon:Object(W.jsx)(xa.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(W.jsx)(v.a,{className:o.heading,children:"Connection Credentials"})}),Object(W.jsx)(Oa.a,{children:Object(W.jsxs)(P.a,{container:!0,spacing:2,children:[Object(W.jsx)(P.a,{item:!0,xs:8,children:Object(W.jsxs)(je.a,{name:"credentialsType",select:!0,label:"Credentials Type",value:n,onChange:t,variant:"outlined",fullWidth:!0,children:[Object(W.jsx)(C.a,{value:"none",children:"None"},"none"),"rdp"===s&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(C.a,{value:"usernamePassword",children:["Username & Password  ",c&&Object(W.jsx)("p",{style:{color:"gray",fontSize:"12px",paddingLeft:"8px"},children:" (Just for none transparent connections)"})]},"usernamePassword"),Object(W.jsxs)(C.a,{value:"key",children:["Private Key  ",c&&Object(W.jsx)("p",{style:{color:"gray",fontSize:"12px",paddingLeft:"8px"},children:" (Just for none transparent connections)"})]},"key")]}),"rdp"!==s&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(C.a,{value:"usernamePassword",children:"Username & Password"},"usernamePassword"),Object(W.jsx)(C.a,{value:"key",children:"Private Key"},"key")]})]})}),"usernamePassword"===n&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(je.a,{name:"credentialsUsername",label:"Credentials Username",variant:"outlined",fullWidth:!0,onChange:t,value:a})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(Nn,{name:"credentialsPassword",label:"Credentials Password",variant:"outlined",fullWidth:!0,onChange:t,value:r})})]}),"key"===n&&Object(W.jsx)(P.a,{item:!0,xs:8,children:Object(W.jsx)(je.a,{name:"credentialsKey",label:"Private Key",variant:"outlined",fullWidth:!0,onChange:t,value:i})})]})})]})})}var Na,Pa,Da,Ia=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),$a=Object(Z.b)(_a||(_a=Object(p.a)(["\nquery ($id: uuid!) {\n  connections_by_pk(id: $id){\n    id\n    name\n    protocol\n    hostname\n    meta\n    connection_group_connections {\n        connection_group_id\n    }\n  }\n}\n"]))),Aa=Object(Z.b)(ya||(ya=Object(p.a)(["\nmutation ($name: String!, $protocol: String!, $hostname: String!, $meta: jsonb!, $connection_groups: [connection_group_connection_insert_input!]!) {\n  insert_connections(objects: {\n      name: $name, \n      protocol: $protocol, \n      hostname: $hostname, \n      meta: $meta,\n      connection_group_connections: {data: $connection_groups},\n    }) {\n    returning {\n      id\n    }\n  }\n}\n"]))),Fa=Object(Z.b)(wa||(wa=Object(p.a)(["\nmutation ($name: String!, $protocol: String!, $hostname: String!, $meta: jsonb!, $connection_groups: [connection_group_connection_insert_input!]!, $id: uuid!) {\n  update_connections_by_pk(pk_columns: {id: $id}, _set: {\n      name: $name, \n      protocol: $protocol, \n      hostname: $hostname, \n      meta: $meta,\n    }) {\n    id\n  }\n  delete_connection_group_connection (where: {connection_id: {_eq: $id}}) {\n    affected_rows\n  }\n  insert_connection_group_connection (objects: $connection_groups) {\n    affected_rows\n  }\n}\n"]))),Ua=Object(Z.b)(ka||(ka=Object(p.a)(["\nquery {\n  connection_groups {\n    id\n    name\n  }\n}\n"]))),Ma=Object(Z.b)(Sa||(Sa=Object(p.a)(["\nquery ($string: String!) {\n  action_auth_encrypt(string: $string) {\n    result\n  }\n}\n"]))),La=function(e){var t,n,r=e.insertMode,i=void 0!==r&&r,s=e.licenseInfo,c=Ia(),o=null===s||void 0===s||null===(t=s.action_mgmt_license_info)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.features,u=null===o||void 0===o?void 0:o.includes("trs"),p=Object(a.useState)(!1),m=Object(d.a)(p,2),O=m[0],g=m[1],x=Object(a.useState)([]),f=Object(d.a)(x,2),v=f[0],_=f[1],y=Object(a.useState)([]),w=Object(d.a)(y,2),k=w[0],S=w[1],T=Object(a.useState)({name:"",protocol:"rdp",hostname:"",meta:{port:"",isDisabled:!1,security:"nla",ignoreCert:!0,enableFontSmoothing:!1,promptCredentials:!1,remoteAppProgram:"",remoteAppParameters:"",remoteAppPath:"",credentialsType:"none",credentialsUsername:"",credentialsPassword:"",credentialsKey:""}}),N=Object(d.a)(T,2),D=N[0],I=N[1],$=Object(a.useRef)({}),A=Object(a.useState)({name:!1,hostname:!1}),F=Object(d.a)(A,2),U=F[0],M=F[1],L=Object(a.useState)({isOpen:!1,message:""}),E=Object(d.a)(L,2),q=E[0],R=E[1],B=Object(Oe.i)().id;Object(ee.a)(Ua,{onCompleted:function(e){var t=e.connection_groups.map((function(e){return{id:e.id,title:e.name}}));S(t)}});var z=Object(ln.a)($a,{variables:{id:B}}),G=Object(d.a)(z,2),K=G[0],H=G[1].data;Object(a.useEffect)((function(){i||K()}),[]),Object(a.useEffect)((function(){if(H){var e=H.connections_by_pk,t=e.connection_group_connections.map((function(e){return e.connection_group_id}));_(t),I((function(t){return Object(l.a)(Object(l.a)({},t),{},{name:e.name,protocol:e.protocol,hostname:e.hostname,meta:Object(l.a)(Object(l.a)(Object(l.a)({},t.meta),e.meta),{},{credentialsKey:"",credentialsUsername:"",credentialsPassword:""})})})),$.current=Object(l.a)({},e.meta),g(!1)}else!i&&g(!0)}),[H]);var V=Object(Je.a)(Aa),Y=Object(d.a)(V,1)[0],Q=Object(Je.a)(Fa),J=Object(d.a)(Q,1)[0],Z=Object(dn.a)(),te=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.query({query:Ma,variables:{string:t}});case 2:return r=e.sent,e.abrupt("return",null===r||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.action_auth_encrypt)||void 0===a?void 0:a.result);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;I((function(e){return Object(l.a)(Object(l.a)({},e),{},{meta:Object(l.a)(Object(l.a)({},e.meta),{},Object(h.a)({},t,n))})}))},ae=Object(Oe.g)(),re=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,s,c,o,d,u,j,p,m,O;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==D.name.trim()){e.next=3;break}return M((function(e){return Object(l.a)(Object(l.a)({},e),{},{name:!0})})),e.abrupt("return");case 3:if(""!==D.hostname.trim()){e.next=6;break}return M((function(e){return Object(l.a)(Object(l.a)({},e),{},{hostname:!0})})),e.abrupt("return");case 6:if(n=v.map((function(e){return{connection_id:B,connection_group_id:e}})),g(!0),"none"===(a=Object(l.a)({},D.meta)).credentialsType&&(a=Object(l.a)(Object(l.a)({},a),{},{credentialsKey:"",credentialsUsername:"",credentialsPassword:""})),"usernamePassword"!==a.credentialsType){e.next=24;break}if(""!==a.credentialsUsername||""!==a.credentialsPassword){e.next=17;break}c=null===(r=$.current)||void 0===r?void 0:r.credentialsUsername,o=null===(s=$.current)||void 0===s?void 0:s.credentialsPassword,a=Object(l.a)(Object(l.a)({},a),{},{credentialsKey:"",credentialsUsername:c,credentialsPassword:o}),e.next=24;break;case 17:return e.next=19,te(a.credentialsUsername);case 19:return d=e.sent,e.next=22,te(a.credentialsPassword);case 22:u=e.sent,a=Object(l.a)(Object(l.a)({},a),{},{credentialsKey:"",credentialsUsername:d,credentialsPassword:u});case 24:if("key"!==a.credentialsType){e.next=34;break}if(""!==a.credentialsKey){e.next=30;break}p=null===(j=$.current)||void 0===j?void 0:j.credentialsKey,a=Object(l.a)(Object(l.a)({},a),{},{credentialsKey:p,credentialsUsername:"",credentialsPassword:""}),e.next=34;break;case 30:return e.next=32,te(a.credentialsKey);case 32:m=e.sent,a=Object(l.a)(Object(l.a)({},a),{},{credentialsKey:m,credentialsUsername:"",credentialsPassword:""});case 34:if(g(!1),e.prev=35,!i){e.next=42;break}return e.next=39,Y({variables:{name:D.name,protocol:D.protocol,hostname:D.hostname,meta:a,connection_groups:n}});case 39:O=e.sent,e.next=45;break;case 42:return e.next=44,J({variables:{name:D.name,protocol:D.protocol,hostname:D.hostname,meta:a,connection_groups:n,id:B}});case 44:O=e.sent;case 45:console.log(O),R({message:"Successful",isOpen:!0}),setTimeout((function(){R((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),ae.push("/dashboard/connections"),e.next=55;break;case 51:e.prev=51,e.t0=e.catch(35),console.log(e.t0),alert("Data access error");case 55:g(!1);case 56:case"end":return e.stop()}}),e,null,[[35,51]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:c.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:c.paper,children:[Object(W.jsx)(be,{toolbarTitle:(i?"Add":"Edit")+" Connection",backLinkUrl:"/dashboard/connections",onClickDone:re,inProgress:O}),Object(W.jsx)("div",{className:c.root,children:Object(W.jsxs)("form",{className:c.form,noValidate:!0,autoComplete:"off",onSubmit:re,children:[Object(W.jsxs)(P.a,{container:!0,spacing:2,children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{id:"name",label:"Name",variant:"outlined",onChange:function(e){I((function(t){return Object(l.a)(Object(l.a)({},t),{},{name:e.target.value})})),M((function(e){return Object(l.a)(Object(l.a)({},e),{},{name:!1})}))},fullWidth:!0,value:D.name,error:U.name,required:!0})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(Xt,{id:"connectiongroups",label:"Connection Groups",placeholder:"Group Name",items:k,fullWidth:!0,selectedIds:v,onChange:function(e,t){var n=t.map((function(e){return e.id}));_(n)}})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(je.a,{id:"protocol",select:!0,label:"Protocol",value:D.protocol,onChange:function(e){I((function(t){return Object(l.a)(Object(l.a)({},t),{},{protocol:e.target.value})}))},variant:"outlined",fullWidth:!0,children:[Object(W.jsx)(C.a,{value:"rdp",children:"RDP"},"rdp"),Object(W.jsx)(C.a,{value:"ssh",children:"SSH"},"ssh"),Object(W.jsx)(C.a,{value:"vnc",children:"VNC"},"vnc"),Object(W.jsx)(C.a,{value:"telnet",children:"TELNET"},"telnet")]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{id:"hostname",label:"Hostname",variant:"outlined",fullWidth:!0,required:!0,onChange:function(e){I((function(t){return Object(l.a)(Object(l.a)({},t),{},{hostname:e.target.value})})),M((function(e){return Object(l.a)(Object(l.a)({},e),{},{hostname:!1})}))},value:D.hostname,error:U.hostname})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(je.a,{id:"port",label:"Port Number",variant:"outlined",fullWidth:!0,onChange:function(e){I((function(t){return Object(l.a)(Object(l.a)({},t),{},{meta:Object(l.a)(Object(l.a)({},t.meta),{},{port:e.target.value})})}))},value:D.meta.port})}),"rdp"===D.protocol&&Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(va,Object(l.a)(Object(l.a)({onChange:ne},D.meta),{},{hasFeatureTtransparentMode:u}))})}),Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(Ta,Object(l.a)(Object(l.a)({onChange:ne},D.meta),{},{protocol:D.protocol,hasFeatureTtransparentMode:u}))}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(mn.a,{component:"fieldset",children:Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:D.meta.isDisabled,onChange:ne,name:"isDisabled"}),label:"Connection is disabled"})})})})]}),Object(W.jsx)(bn,{backLinkUrl:"/dashboard/connections",onClickDone:re,inProgress:O})]})})]}),Object(W.jsx)(zt.a,{open:q.isOpen,message:q.message})]})},Ea=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function qa(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=Ea(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var Ra,Ba,Wa,za,Ga,Ka,Ha,Va=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}}}})),Ya=Object(Z.b)(Na||(Na=Object(p.a)(["\nquery Query {\n  connection_groups\n    (order_by: {created_at: desc}) {\n        id\n        name\n        description\n        connection_group_connections_aggregate {\n            aggregate {\n                count\n            }\n        }\n    }\n}\n"]))),Qa=Object(Z.b)(Pa||(Pa=Object(p.a)(["\nquery Query($filter: String!) {\n    connection_groups(\n        where: {\n        _or: [\n            {name: {_ilike: $filter}}, \n            {description: {_ilike: $filter}}\n        ]\n    }, order_by: {created_at: desc}) {\n        id\n        name\n        description\n        connection_group_connections_aggregate {\n            aggregate {\n                count\n            }\n        }\n    }\n}\n"]))),Ja=Object(Z.b)(Da||(Da=Object(p.a)(["\nmutation ($ids: [uuid!]) {\n    delete_connection_groups(where: {id: {_in: $ids}}) {\n        affected_rows\n    }\n}\n"]))),Xa=[{id:"edit",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"description",numeric:!1,disablePadding:!1,label:"Description"},{id:"connections_count",numeric:!1,disablePadding:!1,label:"Connections Count"}],Za=function(){var e,t=Va(),n=Object(a.useState)(!1),r=Object(d.a)(n,2),i=r[0],s=r[1],c=Object(a.useState)(Ya),o=Object(d.a)(c,2),l=o[0],u=o[1],p=Object(a.useState)(!1),m=Object(d.a)(p,2),O=m[0],h=m[1],g=Object(a.useState)({}),x=Object(d.a)(g,2),f=x[0],v=x[1],_=Object(ee.a)(l,{variables:f,notifyOnNetworkStatusChange:!0}),y=_.loading,S=(_.error,_.data),C=_.refetch,T=Object(Je.a)(Ja),N=Object(d.a)(T,1)[0];Object(a.useEffect)((function(){P()}),[O]),Object(a.useEffect)((function(){C()}),[]);var P=function(e){O&&e&&""!==e.target.value.trim()?D("%"+e.target.value.trim()+"%"):I()},D=function(e){u(Qa),v({filter:e})},I=function(){u(Ya),v({})},$=Object(Oe.g)(),A=function(e){$.push("/dashboard/connection-groups/"+e)},F=Object(a.useState)([]),U=Object(d.a)(F,2),M=U[0],L=U[1],E=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting"),console.log(M),e.next=4,N({variables:{ids:M}});case 4:return e.next=6,C();case 6:s(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:t.root,children:[Object(W.jsx)(Ct,{tableTitle:"Connection Groups",rows:null!==(e=null===S||void 0===S?void 0:S.connection_groups)&&void 0!==e?e:[],showProgress:y,headCells:Xa,rowCells:function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Edit",children:Object(W.jsx)(w.a,{onClick:function(e){return A(t.id)},color:"primary","aria-label":"edit",children:Object(W.jsx)(Qe.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.description}),Object(W.jsx)(Ve.a,{children:t.connection_group_connections_aggregate.aggregate.count})]})},onClickEdit:A,onClickDelete:function(e){console.log(e),L(e),s(!0)},onClickRefresh:function(){C()},onClickFilter:function(){h((function(e){return!e}))},showFilterPanel:O,onChangeFilterText:P,addLinkUrl:"/dashboard/connection-groups/add",toolbarIcon:Object(W.jsx)(Te.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(qa,{isOpen:i,closeMe:function(){s(!1)},onConfirm:E,itemsCount:M.length})]})},er=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),tr=Object(Z.b)(Ra||(Ra=Object(p.a)(["\nquery ($id: uuid!) {\n  connection_groups_by_pk(id: $id){\n    id\n    name\n    description\n    connection_group_connections {\n        connection_id\n    }\n  }\n}\n"]))),nr=Object(Z.b)(Ba||(Ba=Object(p.a)(["\nmutation ($name: String!, $description: String!, $connections: [connection_group_connection_insert_input!]!) {\n  insert_connection_groups(objects: {\n      name: $name, \n      description: $description, \n      connection_group_connections: {data: $connections},\n    }) {\n    returning {\n      id\n    }\n  }\n}\n"]))),ar=Object(Z.b)(Wa||(Wa=Object(p.a)(["\nmutation ($name: String!, $description: String!, $connections: [connection_group_connection_insert_input!]!, $id: uuid!) {\n  update_connection_groups_by_pk(pk_columns: {id: $id}, _set: {\n      name: $name, \n      description: $description,\n    }) {\n    id\n  }\n  delete_connection_group_connection (where: {connection_group_id: {_eq: $id}}) {\n    affected_rows\n  }\n  insert_connection_group_connection (objects: $connections) {\n    affected_rows\n  }\n}\n"]))),rr=Object(Z.b)(za||(za=Object(p.a)(["\nquery {\n  connections {\n    id\n    name\n  }\n}\n"]))),ir=function(e){var t=e.insertMode,n=void 0!==t&&t,r=er(),i=Object(a.useState)(!1),s=Object(d.a)(i,2),c=s[0],o=s[1],u=Object(a.useState)(""),p=Object(d.a)(u,2),m=p[0],O=p[1],h=Object(a.useState)(""),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)([]),_=Object(d.a)(v,2),y=_[0],w=_[1],k=Object(a.useState)([]),S=Object(d.a)(k,2),C=S[0],T=S[1],N=Object(a.useState)(!1),P=Object(d.a)(N,2),D=P[0],I=P[1],$=Object(a.useState)({isOpen:!1,message:""}),A=Object(d.a)($,2),F=A[0],U=A[1],M=Object(Oe.i)().id,L=Object(ln.a)(tr,{variables:{id:M}}),E=Object(d.a)(L,2),q=E[0],R=E[1].data;Object(a.useEffect)((function(){n||q()}),[]),Object(a.useEffect)((function(){if(R){var e=R.connection_groups_by_pk;O(e.name),f(e.description);var t=e.connection_group_connections.map((function(e){return e.connection_id}));w(t),o(!1)}else!n&&o(!0)}),[R]),Object(ee.a)(rr,{onCompleted:function(e){var t=e.connections.map((function(e){return{id:e.id,title:e.name}}));T(t)}});var B=Object(Je.a)(nr),z=Object(d.a)(B,1)[0],G=Object(Je.a)(ar),K=Object(d.a)(G,1)[0],H=Object(Oe.g)(),V=function(){var e=Object(j.a)(b.a.mark((function e(t){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==m.trim()){e.next=3;break}return I(!0),e.abrupt("return");case 3:if(o(!0),r=y.map((function(e){return{connection_id:e,connection_group_id:M}})),e.prev=5,!n){e.next=12;break}return e.next=9,z({variables:{name:m,description:x,connections:r}});case 9:a=e.sent,e.next=15;break;case 12:return e.next=14,K({variables:{name:m,description:x,connections:r,id:M}});case 14:a=e.sent;case 15:console.log(a),U({message:"Successful",isOpen:!0}),setTimeout((function(){U((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),H.push("/dashboard/connection-groups"),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(5),console.log(e.t0),alert("Data access error");case 25:o(!1);case 26:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:r.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)(be,{toolbarTitle:(n?"Add":"Edit")+" Connection Group",backLinkUrl:"/dashboard/connection-groups",onClickDone:V,inProgress:c}),Object(W.jsx)("div",{className:r.root,children:Object(W.jsxs)("form",{className:r.form,noValidate:!0,autoComplete:"off",onSubmit:V,children:[Object(W.jsx)(je.a,{id:"name",label:"Group Name",variant:"outlined",onChange:function(e){O(e.target.value),I(!1)},fullWidth:!0,value:m,error:D,required:!0}),Object(W.jsx)(je.a,{id:"description",label:"Description",variant:"outlined",fullWidth:!0,onChange:function(e){f(e.target.value)},value:x}),Object(W.jsx)(Xt,{id:"connections",label:"Connections",placeholder:"Connectionname",items:C,fullWidth:!0,selectedIds:y,onChange:function(e,t){console.log(t);var n=t.map((function(e){return e.id}));w(n)}}),Object(W.jsx)(bn,{backLinkUrl:"/dashboard/connection-groups",onClickDone:V,inProgress:c})]})})]}),Object(W.jsx)(zt.a,{open:F.isOpen,message:F.message})]})},sr=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function cr(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=sr(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var or=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}}}})),lr=Object(Z.b)(Ga||(Ga=Object(p.a)(["\nquery {\n  access_rules(\n      order_by: {created_at: desc}\n  ) {\n    id\n    name\n    meta\n    access_rule_connection_groups_aggregate {\n      aggregate {\n        count\n      }\n    }\n    access_rule_connections_aggregate {\n      aggregate {\n        count\n      }\n    }\n    access_rule_user_groups_aggregate {\n      aggregate {\n        count\n      }\n    }\n    access_rule_users_aggregate {\n      aggregate {\n        count\n      }\n    }\n  }\n}\n"]))),dr=Object(Z.b)(Ka||(Ka=Object(p.a)(["\nquery ($filter: String!) {\n  access_rules(\n    order_by: {created_at: desc}, \n    where: {\n    _or: [\n      {name: {_ilike: $filter}}, \n    ]\n  }) {\n    id\n    name\n    meta\n    access_rule_connection_groups_aggregate {\n      aggregate {\n        count\n      }\n    }\n    access_rule_connections_aggregate {\n      aggregate {\n        count\n      }\n    }\n    access_rule_user_groups_aggregate {\n      aggregate {\n        count\n      }\n    }\n    access_rule_users_aggregate {\n      aggregate {\n        count\n      }\n    }\n  }\n}\n"]))),ur=Object(Z.b)(Ha||(Ha=Object(p.a)(["\nmutation ($ids: [uuid!]) {\n  delete_access_rules(where: {id: {_in: $ids}}) {\n    affected_rows\n  }\n}\n"]))),br=[{id:"edit",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"users",numeric:!1,disablePadding:!1,label:"Users (Groups)"},{id:"connections",numeric:!1,disablePadding:!1,label:"Connections (Groups)"},{id:"upload",numeric:!1,disablePadding:!1,label:"Upload"},{id:"download",numeric:!1,disablePadding:!1,label:"Download"},{id:"clipboard",numeric:!1,disablePadding:!1,label:"Clipboard"}],jr=function(){var e=or(),t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)(lr),c=Object(d.a)(s,2),o=c[0],l=c[1],u=Object(a.useState)(!1),p=Object(d.a)(u,2),m=p[0],O=p[1],h=Object(a.useState)({}),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(ee.a)(o,{variables:x,notifyOnNetworkStatusChange:!0}),_=v.loading,y=(v.error,v.data),S=v.refetch,C=Object(Je.a)(ur),T=Object(d.a)(C,1)[0],N=Object(a.useState)([]),P=Object(d.a)(N,2),D=P[0],I=P[1];Object(a.useEffect)((function(){$()}),[m]),Object(a.useEffect)((function(){S()}),[]),Object(a.useEffect)((function(){var e,t=null!==(e=null===y||void 0===y?void 0:y.access_rules)&&void 0!==e?e:[];I(t.map((function(e){return{id:e.id,name:e.name,users:"".concat(e.access_rule_users_aggregate.aggregate.count," (").concat(e.access_rule_user_groups_aggregate.aggregate.count,")"),connections:"".concat(e.access_rule_connections_aggregate.aggregate.count," (").concat(e.access_rule_connection_groups_aggregate.aggregate.count,")"),upload:e.meta.canUpload?"\u2713":"",download:e.meta.canDownload?"\u2713":"",clipboard:e.meta.canCopy||e.meta.canPaste?"\u2713":""}})))}),[y]);var $=function(e){m&&e&&""!==e.target.value.trim()?A("%"+e.target.value.trim()+"%"):F()},A=function(e){l(dr),f({filter:e})},F=function(){l(lr),f({})},U=Object(Oe.g)(),M=Object(a.useState)([]),L=Object(d.a)(M,2),E=L[0],q=L[1],R=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting"),console.log(E),e.next=4,T({variables:{ids:E}});case 4:return e.next=6,S();case 6:i(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:e.root,children:[Object(W.jsx)(Ct,{tableTitle:"Access Rules",rows:D,showProgress:_,headCells:br,rowCells:function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Edit",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void U.push("/dashboard/access-rules/"+n);var n},color:"primary","aria-label":"edit",children:Object(W.jsx)(Qe.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.users}),Object(W.jsx)(Ve.a,{children:t.connections}),Object(W.jsx)(Ve.a,{children:t.upload}),Object(W.jsx)(Ve.a,{children:t.download}),Object(W.jsx)(Ve.a,{children:t.clipboard})]})},onClickDelete:function(e){console.log(e),q(e),i(!0)},onClickRefresh:function(){S()},onClickFilter:function(){O((function(e){return!e}))},showFilterPanel:m,onChangeFilterText:$,addLinkUrl:"/dashboard/access-rules/add",toolbarIcon:Object(W.jsx)(V.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(cr,{isOpen:r,closeMe:function(){i(!1)},onConfirm:R,itemsCount:E.length})]})},pr=n(198),mr=n.n(pr);function Or(e){var t=e.canUpload,n=e.canDownload,a=e.canCopy,r=e.canPaste,i=e.onChange,s=e.record,c=e.excludeKeystrokes,o=i;if(!e.transparentMode)return Object(W.jsxs)(P.a,{container:!0,children:[Object(W.jsx)(P.a,{item:!0,md:6,lg:4,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"File Transfer Access"}),Object(W.jsxs)(On.a,{style:{padding:"1em 2em"},children:[Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:t,onChange:o,name:"canUpload"}),label:"Upload files to connection"}),Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:n,onChange:o,name:"canDownload"}),label:"Download files from connection"})]})]})}),Object(W.jsx)(P.a,{item:!0,md:6,lg:4,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Clipboard Access"}),Object(W.jsxs)(On.a,{style:{padding:"1em 2em"},children:[Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:r,onChange:o,name:"canPaste"}),label:"Paste to connection"}),Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:a,onChange:o,name:"canCopy"}),label:"Copy from connection"})]})]})}),Object(W.jsx)(P.a,{item:!0,md:6,lg:4,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Record session"}),Object(W.jsxs)(On.a,{style:{padding:"1em 2em"},children:[Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:s,onChange:o,name:"record"}),label:"Record session screen"}),Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:c,onChange:o,name:"excludeKeystrokes"}),label:"Don't record key strokes"})]})]})})]})}var hr,gr,xr,fr,vr,_r,yr=function(e){var t=e.dateLimits,n=e.setDateLimits,a=e.handleTime,r=e.handleErrorDate,i=function(e,t){n((function(n){return n.data[0].errorFrom=e,n.data[0].errorTo=t,{data:n.data}})),r(!(!e&&!t))},s=function(e,n,r){("startDate"===e||"finishDate"===e)&&a(e,r,n),null!==t.data[0].startDate&&null!==t.data[0].finishDate?new Date(t.data[0].finishDate).getTime()>=new Date(t.data[0].startDate).getTime()?i(!1,!1):i(!0,!0):null!==t.data[0].startDate&&null==t.data[0].finishDate?i(!1,!0):null==t.data[0].startDate&&null!==t.data[0].finishDate?i(!0,!1):i(!1,!1)};return Object(W.jsx)("div",{children:Object(W.jsx)(P.a,{container:!0,children:t.data.map((function(e){var t,n,a;return Object(W.jsx)(P.a,(a={item:!0,lg:12,md:12},Object(h.a)(a,"lg",12),Object(h.a)(a,"sm",12),Object(h.a)(a,"children",Object(W.jsx)(D.a,{sx:{p:2,borderRadius:6},style:{borderRadius:"20px",margin:"10px 10px",padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,children:[Object(W.jsx)(P.a,(t={item:!0,align:"center",lg:6,md:6},Object(h.a)(t,"lg",6),Object(h.a)(t,"sm",6),Object(h.a)(t,"children",Object(W.jsx)(kn,{error:e.errorFrom,value:e.startDate,onChange:function(t){s("startDate",t,e.id)},label:"From Date",size:"small"})),t)),Object(W.jsx)(P.a,(n={item:!0,align:"center",lg:6,md:6},Object(h.a)(n,"lg",6),Object(h.a)(n,"sm",6),Object(h.a)(n,"children",Object(W.jsx)(kn,{error:e.errorTo,style:{marginLeft:"10px",marginRight:"10px"},value:e.finishDate,onChange:function(t){s("finishDate",t,e.id)},label:"To Date",size:"small"})),n))]})})),a),e.id)}))})})},wr=n(690),kr=function(e){var t=e.handleAdd,n=e.handleDelete,a=e.handleDay,r=e.handleTime,i=e.setDailyLimits,s=e.dailyLimits,c=function(e){var t=s.data.findIndex((function(t){return t.id===e}));i((function(e){return e.data[t].errorDay=!0,{data:e.data}}))},o=["saturday","sunday","monday","tuesday","wednesday","thursday","friday"];return Object(W.jsxs)("div",{children:[Object(W.jsx)(P.a,{container:!0,children:s.data.map((function(e){var t,i,s,c,l;return Object(W.jsx)(P.a,(l={item:!0,lg:12,md:12},Object(h.a)(l,"lg",12),Object(h.a)(l,"sm",12),Object(h.a)(l,"children",Object(W.jsx)(D.a,{style:{borderRadius:"20px",margin:"15px 10px"},children:Object(W.jsxs)(P.a,{container:!0,children:[Object(W.jsx)(P.a,(t={item:!0,lg:3,md:3},Object(h.a)(t,"lg",3),Object(h.a)(t,"sm",3),Object(h.a)(t,"children",Object(W.jsx)(je.a,{variant:"outlined",label:"Day of week",margin:"normal",align:"left",error:e.errorDay,value:e.day,fullWidth:!0,required:!0,select:!0,onChange:function(t){a(t.target.value,e.id)},children:o.map((function(e){return Object(W.jsx)(C.a,{value:e,children:e[0].toUpperCase()+e.slice(1)})}))})),t)),Object(W.jsx)(P.a,(i={item:!0,align:"center",lg:4,md:4},Object(h.a)(i,"lg",4),Object(h.a)(i,"sm",4),Object(h.a)(i,"children",Object(W.jsx)(xn.a,{utils:fn.a,children:Object(W.jsx)(P.a,{container:!0,justifyContent:"space-around",children:Object(W.jsx)(wr.a,{error:e.errorTime,style:{marginLeft:"10px",marginRight:"10px"},inputVariant:"outlined",margin:"normal",id:"time-picker",label:"From",variant:"outlined",fullWidth:!0,ampm:!1,value:e.startTime,onChange:function(t){r("startTime",e.id,t)},KeyboardButtonProps:{"aria-label":"change time"}})})})),i)),Object(W.jsx)(P.a,(s={item:!0,align:"center",lg:4,md:4},Object(h.a)(s,"lg",4),Object(h.a)(s,"sm",4),Object(h.a)(s,"children",Object(W.jsx)(xn.a,{utils:fn.a,children:Object(W.jsx)(wr.a,{inputVariant:"outlined",margin:"normal",id:"time-picker",label:"To",fullWidth:!0,error:e.errorTime,ampm:!1,value:e.finishTime,onChange:function(t){r("finishTime",e.id,t)},KeyboardButtonProps:{"aria-label":"change time"}})})),s)),Object(W.jsx)(P.a,(c={item:!0,align:"center",lg:1,md:1},Object(h.a)(c,"lg",1),Object(h.a)(c,"sm",1),Object(h.a)(c,"children",Object(W.jsx)(w.a,{style:{margin:"15px 0px"},"aria-label":"delete",onClick:function(){n(e.id)},color:"secondary",variant:"contained",children:Object(W.jsx)(pt.a,{margin:"normal "})})),c))]})})),l),e.id)}))}),Object(W.jsx)(z.a,{onClick:function(){var e=!1;if(s.data.length>0){var n=s.data.length-1;""===s.data[n].day&&(e=!0,c(s.data[n].id)),s.data[n].errorTime&&(e=!0)}e||t()},style:{margin:"30px 0 20px 0px"},color:"primary",variant:"contained",children:" Add item"})]})},Sr=function(e){var t,n=e.dailyLimits,a=e.setDailyLimits,r=e.dateLimits,i=e.setDateLimits,s=e.handleErrorDate,c=e.maximumSessionDuration,o=e.setMaximumSessionDuration,l={id:mr()(),day:"",startTime:new Date,finishTime:new Date,errorDay:!1,errorTime:!1},d=function(e,t,s){var c;"startTime"===e||"finishTime"===e?c=n.data:"startDate"!==e&&"finishDate"!==e||(c=r.data);var o=c.findIndex((function(e){return e.id===t}));-1!==o&&("startTime"===e||"finishTime"===e?a((function(t){return"startTime"===e?parseInt(new Date(s).getTime())>parseInt(new Date(c[o].finishTime).getTime())?t.data[o].errorTime=!0:t.data[o].errorTime=!1:parseInt(new Date(c[o].startTime).getTime())>parseInt(new Date(s).getTime())?t.data[o].errorTime=!0:t.data[o].errorTime=!1,t.data[o][e]=s,{data:t.data}})):"startDate"!==e&&"finishDate"!==e||i((function(t){return"startDate"===e?t.data[o].startDate=null===s?null:s.startOf("day"):"finishDate"===e&&(t.data[o].finishDate=null===s?null:s.endOf("day")),{data:t.data}})))};return Object(W.jsxs)(P.a,{container:!0,justify:"center",children:[Object(W.jsx)(P.a,{align:"center",item:!0,md:12,style:{borderRadius:"20px",margin:"35px 0px",width:"100%"},children:Object(W.jsxs)(D.a,{boxShadow:5,sx:{p:2,borderRadius:6,width:"100%"},children:[Object(W.jsx)(ha.a,{style:{margin:"20px 0px "},component:"legend",children:"Daily Constraints"}),Object(W.jsx)(kr,{handleTime:d,handleDelete:function(e){if(-1!==n.data.findIndex((function(t){return t.id===e}))){var t=n.data.filter((function(t){return t.id!==e}));a((function(e){return{data:t}}))}},handleDay:function(e,t){var r=n.data.findIndex((function(e){return e.id===t}));-1!==r&&a((function(t){return t.data[r].day=e,t.data[r].errorDay=!1,{data:t.data}}))},handleAdd:function(){a((function(e){return{data:[].concat(Object(O.a)(e.data),[l])}}))},setDailyLimits:a,dailyLimits:n})]})}),Object(W.jsx)(P.a,{align:"center",item:!0,md:12,style:{borderRadius:"20px",margin:"35px 0px",width:"100%"},children:Object(W.jsxs)(D.a,{boxShadow:5,sx:{p:2,borderRadius:6,width:"100%"},children:[Object(W.jsx)(ha.a,{style:{margin:"0px 0px 10px 0px"},component:"legend",children:"Date Constraints"}),Object(W.jsx)(yr,{handleErrorDate:s,handleTime:d,dateLimits:r,setDateLimits:i})]})}),Object(W.jsx)(P.a,{align:"center",item:!0,md:8,style:{borderRadius:"20px",margin:"35px 0px",width:"100%"},children:Object(W.jsx)(je.a,(t={id:"authenticationmaximumSessionDuration",label:"Maximum Session Duration (Minutes)",type:"text",variant:"outlined",fullWidth:!0},Object(h.a)(t,"type","number"),Object(h.a)(t,"onChange",(function(e){o(e.target.value)})),Object(h.a)(t,"value",c),t))})]})},Cr=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),Tr=Object(Z.b)(hr||(hr=Object(p.a)(["\nquery ($id: uuid!) {\n  access_rules_by_pk(id: $id){\n    id\n    name\n    meta\n    access_rule_users {\n      user_id\n    }\n    access_rule_user_groups {\n      user_group_id\n    }\n    access_rule_connections {\n      connection_id\n    }\n    access_rule_connection_groups {\n      connection_group_id\n    }\n  }\n}\n"]))),Nr=Object(Z.b)(gr||(gr=Object(p.a)(["\nmutation (\n  $name: String!, \n  $meta: jsonb!, \n  $users: [access_rule_user_insert_input!]!  \n  $connections: [access_rule_connection_insert_input!]!, \n  $userGroups: [access_rule_user_group_insert_input!]!, \n  $connectionGroups: [access_rule_connection_group_insert_input!]!, \n) {\n  insert_access_rules(objects: {\n    name: $name, \n    meta: $meta,\n    access_rule_users: {data: $users},\n    access_rule_connections: {data: $connections}, \n    access_rule_user_groups: {data: $userGroups}, \n    access_rule_connection_groups: {data: $connectionGroups}, \n  }) {\n    returning {\n      id\n    }\n  }\n}\n"]))),Pr=Object(Z.b)(xr||(xr=Object(p.a)(["\nmutation (\n  $name: String!, \n  $meta: jsonb!, \n  $users: [access_rule_user_insert_input!]!  \n  $connections: [access_rule_connection_insert_input!]!, \n  $userGroups: [access_rule_user_group_insert_input!]!, \n  $connectionGroups: [access_rule_connection_group_insert_input!]!, \n  $id: uuid!,\n) {\n  update_access_rules_by_pk(pk_columns: {id: $id}, _set: {\n    name: $name, \n    meta: $meta,\n  }) {\n    id\n  }\n  \n  delete_access_rule_user (where: {access_rule_id: {_eq: $id}}) {\n    affected_rows\n  }\n  delete_access_rule_connection (where: {access_rule_id: {_eq: $id}}) {\n    affected_rows\n  }\n  delete_access_rule_user_group (where: {access_rule_id: {_eq: $id}}) {\n    affected_rows\n  }\n  delete_access_rule_connection_group (where: {access_rule_id: {_eq: $id}}) {\n    affected_rows\n  }\n  \n  insert_access_rule_user(objects: $users) {\n    affected_rows\n  }  \n  insert_access_rule_connection(objects: $connections) {\n    affected_rows\n  }\n  insert_access_rule_user_group(objects: $userGroups) {\n    affected_rows\n  }  \n  insert_access_rule_connection_group(objects: $connectionGroups) {\n    affected_rows\n  }\n}\n"]))),Dr=Object(Z.b)(fr||(fr=Object(p.a)(["\nquery {\n  users {\n    id\n    username\n  }\n  connections {\n    id\n    name\n  }\n  user_groups {\n    id\n    name\n  }\n  connection_groups {\n    id\n    name\n  }\n}\n"]))),Ir=Object(Z.b)(vr||(vr=Object(p.a)(['\nquery {\n  users {\n    id\n    username\n  }\n  connections (where: {protocol: {_eq: "rdp"}}){\n    id\n    name\n  }\n  user_groups {\n    id\n    name\n  }\n  connection_groups(where: {connection_group_connections: {connection: {protocol: {_eq: "rdp"}}}}){\n    id\n    name\n  }\n}\n']))),$r=function(e){var t,n,i,s,c,o=e.insertMode,u=void 0!==o&&o,p=e.licenseInfo,m=r.a.useState({data:[]}),O=Object(d.a)(m,2),g=O[0],x=O[1],f=r.a.useState({data:[{id:mr()(),startDate:null,finishDate:null,errorFrom:!1,errorTo:!1}]}),_=Object(d.a)(f,2),y=_[0],w=_[1],k=r.a.useState(""),S=Object(d.a)(k,2),C=S[0],T=S[1],N=Cr(),D=Object(a.useState)(!1),I=Object(d.a)(D,2),$=I[0],A=I[1],F=Object(a.useState)({users:[],userGroups:[],connections:[],connectionGroups:[]}),U=Object(d.a)(F,2),M=U[0],L=U[1],E=Object(a.useState)({transparentMode:!1,name:"",meta:{canUpload:!1,canDownload:!1,canCopy:!1,canPaste:!1,record:!0,excludeKeystrokes:!0,dateLimits:[],dailyLimits:[],maximumSessionDuration:""},users:[],userGroups:[],connections:[],connectionGroups:[]}),q=Object(d.a)(E,2),R=q[0],B=q[1],z=Object(a.useState)({name:!1,dateLimit:!1,timeLimit:!1}),G=Object(d.a)(z,2),K=G[0],H=G[1],V=Object(a.useState)({isOpen:!1,message:""}),Y=Object(d.a)(V,2),Q=Y[0],J=Y[1],Z=Object(Oe.i)().id,ee=Object(ln.a)(Ir),te=Object(d.a)(ee,2),ne=te[0],ae=te[1],re=Object(ln.a)(Dr),ie=Object(d.a)(re,2),se=ie[0],ce=ie[1];Object(a.useEffect)((function(){R.transparentMode?ne():se()}),[R.transparentMode]),Object(a.useEffect)((function(){(null===ae||void 0===ae?void 0:ae.data)&&oe(null===ae||void 0===ae?void 0:ae.data)}),[ae]),Object(a.useEffect)((function(){(null===ce||void 0===ce?void 0:ce.data)&&oe(null===ce||void 0===ce?void 0:ce.data)}),[ce]);var oe=function(e){var t=e.connections.map((function(e){return{id:e.id,title:e.name}})),n=e.users.map((function(e){return{id:e.id,title:e.username}})),a=e.user_groups.map((function(e){return{id:e.id,title:e.name}})),r=e.connection_groups.map((function(e){return{id:e.id,title:e.name}}));L({users:n,userGroups:a,connections:t,connectionGroups:r})},le=Object(ln.a)(Tr,{variables:{id:Z}}),de=Object(d.a)(le,2),ue=de[0],pe=de[1].data;Object(a.useEffect)((function(){u||ue()}),[u,ue]),Object(a.useEffect)((function(){if(pe){var e,t,n=pe.access_rules_by_pk,a=n.name,r=n.meta,i=n.access_rule_users.map((function(e){return e.user_id})),s=n.access_rule_user_groups.map((function(e){return e.user_group_id})),c=n.access_rule_connections.map((function(e){return e.connection_id})),o=n.access_rule_connection_groups.map((function(e){return e.connection_group_id})),l=!!(null===r||void 0===r?void 0:r.transparentMode)&&(null===r||void 0===r?void 0:r.transparentMode);B({transparentMode:l,name:a,meta:r,users:i,userGroups:s,connections:c,connectionGroups:o}),A(!1),(null===r||void 0===r||null===(e=r.dailyLimits)||void 0===e?void 0:e.length)>0&&x((function(){return{data:r.dailyLimits}})),(null===r||void 0===r||null===(t=r.dateLimits)||void 0===t?void 0:t.length)>0&&w((function(){return{data:r.dateLimits}})),""!==r.maximumSessionDuration&&T(r.maximumSessionDuration)}else!u&&A(!0)}),[pe,u]);var me=Object(Je.a)(Nr),ge=Object(d.a)(me,1)[0],xe=Object(Je.a)(Pr),fe=Object(d.a)(xe,1)[0],ve=function(e){u?B((function(t){return Object(l.a)(Object(l.a)({},t),{},{transparentMode:e.target.checked})})):alert("You cannot change the transparent mode when editing access rules")},_e=function(){var e=!1;return g.data.length>0&&(""===g.data[g.data.length-1].day&&(e=!0,x((function(e){return e.data[e.data.length-1].errorDay=!0,{data:e.data}}))),g.data[g.data.length-1].errorTime&&(e=!0)),e},ye=Object(Oe.g)(),we=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,i,s,c,o,d,j;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==R.name.trim()){e.next=3;break}return H((function(e){return Object(l.a)(Object(l.a)({},e),{},{name:!0})})),e.abrupt("return");case 3:if(!K.dateLimit){e.next=5;break}return e.abrupt("return");case 5:if(!_e()){e.next=8;break}return e.abrupt("return");case 8:if(n=R.name,a=R.meta,r=R.users.map((function(e){return{access_rule_id:Z,user_id:e}})),i=R.userGroups.map((function(e){return{access_rule_id:Z,user_group_id:e}})),s=R.connections.map((function(e){return{access_rule_id:Z,connection_id:e}})),c=R.connectionGroups.map((function(e){return{access_rule_id:Z,connection_group_id:e}})),a.dailyLimits=g.data,a.dateLimits=y.data,a.maximumSessionDuration=C,a.transparentMode=R.transparentMode,A(!0),e.prev=19,!u){e.next=26;break}return e.next=23,ge({variables:{name:n,meta:a,users:r,userGroups:i,connections:s,connectionGroups:c}});case 23:e.sent,e.next=29;break;case 26:return e.next=28,fe({variables:{name:n,meta:a,users:r,userGroups:i,connections:s,connectionGroups:c,id:Z}});case 28:e.sent;case 29:J({message:"Successful",isOpen:!0}),setTimeout((function(){J((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),ye.push(null!==(o=null===ye||void 0===ye||null===(d=ye.location)||void 0===d||null===(j=d.state)||void 0===j?void 0:j.backUrl)&&void 0!==o?o:"/dashboard/access-rules"),e.next=38;break;case 34:e.prev=34,e.t0=e.catch(19),console.log(e.t0),alert("Data access error");case 38:A(!1);case 39:case"end":return e.stop()}}),e,null,[[19,34]])})));return function(t){return e.apply(this,arguments)}}(),ke=null===p||void 0===p||null===(t=p.action_mgmt_license_info)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.features,Se=null===ke||void 0===ke?void 0:ke.includes("tc"),Ce=null===ke||void 0===ke?void 0:ke.includes("trs");return Object(W.jsxs)("div",{className:N.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:N.paper,children:[Object(W.jsx)(be,{toolbarTitle:(u?"Add":"Edit")+" Access Rule",backLinkUrl:null!==(i=null===ye||void 0===ye||null===(s=ye.location)||void 0===s||null===(c=s.state)||void 0===c?void 0:c.backUrl)&&void 0!==i?i:"/dashboard/access-rules",onClickDone:we,inProgress:$}),Object(W.jsx)("div",{className:N.root,children:Object(W.jsxs)("form",{className:N.form,noValidate:!0,autoComplete:"off",onSubmit:we,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Ce&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(P.a,{item:!0,md:12,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Transparent Mode"}),Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:R.transparentMode,onChange:ve,name:"transparentMode"}),label:"Connections are imported through transparent mode"})})]})}),Object(W.jsx)(he.a,{})]}),!Ce&&!u&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(P.a,{item:!0,md:12,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Transparent Mode"}),Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:R.transparentMode,onChange:ve,name:"transparentMode"}),label:"Connections are imported through transparent mode"})})]})}),Object(W.jsx)(he.a,{})]}),Object(W.jsx)(P.a,{item:!0,xs:8,children:Object(W.jsx)(je.a,{id:"name",label:"Name",variant:"outlined",onChange:function(e){B((function(t){return Object(l.a)(Object(l.a)({},t),{},{name:e.target.value})})),H((function(e){return Object(l.a)(Object(l.a)({},e),{},{name:!1})}))},fullWidth:!0,value:R.name,error:K.name,required:!0})}),Object(W.jsx)(P.a,{item:!0,sm:6,children:Object(W.jsx)(Xt,{id:"users",label:"Users",placeholder:"Username",fullWidth:!0,items:M.users,selectedIds:R.users,onChange:function(e,t){var n=t.map((function(e){return e.id}));B((function(e){return Object(l.a)(Object(l.a)({},e),{},{users:n})}))}})}),Object(W.jsx)(P.a,{item:!0,sm:6,children:Object(W.jsx)(Xt,{id:"connections",label:"Connections",placeholder:"Connection Name",fullWidth:!0,items:M.connections,selectedIds:R.connections,onChange:function(e,t){var n=t.map((function(e){return e.id}));B((function(e){return Object(l.a)(Object(l.a)({},e),{},{connections:n})}))}})}),Object(W.jsx)(P.a,{item:!0,sm:6,children:Object(W.jsx)(Xt,{id:"user-groups",label:"User Groups",placeholder:"User Group Name",fullWidth:!0,items:M.userGroups,selectedIds:R.userGroups,onChange:function(e,t){var n=t.map((function(e){return e.id}));B((function(e){return Object(l.a)(Object(l.a)({},e),{},{userGroups:n})}))}})}),Object(W.jsx)(P.a,{item:!0,sm:6,children:Object(W.jsx)(Xt,{id:"connection-groups",label:"Connection Groups",placeholder:"Connection Group Name",fullWidth:!0,items:M.connectionGroups,selectedIds:R.connectionGroups,onChange:function(e,t){var n=t.map((function(e){return e.id}));B((function(e){return Object(l.a)(Object(l.a)({},e),{},{connectionGroups:n})}))}})}),!R.transparentMode&&Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(Or,{transparentMode:R.transparentMode,onChange:function(e){B((function(t){return Object(l.a)(Object(l.a)({},t),{},{meta:Object(l.a)(Object(l.a)({},t.meta),{},Object(h.a)({},e.target.name,e.target.checked))})}))},canUpload:R.meta.canUpload,canDownload:R.meta.canDownload,canCopy:R.meta.canCopy,canPaste:R.meta.canPaste,record:R.meta.record,excludeKeystrokes:R.meta.excludeKeystrokes})}),Se&&Object(W.jsx)(P.a,{item:!0,md:12,lg:12,sm:12,children:Object(W.jsxs)(pa.a,{children:[Object(W.jsx)(ma.a,{expandIcon:Object(W.jsx)(xa.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(W.jsx)(v.a,{children:"Time Constraints"})}),Object(W.jsx)(Oa.a,{children:Object(W.jsx)(Sr,{dailyLimits:g,setDailyLimits:x,dateLimits:y,setDateLimits:w,maximumSessionDuration:C,setMaximumSessionDuration:T,handleErrorDate:function(e){H((function(t){return Object(l.a)(Object(l.a)({},t),{},{dateLimit:e})}))}})})]})})]}),Object(W.jsx)(bn,{backLinkUrl:"/dashboard/access-rules",onClickDone:we,inProgress:$})]})})]}),Object(W.jsx)(zt.a,{open:Q.isOpen,message:Q.message})]})},Ar=n(653),Fr=function(e){var t=e.setWhere,n=Object(a.useState)({username:"",connectionName:"",dateFrom:null,dateTo:null}),r=Object(d.a)(n,2),i=r[0],s=r[1];Object(a.useEffect)((function(){var e,n;if(i.username||i.connectionName||i.dateFrom||i.dateTo){var a={};if(i.username){var r={_or:[]},s=i.username.split(",");a.user={},s.map((function(e){if((e=e.trim()).length>0){var t={username:{_ilike:"%".concat(e,"%")}};r._or.push(t),a.user=r}}))}if(i.connectionName){var c={_or:[]},o=i.connectionName.split(",");a.connection={},o.map((function(e){if((e=e.trim()).length>0){var t={name:{_ilike:"%".concat(e,"%")}};c._or.push(t),a.connection=c}}))}i.dateTo&&(a.created_at=Object(l.a)(Object(l.a)({},null!==(e=a.created_at)&&void 0!==e?e:{}),{},{_lte:i.dateTo})),i.dateFrom&&(a.created_at=Object(l.a)(Object(l.a)({},null!==(n=a.created_at)&&void 0!==n?n:{}),{},{_gte:i.dateFrom})),t(a)}else t(null)}),[i]);return Object(W.jsx)("div",{children:Object(W.jsxs)(P.a,{container:!0,spacing:1,style:{margin:"1%",width:"98%"},children:[Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(je.a,{label:"Username",variant:"outlined",fullWidth:!0,margin:"normal",value:i.username,onChange:function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{username:null===e||void 0===e?void 0:e.target.value})}))}})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(je.a,{label:"Connection",variant:"outlined",fullWidth:!0,margin:"normal",value:i.connectionName,onChange:function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{connectionName:null===e||void 0===e?void 0:e.target.value})}))}})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(kn,{onChange:function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{dateFrom:(null===e||void 0===e?void 0:e.startOf("day"))||null})}))},label:"From date",value:i.dateFrom})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(kn,{onChange:function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{dateTo:(null===e||void 0===e?void 0:e.endOf("day"))||null})}))},label:"To date",value:i.dateTo})})]})})},Ur=n(218),Mr=n.n(Ur),Lr=n(465),Er=n.n(Lr),qr=n(497),Rr=n(652),Br=n(317),Wr=n.n(Br),zr=n(463),Gr=n.n(zr),Kr=Object(Z.b)(_r||(_r=Object(p.a)(["\n    mutation ($sessionId: String!) {\n        action_sess_live(sessionId: $sessionId) {\n            tunnel_id\n        }\n    }\n"])));function Hr(){return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}var Vr=Object(x.a)((function(e){return{paper:{position:"absolute",width:"90vw",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5]},liveIcon:{cursor:"pointer",transform:"scale(1.8)",position:"absolute",top:0,right:-10,zIndex:30,borderRadius:"100%",backgroundColor:"#fff"},cardMediaStyle:{height:"95vh",with:"100vw"}}}));function Yr(e){var t=e.sessionId,n=Object(Je.a)(Kr),a=Object(d.a)(n,1)[0],i=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a({variables:{sessionId:t}});case 3:return i=e.sent,e.abrupt("return","/tunnel-service//#/?key="+(null===i||void 0===i||null===(n=i.data)||void 0===n||null===(r=n.action_sess_live)||void 0===r?void 0:r.tunnel_id));case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),s=Vr(),c=r.a.useState(Hr),o=Object(d.a)(c,1)[0],l=r.a.useState(!1),u=Object(d.a)(l,2),p=u[0],m=u[1],O=r.a.useState(""),h=Object(d.a)(O,2),g=h[0],x=h[1],f=function(){var e=Object(j.a)(b.a.mark((function e(){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:n=e.sent,x(n),m(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){m(!1)},_=Object(W.jsxs)("div",{style:o,className:s.paper,children:[Object(W.jsx)(Gr.a,{onClick:v,className:s.liveIcon}),Object(W.jsx)(Rr.a,{src:g,component:"iframe",className:s.cardMediaStyle})]});return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(w.a,{title:"Live",onClick:f,color:"primary","aria-label":"view",children:Object(W.jsx)(Wr.a,{fontSize:"small"})}),Object(W.jsx)(qr.a,{open:p,onClose:v,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",children:_})]})}var Qr,Jr,Xr,Zr,ei=n(464),ti=n.n(ei),ni=Object(Z.b)(Qr||(Qr=Object(p.a)(["\nmutation ($sessionId: uuid!) {\n  action_sess_disconnect(sessionId: $sessionId) {\n    success\n  }\n}\n"]))),ai=(Object(Z.b)(Jr||(Jr=Object(p.a)(["\nquery ($id: uuid!) {\n  sessions_by_pk(id: $id){\n    id\n    meta\n    status\n    created_at\n  }\n}\n"]))),function(e){var t,n,a,r,i,s,c=e.row,o=Object(Oe.g)(),l=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a,r,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/control-service/rec/recording"+"?sessionId=".concat(t,"&format=").concat(n),e.next=3,fetch(a,{method:"head"});case 3:if(r=e.sent,!(200===r.status||304===r.status)){e.next=7;break}return e.abrupt("return",{url:a});case 7:return e.prev=7,e.next=10,r.json();case 10:return i=e.sent,s=i.message,e.abrupt("return",{message:s});case 15:e.prev=15,e.t0=e.catch(7);case 17:return e.abrupt("return",{});case 18:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t,"recording");case 2:(null===(n=e.sent)||void 0===n?void 0:n.url)?(a="/playback-service?s="+btoa(n.url),window.open(a,"_blank")):(r=(null===n||void 0===n?void 0:n.message)||"Recording not available",alert(r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=Object(Je.a)(ni),m=Object(d.a)(p,1)[0],O=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m({variables:{sessionId:t}});case 2:r=e.sent,console.log(r),(null===r||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.action_sess_disconnect)||void 0===a?void 0:a.success)?alert("Session has been terminated"):alert("Session has not been terminated");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(Ve.a,{align:"right",style:{width:250,paddingRight:0},children:[(null===c||void 0===c||null===(t=c.meta)||void 0===t?void 0:t.transparentMode)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(k.a,{title:"Transparent Mode",children:Object(W.jsx)(w.a,{style:{color:"#d50000"},"aria-label":"view",children:Object(W.jsx)(ti.a,{fontSize:"small"})})})}),"live"===c.status&&Object(W.jsxs)(W.Fragment,{children:[!(null===c||void 0===c||null===(n=c.meta)||void 0===n?void 0:n.transparentMode)&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(k.a,{title:"Disconnect",children:Object(W.jsx)(w.a,{onClick:function(e){return O(c.id)},color:"primary","aria-label":"view",children:Object(W.jsx)(Er.a,{fontSize:"small"})})}),Object(W.jsx)(k.a,{title:"Live",children:Object(W.jsx)(Yr,{sessionId:c.id})})]}),(null===c||void 0===c||null===(a=c.meta)||void 0===a?void 0:a.transparentMode)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(k.a,{title:"Live In Transparent Mode",children:Object(W.jsx)(w.a,{color:"primary","aria-label":"view",children:Object(W.jsx)(Wr.a,{fontSize:"small"})})})})]}),Object(W.jsx)(k.a,{title:"Details",children:Object(W.jsx)(w.a,{onClick:function(e){var t,n;return n=c.id,void((null===c||void 0===c||null===(t=c.meta)||void 0===t?void 0:t.transparentMode)?o.push("/dashboard/sessions-history/"+n+"/view-transparent"):o.push("/dashboard/sessions-history/"+n+"/view"))},color:"primary","aria-label":"edit",children:Object(W.jsx)(Me.a,{fontSize:"small"})})}),!(null===c||void 0===c||null===(r=c.meta)||void 0===r?void 0:r.transparentMode)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(k.a,{title:"Playback",children:Object(W.jsx)(w.a,{onClick:function(e){return u(c.id)},color:"primary","aria-label":"view",children:Object(W.jsx)(Mr.a,{fontSize:"small"})})})})]}),Object(W.jsx)(Ve.a,{children:c.user.username}),Object(W.jsx)(Ve.a,{children:c.connection.name}),Object(W.jsx)(Ve.a,{children:c.access_rule.name}),Object(W.jsx)(Ve.a,{children:c.status}),Object(W.jsxs)(Ve.a,{children:[(null===c||void 0===c||null===(i=c.meta)||void 0===i?void 0:i.liveAt)?ae(c.meta.liveAt):ae(c.created_at),Object(W.jsx)("br",{}),(null===c||void 0===c||null===(s=c.meta)||void 0===s?void 0:s.closedAt)&&ae(c.meta.closedAt)]})]})}),ri=n(466),ii=n.n(ri),si=Object(x.a)((function(e){return{root:{width:"100%"}}})),ci=Object(Z.b)(Xr||(Xr=Object(p.a)(["\nquery {\n  sessions\n    (order_by: {created_at: desc}) {\n    id\n    meta\n    status\n    created_at\n    access_rule {\n      name\n    }\n    connection {\n      name\n    }\n    user {\n      username\n    }\n  }\n}\n"]))),oi=Object(Z.b)(Zr||(Zr=Object(p.a)(["\nquery ($where: sessions_bool_exp) {\n  sessions(\n    order_by: {created_at: desc}, \n    where: $where\n  ) {\n    id\n    meta\n    status\n    created_at\n    access_rule {\n      name\n    }\n    connection {\n      name\n    }\n    user {\n      username\n    }\n  }\n}\n"]))),li=[{id:"play",numeric:!1,disablePadding:!0,label:""},{id:"username",numeric:!1,disablePadding:!1,label:"Username"},{id:"connection",numeric:!1,disablePadding:!1,label:"Connection"},{id:"access_rule",numeric:!1,disablePadding:!1,label:"Access Rule",notSortable:!0},{id:"status",numeric:!1,disablePadding:!1,label:"Status",notSortable:!0},{id:"created_at",numeric:!1,disablePadding:!1,label:"Started - Closed At"}],di=function(){var e=si(),t=Object(a.useState)(ci),n=Object(d.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)(!1),c=Object(d.a)(s,2),l=c[0],u=c[1],b=Object(a.useState)({}),j=Object(d.a)(b,2),p=j[0],m=j[1],O=Object(ee.a)(r,{variables:p,notifyOnNetworkStatusChange:!0}),h=O.loading,g=O.data,x=O.refetch,f=Object(a.useState)([]),v=Object(d.a)(f,2),_=v[0],y=v[1],S=Object(a.useState)(null),C=Object(d.a)(S,2),T=C[0],N=C[1];Object(a.useEffect)((function(){var e,t=null!==(e=null===g||void 0===g?void 0:g.sessions)&&void 0!==e?e:[];y(t)}),[g]),Object(a.useEffect)((function(){T?P(T):D()}),[T]),Object(a.useEffect)((function(){x()}),[]);var P=function(e){i(oi),m({where:e})},D=function(){i(ci),m({})};return Object(W.jsx)("div",{className:e.root,children:Object(W.jsx)(Ct,{rowsSelectable:!1,rowsAddable:!1,tableTitle:"Sessions History",extraToolbar:function(){return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(k.a,{title:"Search Keystrokes",children:Object(W.jsx)(w.a,{component:o.b,to:"sessions-search",children:Object(W.jsx)(Ar.a,{})})}),Object(W.jsx)(k.a,{title:"Sessions Player",children:Object(W.jsx)(w.a,{component:o.b,to:"sessions-player",children:Object(W.jsx)(ii.a,{})})})]})},rows:null!==_&&void 0!==_?_:[],showProgress:h,headCells:li,rowCells:function(e){var t=e.row;return Object(W.jsx)(ai,{row:t})},onClickRefresh:function(){x()},onClickFilter:function(){u((function(e){return!e}))},showFilterPanel:l,toolbarIcon:Object(W.jsx)(Ae.a,{style:{margin:"-4px 8px"}}),customFilter:Fr,customFilterProps:{setWhere:N}})})},ui=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function bi(e){var t=e.isOpen,n=e.closeMe,a=e.message,r=ui(),i=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:i,BackdropProps:{classes:{root:r.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsx)(et.a,{children:Object(W.jsx)(tt.a,{id:"alert-dialog-description",children:a})}),Object(W.jsx)(Ze.a,{children:Object(W.jsx)(z.a,{onClick:i,color:"primary",autoFocus:!0,children:"OK"})})]})})}var ji,pi,mi,Oi,hi,gi,xi,fi,vi,_i,yi,wi=Object(x.a)((function(e){return{root:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(se.f)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}})),ki=function(e){var t=wi(),n=e.toolbarTitle,a=e.backLinkUrl,r=e.onClickDone,i=e.inProgress;return Object(W.jsxs)(y.a,{className:t.root,children:[Object(W.jsx)(v.a,{className:t.title,variant:"h6",id:"tableTitle",component:"div",style:{textAlign:"left"},children:n}),Object(W.jsx)(k.a,{title:"Back",children:Object(W.jsx)(w.a,{"aria-label":"bakc",component:o.b,to:a,children:Object(W.jsx)(oe.a,{})})}),Object(W.jsx)(k.a,{title:"Done",children:i?Object(W.jsx)(w.a,{"aria-label":"Done",color:"primary",children:Object(W.jsx)($.a,{size:24})}):Object(W.jsx)(w.a,{"aria-label":"Done",onClick:r,color:"primary",children:Object(W.jsx)(de.a,{})})})]})},Si=Object(x.a)((function(e){return{formFooter:{textAlign:"right",padding:e.spacing(1)},wrapper:{margin:e.spacing(1),position:"relative",display:"inline"},buttonProgress:{color:e.palette.primary.main,position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),Ci=function(e){var t=Si(),n=e.backLinkUrl,a=e.onClickDone,r=e.inProgress;return Object(W.jsxs)("div",{className:t.formFooter,children:[Object(W.jsx)(z.a,{component:o.b,to:n,size:"large",style:{marginRight:7,marginLeft:7},children:"Back"}),Object(W.jsxs)("div",{className:t.wrapper,children:[Object(W.jsx)(z.a,{color:"primary",onClick:a,size:"large",disabled:r,children:"Done"}),r&&Object(W.jsx)($.a,{size:24,className:t.buttonProgress})]})]})},Ti=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),Ni=Object(Z.b)(ji||(ji=Object(p.a)(["\n  query {\n    action_auth_get_2fa_secret {\n      qrImage\n      secret\n    }\n  }\n"]))),Pi=Object(Z.b)(pi||(pi=Object(p.a)(["\n  mutation ($accountPassword: String!, $oneTimePassword: String!, $secret: String!) {\n    action_auth_set_2fa(accountPassword: $accountPassword, oneTimePassword: $oneTimePassword, secret: $secret) {\n      success\n    }\n  }\n"]))),Di=function(){var e=Ti(),t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)({currentPassword:"",currentToken:"",secret:""}),c=Object(d.a)(s,2),o=c[0],u=c[1],p=Object(a.useState)({currentPassword:!1,currentToken:!1}),m=Object(d.a)(p,2),O=m[0],g=m[1],x=Object(a.useState)({isOpen:!1,message:""}),f=Object(d.a)(x,2),v=f[0],_=f[1],y=Object(a.useState)(!1),w=Object(d.a)(y,2),k=w[0],S=w[1],C=Object(a.useState)(""),T=Object(d.a)(C,2),N=T[0],D=T[1],I=Object(ee.a)(Ni),$=I.data,A=I.loading,F=I.error,U=Object(Je.a)(Pi),M=Object(d.a)(U,1)[0];Object(a.useEffect)((function(){var e,t;(null===$||void 0===$||null===(e=$.action_auth_get_2fa_secret)||void 0===e?void 0:e.secret)&&u((function(e){return Object(l.a)(Object(l.a)({},e),{},{secret:$.action_auth_get_2fa_secret.secret})})),(null===$||void 0===$||null===(t=$.action_auth_get_2fa_secret)||void 0===t?void 0:t.qrImage)&&u((function(e){return Object(l.a)(Object(l.a)({},e),{},{qrImage:$.action_auth_get_2fa_secret.qrImage})}))}),[$,A,F]);var L=function(e){u((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(h.a)({},e.target.name,e.target.value))}));g((function(e){var t,n;return t=e,n=!1,Object.keys(t).forEach((function(e){return t[e]=n})),e}))},E=(Object(Oe.g)(),function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.currentPassword){e.next=3;break}return g((function(e){return Object(l.a)(Object(l.a)({},e),{},{currentPassword:!0})})),e.abrupt("return");case 3:if(o.currentToken){e.next=6;break}return g((function(e){return Object(l.a)(Object(l.a)({},e),{},{currentToken:!0})})),e.abrupt("return");case 6:return i(!0),n=o.currentPassword,a=o.currentToken,r=o.secret,e.prev=8,e.next=11,M({variables:{accountPassword:n,oneTimePassword:a,secret:r}});case 11:s=e.sent,console.log(s),_({message:"Successful",isOpen:!0}),setTimeout((function(){_((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})})),window.location.reload()}),1e3),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(8),S(!0),D(e.t0.message);case 21:i(!1);case 22:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}());return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(ki,{toolbarTitle:"Enable Two Factor Authentication",backLinkUrl:"/dashboard",onClickDone:E,inProgress:r}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:E,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsxs)(P.a,{item:!0,xs:6,children:[Object(W.jsxs)("div",{style:{display:"block"},children:["Scan QR code via authenticator app",Object(W.jsx)("p",{children:o.secret})]}),Object(W.jsx)("br",{style:{display:"block"}}),$&&$.action_auth_get_2fa_secret&&$.action_auth_get_2fa_secret.qrImage&&Object(W.jsx)("img",{style:{display:"block"},src:$.action_auth_get_2fa_secret.qrImage})]}),Object(W.jsxs)(P.a,{item:!0,xs:6,children:[Object(W.jsx)(Nn,{id:"current-password",label:"Account password",variant:"outlined",fullWidth:!0,onChange:L,name:"currentPassword",value:o.currentPassword,error:O.currentPassword}),Object(W.jsx)(je.a,{id:"token",label:"One time password",variant:"outlined",fullWidth:!0,onChange:L,name:"currentToken",value:o.currentToken,error:O.currentToken})]})]}),Object(W.jsx)(Ci,{backLinkUrl:"/dashboard",onClickDone:E,inProgress:r})]})}),Object(W.jsx)(bi,{isOpen:k,closeMe:function(){S(!1)},message:N}),Object(W.jsx)(zt.a,{open:v.isOpen,message:v.message})]})},Ii=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),$i=(Object(Z.b)(mi||(mi=Object(p.a)(["\n  query {\n    action_auth_get_2fa_secret {\n      qrImage\n      secret\n    }\n  }\n"]))),Object(Z.b)(Oi||(Oi=Object(p.a)(["\n  mutation ($accountPassword: String!, $oneTimePassword: String!, $secret: String!) {\n    action_auth_set_2fa(accountPassword: $accountPassword, oneTimePassword: $oneTimePassword, secret: $secret) {\n      success\n    }\n  }\n"])))),Ai=function(){var e=Ii(),t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)({currentPassword:"",oneTimePassword:""}),c=Object(d.a)(s,2),o=c[0],u=c[1],p=Object(a.useState)({currentPassword:!1,oneTimePassword:!1}),m=Object(d.a)(p,2),O=m[0],g=m[1],x=Object(a.useState)({isOpen:!1,message:""}),f=Object(d.a)(x,2),v=(f[0],f[1]),_=Object(a.useState)(!1),y=Object(d.a)(_,2),w=y[0],k=y[1],S=Object(a.useState)(""),C=Object(d.a)(S,2),T=C[0],N=C[1],D=Object(Je.a)($i),I=Object(d.a)(D,1)[0],$=function(e){u((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(h.a)({},e.target.name,e.target.value))}));g((function(e){var t,n;return t=e,n=!1,Object.keys(t).forEach((function(e){return t[e]=n})),e}))},A=(Object(Oe.g)(),function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.currentPassword){e.next=3;break}return g((function(e){return Object(l.a)(Object(l.a)({},e),{},{currentPassword:!0})})),e.abrupt("return");case 3:return i(!0),n=o.currentPassword,e.prev=5,e.next=8,I({variables:{accountPassword:n,oneTimePassword:"",secret:""}});case 8:a=e.sent,console.log(a),v({message:"Successful",isOpen:!0}),setTimeout((function(){v((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})})),window.location.reload()}),1e3),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(5),k(!0),N(e.t0.message);case 18:i(!1);case 19:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t){return e.apply(this,arguments)}}());return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(ki,{toolbarTitle:"Disable Two Factor Authentication",backLinkUrl:"/dashboard",onClickDone:A,inProgress:r}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:A,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsxs)(P.a,{item:!0,xs:12,children:[Object(W.jsx)("div",{children:"Enter your account password and click done to disable second factor in sign in"}),Object(W.jsx)(je.a,{id:"current-password",label:"Account password",type:"password",variant:"outlined",fullWidth:!0,onChange:$,name:"currentPassword",value:o.currentPassword,error:O.currentPassword})]}),Object(W.jsx)(P.a,{item:!0,xs:12,style:{display:"none"},children:Object(W.jsx)(je.a,{id:"token",label:"One time token",variant:"outlined",fullWidth:!0,onChange:$,name:"currentToken",value:o.currentToken,error:O.currentToken})})]}),Object(W.jsx)(Ci,{backLinkUrl:"/dashboard",onClickDone:A,inProgress:r})]})}),Object(W.jsx)(bi,{isOpen:w,closeMe:function(){k(!1)},message:T})]})},Fi=Object(x.a)((function(e){return{form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),Ui=Object(Z.b)(hi||(hi=Object(p.a)(["\n  mutation ($currentPassword: String!, $newPassword: String!) {\n    action_auth_change_password(currentPassword: $currentPassword, newPassword: $newPassword) {\n      success\n    }\n  }\n"]))),Mi=function(e){var t=e.setSnackbarState,n=e.setAlertDialogOpen,r=e.setAlertMessage,i=Fi(),s=Object(a.useState)(!1),c=Object(d.a)(s,2),o=c[0],u=c[1],p=Object(a.useState)({currentPassword:"",newPassword:"",newPasswordConfirm:""}),m=Object(d.a)(p,2),O=m[0],g=m[1],x=Object(a.useState)({currentPassword:!1,newPassword:!1,newPasswordConfirm:!1}),f=Object(d.a)(x,2),v=f[0],_=f[1],y=Object(Je.a)(Ui),w=Object(d.a)(y,1)[0],k=function(e){g((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(h.a)({},e.target.name,e.target.value))}));_((function(e){var t,n;return t=e,n=!1,Object.keys(t).forEach((function(e){return t[e]=n})),e}))},S=(Object(Oe.g)(),function(){var e=Object(j.a)(b.a.mark((function e(a){var i,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.currentPassword){e.next=3;break}return _((function(e){return Object(l.a)(Object(l.a)({},e),{},{currentPassword:!0})})),e.abrupt("return");case 3:if(O.newPassword&&O.newPasswordConfirm){e.next=6;break}return _((function(e){return Object(l.a)(Object(l.a)({},e),{},{newPassword:!0,newPasswordConfirm:!0})})),e.abrupt("return");case 6:if(O.newPassword===O.newPasswordConfirm){e.next=9;break}return _((function(e){return Object(l.a)(Object(l.a)({},e),{},{newPassword:!0,newPasswordConfirm:!0})})),e.abrupt("return");case 9:return u(!0),i=O.currentPassword,s=O.newPassword,e.prev=11,e.next=14,w({variables:{currentPassword:i,newPassword:s}});case 14:c=e.sent,console.log(c),t({message:"Successful",isOpen:!0}),setTimeout((function(){t((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),window.location.reload(),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(11),n(!0),r(e.t0.message);case 25:u(!1);case 26:case"end":return e.stop()}}),e,null,[[11,21]])})));return function(t){return e.apply(this,arguments)}}());return Object(W.jsxs)(X.a,{className:i.paper,children:[Object(W.jsx)(ki,{toolbarTitle:"Change Password",backLinkUrl:"/dashboard",onClickDone:S,inProgress:o}),Object(W.jsx)("div",{className:i.root,children:Object(W.jsxs)("form",{className:i.form,noValidate:!0,autoComplete:"off",onSubmit:S,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(Nn,{id:"current-password",label:"Current Password",variant:"outlined",fullWidth:!0,onChange:k,name:"currentPassword",value:O.currentPassword,error:v.currentPassword})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(Nn,{id:"new-password",label:"New Password",variant:"outlined",fullWidth:!0,onChange:k,name:"newPassword",value:O.newPassword,error:v.newPassword,helperText:"A complex password includes a-z, A-Z, 0-9 and symbols"})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(Nn,{id:"new-password-confirm",label:"New Password Confirm",variant:"outlined",fullWidth:!0,onChange:k,name:"newPasswordConfirm",value:O.newPasswordConfirm,error:v.newPasswordConfirm})})]}),Object(W.jsx)(Ci,{backLinkUrl:"/dashboard",onClickDone:S,inProgress:o})]})})]})},Li=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}}})),Ei=function(e){var t,n,r,i=e.loggedInUser,s=Li(),c=Object(a.useState)({isOpen:!1,message:""}),o=Object(d.a)(c,2),l=o[0],u=o[1],b=Object(a.useState)(!1),j=Object(d.a)(b,2),p=j[0],m=j[1],O=Object(a.useState)(""),h=Object(d.a)(O,2),g=h[0],x=h[1];return Object(W.jsxs)("div",{className:s.root,style:{width:"100%"},children:["external"!==(null===i||void 0===i||null===(t=i.meta)||void 0===t?void 0:t.authType)&&Object(W.jsx)(Mi,{setAlertDialogOpen:m,setSnackbarState:u,setAlertMessage:x}),(null===i||void 0===i||null===(n=i.meta)||void 0===n?void 0:n.auth2FASecret)&&Object(W.jsx)(Ai,{}),!(null===i||void 0===i||null===(r=i.meta)||void 0===r?void 0:r.auth2FASecret)&&Object(W.jsx)(Di,{}),Object(W.jsx)(zt.a,{open:l.isOpen,message:l.message}),Object(W.jsx)(bi,{isOpen:p,closeMe:function(){m(!1)},message:g})]})},qi=n(349),Ri=n.n(qi),Bi=n(176),Wi=n.n(Bi),zi=n(318),Gi=n.n(zi),Ki=Object(x.a)((function(e){return{formFooter:{textAlign:"right",padding:e.spacing(1)},wrapper:{margin:e.spacing(1),position:"relative",display:"inline"},buttonProgress:{color:e.palette.primary.main,position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),Hi=function(e){var t=Ki(),n=e.backLinkUrl,a=e.onClickDone,r=e.inProgress;return Object(W.jsxs)("div",{className:t.formFooter,children:[n&&Object(W.jsx)(z.a,{component:o.b,to:n,size:"large",style:{marginRight:7,marginLeft:7},children:"Back"}),Object(W.jsxs)("div",{className:t.wrapper,children:[Object(W.jsx)(z.a,{color:"primary",onClick:a,size:"large",disabled:r,children:"Done"}),r&&Object(W.jsx)($.a,{size:24,className:t.buttonProgress})]})]})},Vi=Object(Z.b)(gi||(gi=Object(p.a)(["\nmutation ($service: String!, $type: String!, $meta: json!) {\n    action_front_logs(service: $service, type: $type, meta:$meta) {\n        successed\n    }\n}\n"]))),Yi=function(){var e=Object(Je.a)(Vi),t=Object(d.a)(e,1)[0];return function(){var e=Object(j.a)(b.a.mark((function e(n,a,r,i,s,c){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"data",o={data:{new:r,old:i},user_id:s,username:c,table_name:"logs",reason:a},console.log(n,a,r,i,s,c),e.prev=3,e.next=6,t({variables:{type:n,service:"data",meta:o}});case 6:e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t,n,a,r,i,s){return e.apply(this,arguments)}}()},Qi=Object(Z.b)(xi||(xi=Object(p.a)(["\n  query {\n    access_rule_connection {\n      access_rule_id\n      connection_id\n    }\n    access_rule_connection_group {\n      access_rule_id\n      connection_group_id\n    }\n    access_rule_user {\n      access_rule_id\n      user_id\n    }\n    access_rule_user_group {\n      access_rule_id\n      user_group_id\n    }\n    access_rules {\n      id\n      created_at\n      meta\n      name\n    }\n    connection_group_connection {\n      connection_group_id\n      connection_id\n    }\n    connection_groups {\n      created_at\n      description\n      id\n      name\n    }\n    connections {\n      created_at\n      hostname\n      id\n      meta\n      name\n      protocol\n    }\n    settings {\n      id\n      name\n      type\n      user_id\n      value\n    }\n    user_group_user {\n      user_group_id\n      user_id\n    }\n    user_groups {\n      created_at\n      description\n      id\n      name\n    }\n    users {\n      created_at\n      id\n      meta\n      name\n      password\n      role\n      username\n    }\n  }\n"]))),Ji=Object(Z.b)(fi||(fi=Object(p.a)(["\n  mutation ($objects: [input!] = {}) {\n    insert(objects: $objects) {\n      affected_rows\n    }\n  }\n"]))),Xi=Object(Z.b)(vi||(vi=Object(p.a)(["\nquery ($offset: Int!, $limit: Int!) {\n  sessions(limit: $limit, offset: $offset, order_by: {created_at: asc}) {\n    access_rule_id\n    connection_id\n    created_at\n    id\n    meta\n    status\n    user_id\n  }\n}\n"]))),Zi=Object(Z.b)(_i||(_i=Object(p.a)(["\nquery ($offset: Int!, $limit: Int!) {\n  logs(limit: $limit, offset: $offset, order_by: {created_at: asc}) {\n    created_at\n    id\n    meta\n    service\n    type\n  }\n}\n"]))),es=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}}));function ts(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click()}var ns,as,rs,is,ss,cs=function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsText(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))},os=function(e){var t=e.loggedInUser,n=Yi(),a=es(),i=r.a.useState(!1),s=Object(d.a)(i,2),c=s[0],o=s[1],l=r.a.useRef(),u=r.a.useState(Ji),h=Object(d.a)(u,2),g=h[0],x=h[1],f=Object(ln.a)(Qi,{onCompleted:function(){var e=Object(j.a)(b.a.mark((function e(a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(new Date).toLocaleString().slice(0,19),ts("PAM-export-configuration-".concat(r,".pam"),JSON.stringify(a)),e.next=4,n("configuration exported","configuration Data exported and downloaded : PAM-export-configuration-".concat(r,".pam"),{filename:"PAM-export-configuration-".concat(r,".pam")},null,"".concat(null===t||void 0===t?void 0:t.id),"".concat(null===t||void 0===t?void 0:t.username));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),v=Object(d.a)(f,1)[0],_=Object(Je.a)(g),y=Object(d.a)(_,1)[0],w=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=Object(dn.a)(),S=function(){var e=Object(j.a)(b.a.mark((function e(){var a,r,i,s,c,o,l,d,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=2e3,r=[],i=0,s=!0;case 4:if(!s){e.next=17;break}return o={limit:a,offset:i},e.next=8,k.query({query:Xi,variables:o});case 8:if(l=e.sent,null===(d=null===l||void 0===l||null===(c=l.data)||void 0===c?void 0:c.sessions)||void 0===d?void 0:d[0]){e.next=12;break}return e.abrupt("break",17);case 12:r.push.apply(r,Object(O.a)(d)),s=(null===d||void 0===d?void 0:d.length)>=a,i+=a,e.next=4;break;case 17:return u=(new Date).toLocaleString().slice(0,19),ts("PAM-export-sessions-".concat(u,".pam"),JSON.stringify({sessions:r})),e.next=21,n("Sessions exported","Sessions Data exported and downloaded : PAM-export-sessions-".concat(u,".pam"),{filename:"PAM-export-sessions-".concat(u,".pam")},null,"".concat(null===t||void 0===t?void 0:t.id),"".concat(null===t||void 0===t?void 0:t.username));case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(j.a)(b.a.mark((function e(){var a,r,i,s,c,o,l,d,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=2e3,r=[],i=0,s=!0;case 4:if(!s){e.next=17;break}return o={limit:a,offset:i},e.next=8,k.query({query:Zi,variables:o});case 8:if(l=e.sent,null===(d=null===l||void 0===l||null===(c=l.data)||void 0===c?void 0:c.logs)||void 0===d?void 0:d[0]){e.next=12;break}return e.abrupt("break",17);case 12:r.push.apply(r,Object(O.a)(d)),s=(null===d||void 0===d?void 0:d.length)>=a,i+=a,e.next=4;break;case 17:return u=(new Date).toLocaleString().slice(0,19),ts("PAM-export-logs-".concat(u,".pam"),JSON.stringify({logs:r})),e.next=21,n("Logs exported","Logs Data exported and downloaded : PAM-export-logs-".concat(u,".pam"),{filename:"PAM-export-logs-".concat(u,".pam")},null,"".concat(null===t||void 0===t?void 0:t.id),"".concat(null===t||void 0===t?void 0:t.username));case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(j.a)(b.a.mark((function e(a){var r,i,s,c,d,u,j,O,h,g,f,v;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o(!0),r=l.current.files[0]){e.next=6;break}return alert('No file selected!\nUse "Import" button to select file, then click "Done"'),o(!1),e.abrupt("return");case 6:return i={},e.prev=7,e.next=10,cs(r);case 10:s=e.sent,i=JSON.parse(s),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),alert(e.t0.message);case 17:c={count:0,failed:0},d=0,u=["users","user_groups","connections","connection_groups","access_rules","user_group_user","connection_group_connection","access_rule_user","access_rule_connection","access_rule_user_group","access_rule_connection_group"];case 20:if(!(d<u.length)){e.next=55;break}O=u[d],(h=null!==(j=i[O])&&void 0!==j?j:[]).forEach((function(e){null===e||void 0===e||delete e.__typename})),x(Object(Z.b)(yi||(yi=Object(p.a)(["\n                mutation ($objects: [","_insert_input!] = {}) {\n                    insert_","(objects: $objects) {\n                        affected_rows\n                    }\n                }\n            "])),O,O)),g=Object(m.a)(h),e.prev=26,g.s();case 28:if((f=g.n()).done){e.next=44;break}return v=f.value,c.count++,e.prev=31,e.next=34,y({variables:{objects:[v]}});case 34:e.next=42;break;case 36:return e.prev=36,e.t1=e.catch(31),e.next=40,n("Import Data field failed","Insert into ".concat(O," failed : ").concat(e.t1.message),{error:e.t1.message},null,"".concat(null===t||void 0===t?void 0:t.id),"".concat(null===t||void 0===t?void 0:t.username));case 40:console.log("Insert into ".concat(O," failed"),v,e.t1.message),c.failed++;case 42:e.next=28;break;case 44:e.next=49;break;case 46:e.prev=46,e.t2=e.catch(26),g.e(e.t2);case 49:return e.prev=49,g.f(),e.finish(49);case 52:d++,e.next=20;break;case 55:c.failed>0&&alert("Some insertions failed (".concat(c.failed," / ").concat(c.count,"). See System Logs for error details")),o(!1);case 57:case"end":return e.stop()}}),e,null,[[7,14],[26,46,49,52],[31,36]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:a.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Export and Import Configuration",toolbarIcon:Object(W.jsx)(Gi.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:a.root,children:Object(W.jsxs)("form",{className:a.form,noValidate:!0,autoComplete:"off",onSubmit:T,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsxs)(P.a,{item:!0,xs:12,style:{textAlign:"center"},children:[Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:a.button,startIcon:Object(W.jsx)(Ri.a,{}),style:{margin:12},onClick:w,children:"Export configuration"}),Object(W.jsxs)(z.a,{variant:"outlined",color:"primary",component:"label",startIcon:Object(W.jsx)(Wi.a,{}),children:["Import configuration",Object(W.jsx)("input",{ref:l,type:"file",hidden:!0})]})]}),Object(W.jsx)(P.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:a.button,startIcon:Object(W.jsx)(Ri.a,{}),style:{margin:12},onClick:S,children:"Export sessions"})}),Object(W.jsx)(P.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:a.button,startIcon:Object(W.jsx)(Ri.a,{}),style:{margin:12},onClick:C,children:"Export logs"})})]}),Object(W.jsx)(Hi,{onClickDone:T,inProgress:c})]})})]})},ls=n(319),ds=n.n(ls),us=n(654),bs=Object(Z.b)(ns||(ns=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  }  \n  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),js=Object(Z.b)(as||(as=Object(p.a)(['\nmutation ($name: String!) {\n\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  }  \n  \n}\n']))),ps=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),ms=function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))},Os=function(){var e=ps(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(d.a)(c,2),u=o[0],p=o[1],m=r.a.useRef(),O=r.a.useRef(),h=Object(Je.a)(bs),g=Object(d.a)(h,1)[0],x=Object(Je.a)(js),f=Object(d.a)(x,1)[0],v=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ms(n);case 3:return a=e.sent,e.prev=4,e.next=7,g({variables:{name:t,value:a}});case 7:s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),alert(e.t0.message);case 14:e.next=18;break;case 16:e.prev=16,e.t1=e.catch(0);case 18:case"end":return e.stop()}}),e,null,[[0,16],[4,11]])})));return function(t,n){return e.apply(this,arguments)}}(),_=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),n=m.current.files[0],a=O.current.files[0],e.next=5,v("brandingLogo",n);case 5:return e.next=7,v("brandingBackground",a);case 7:p(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete logo?")){e.next=5;break}return e.next=3,f({variables:{name:"brandingLogo"}});case 3:s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete background?")){e.next=5;break}return e.next=3,f({variables:{name:"brandingBackground"}});case 3:s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Custom Branding",toolbarIcon:Object(W.jsx)(ds.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:_,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:6,style:{textAlign:"center"},children:Object(W.jsxs)(z.a,{variant:"outlined",color:"primary",component:"label",startIcon:Object(W.jsx)(Wi.a,{}),children:["Select Logo",Object(W.jsx)("input",{ref:m,type:"file",accept:".jpg,.jpeg,.png",hidden:!0})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,style:{textAlign:"center"},children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",component:"label",startIcon:Object(W.jsx)(us.a,{}),onClick:y,children:"Delete Logo"})}),Object(W.jsx)(P.a,{item:!0,xs:6,style:{textAlign:"center"},children:Object(W.jsxs)(z.a,{variant:"outlined",color:"primary",component:"label",startIcon:Object(W.jsx)(Wi.a,{}),children:["Select Background",Object(W.jsx)("input",{ref:O,type:"file",accept:".jpg,.jpeg,.png",hidden:!0})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,style:{textAlign:"center"},children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",component:"label",startIcon:Object(W.jsx)(us.a,{}),onClick:w,children:"Delete Background"})})]}),Object(W.jsx)(Hi,{onClickDone:_,inProgress:u})]})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},hs=n(320),gs=n.n(hs),xs=Object(Z.b)(rs||(rs=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),fs=Object(Z.b)(is||(is=Object(p.a)(["\nmutation ($name: String!, $value: String!) {\n    update_settings(where: {name: {_eq: $name}}, _set: {value: $value})\n    {\n        affected_rows\n    }\n}\n"]))),vs=Object(Z.b)(ss||(ss=Object(p.a)(['\nquery {\n  settings (where: {_or: [\n    {name: {_eq: "externalAuthenticationAddress"}}, \n    {name: {_eq: "externalAuthenticationDefaultDomain"}}, \n    {name: {_eq: "authenticationUnsuccessfulTiresToLockUser"}},\n    {name: {_eq: "authenticationMinutesToKeepUserLocked"}},\n    {name: {_eq: "authenticationMinutesOfInactivityToSignOut"}},\n    {name: {_eq: "authenticationAllowUsersToEnable2FA"}},\n  ]}) {\n    name\n    value\n  }\n}\n']))),_s=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),ys=function(){var e=_s(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(d.a)(c,2),u=o[0],p=o[1],m=r.a.useState({externalAuthenticationAddress:"",externalAuthenticationDefaultDomain:"",authenticationUnsuccessfulTiresToLockUser:"",authenticationMinutesToKeepUserLocked:"",authenticationMinutesOfInactivityToSignOut:"",authenticationAllowUsersToEnable2FA:!1}),O=Object(d.a)(m,2),g=O[0],x=O[1],f=r.a.useState({externalAuthenticationAddress:null,externalAuthenticationDefaultDomain:null,authenticationUnsuccessfulTiresToLockUser:null,authenticationMinutesToKeepUserLocked:null,authenticationMinutesOfInactivityToSignOut:null,authenticationAllowUsersToEnable2FA:null}),v=Object(d.a)(f,2),_=v[0],y=v[1],w=r.a.useState({externalAuthenticationAddress:!1,externalAuthenticationDefaultDomain:!1,authenticationUnsuccessfulTiresToLockUser:!1,authenticationMinutesToKeepUserLocked:!1,authenticationMinutesOfInactivityToSignOut:!1}),k=Object(d.a)(w,2),S=k[0],C=(k[1],Object(ee.a)(vs)),T=C.loading,N=C.error,D=C.data,I=Object(Je.a)(xs),$=Object(d.a)(I,1)[0],A=Object(Je.a)(fs),F=Object(d.a)(A,1)[0];r.a.useEffect((function(){if(!T&&!N){var e={};D.settings.forEach((function(t){return e[t.name]=t.value})),x((function(t){return Object(l.a)(Object(l.a)(Object(l.a)({},t),e),{},{authenticationAllowUsersToEnable2FA:"true"===e.authenticationAllowUsersToEnable2FA})})),y((function(t){return Object(l.a)(Object(l.a)({},t),e)}))}}),[D]);var U=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;"authenticationUnsuccessfulTiresToLockUser"==t&&(""==n||n<1?n=1:n>10&&(n=10)),"authenticationMinutesToKeepUserLocked"==t&&(""==n||n<1?n=1:n>1440&&(n=1440)),"authenticationMinutesOfInactivityToSignOut"==t&&(""==n||n<3?n=3:n>120&&(n=120)),x((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}))},M=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p(!0),e.prev=1,""===(null===g||void 0===g?void 0:g.externalAuthenticationAddress)||(null===g||void 0===g?void 0:g.externalAuthenticationAddress)===(null===_||void 0===_?void 0:_.externalAuthenticationAddress)||(null===_||void 0===_?void 0:_.externalAuthenticationAddress)){e.next=5;break}return e.next=5,$({variables:{name:"externalAuthenticationAddress",value:g.externalAuthenticationAddress}});case 5:if(""===(null===g||void 0===g?void 0:g.externalAuthenticationDefaultDomain)||(null===g||void 0===g?void 0:g.externalAuthenticationDefaultDomain)===(null===_||void 0===_?void 0:_.externalAuthenticationDefaultDomain)||(null===_||void 0===_?void 0:_.externalAuthenticationDefaultDomain)){e.next=8;break}return e.next=8,$({variables:{name:"externalAuthenticationDefaultDomain",value:g.externalAuthenticationDefaultDomain}});case 8:if(""===(null===g||void 0===g?void 0:g.authenticationUnsuccessfulTiresToLockUser)||(null===g||void 0===g?void 0:g.authenticationUnsuccessfulTiresToLockUser)===(null===_||void 0===_?void 0:_.authenticationUnsuccessfulTiresToLockUser)||(null===_||void 0===_?void 0:_.authenticationUnsuccessfulTiresToLockUser)){e.next=11;break}return e.next=11,$({variables:{name:"authenticationUnsuccessfulTiresToLockUser",value:g.authenticationUnsuccessfulTiresToLockUser.toString()}});case 11:if(""===(null===g||void 0===g?void 0:g.authenticationMinutesToKeepUserLocked)||(null===g||void 0===g?void 0:g.authenticationMinutesToKeepUserLocked)===(null===_||void 0===_?void 0:_.authenticationMinutesToKeepUserLocked)||(null===_||void 0===_?void 0:_.authenticationMinutesToKeepUserLocked)){e.next=14;break}return e.next=14,$({variables:{name:"authenticationMinutesToKeepUserLocked",value:g.authenticationMinutesToKeepUserLocked.toString()}});case 14:if(""===(null===g||void 0===g?void 0:g.authenticationMinutesOfInactivityToSignOut)||(null===g||void 0===g?void 0:g.authenticationMinutesOfInactivityToSignOut)===(null===_||void 0===_?void 0:_.authenticationMinutesOfInactivityToSignOut)||(null===_||void 0===_?void 0:_.authenticationMinutesOfInactivityToSignOut)){e.next=17;break}return e.next=17,$({variables:{name:"authenticationMinutesOfInactivityToSignOut",value:g.authenticationMinutesOfInactivityToSignOut.toString()}});case 17:if(!(null===g||void 0===g?void 0:g.authenticationAllowUsersToEnable2FA)||(null===g||void 0===g?void 0:g.authenticationAllowUsersToEnable2FA)===(null===_||void 0===_?void 0:_.authenticationAllowUsersToEnable2FA)||(null===_||void 0===_?void 0:_.authenticationAllowUsersToEnable2FA)){e.next=20;break}return e.next=20,$({variables:{name:"authenticationAllowUsersToEnable2FA",value:g.authenticationAllowUsersToEnable2FA?"true":"false"}});case 20:if((null===g||void 0===g?void 0:g.externalAuthenticationAddress)===(null===_||void 0===_?void 0:_.externalAuthenticationAddress)||!(null===_||void 0===_?void 0:_.externalAuthenticationAddress)){e.next=23;break}return e.next=23,F({variables:{name:"externalAuthenticationAddress",value:g.externalAuthenticationAddress}});case 23:if((null===g||void 0===g?void 0:g.externalAuthenticationDefaultDomain)===(null===_||void 0===_?void 0:_.externalAuthenticationDefaultDomain)||!(null===_||void 0===_?void 0:_.externalAuthenticationDefaultDomain)){e.next=26;break}return e.next=26,F({variables:{name:"externalAuthenticationDefaultDomain",value:g.externalAuthenticationDefaultDomain}});case 26:if((null===g||void 0===g?void 0:g.authenticationUnsuccessfulTiresToLockUser)===(null===_||void 0===_?void 0:_.authenticationUnsuccessfulTiresToLockUser)||!(null===_||void 0===_?void 0:_.authenticationUnsuccessfulTiresToLockUser)){e.next=29;break}return e.next=29,F({variables:{name:"authenticationUnsuccessfulTiresToLockUser",value:g.authenticationUnsuccessfulTiresToLockUser.toString()}});case 29:if((null===g||void 0===g?void 0:g.authenticationMinutesToKeepUserLocked)===(null===_||void 0===_?void 0:_.authenticationMinutesToKeepUserLocked)||!(null===_||void 0===_?void 0:_.authenticationMinutesToKeepUserLocked)){e.next=32;break}return e.next=32,F({variables:{name:"authenticationMinutesToKeepUserLocked",value:g.authenticationMinutesToKeepUserLocked.toString()}});case 32:if((null===g||void 0===g?void 0:g.authenticationMinutesOfInactivityToSignOut)===(null===_||void 0===_?void 0:_.authenticationMinutesOfInactivityToSignOut)||!(null===_||void 0===_?void 0:_.authenticationMinutesOfInactivityToSignOut)){e.next=35;break}return e.next=35,F({variables:{name:"authenticationMinutesOfInactivityToSignOut",value:g.authenticationMinutesOfInactivityToSignOut.toString()}});case 35:if((null===g||void 0===g?void 0:g.authenticationAllowUsersToEnable2FA)===(null===_||void 0===_?void 0:_.authenticationAllowUsersToEnable2FA)||!(null===_||void 0===_?void 0:_.authenticationAllowUsersToEnable2FA)){e.next=38;break}return e.next=38,F({variables:{name:"authenticationAllowUsersToEnable2FA",value:g.authenticationAllowUsersToEnable2FA?"true":"false"}});case 38:s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=46;break;case 42:e.prev=42,e.t0=e.catch(1),console.log(e.t0),alert("Data access error");case 46:p(!1);case 47:case"end":return e.stop()}}),e,null,[[1,42]])})));return function(t){return e.apply(this,arguments)}}();return console.log(g),Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Authentication",toolbarIcon:Object(W.jsx)(gs.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:M,children:[Object(W.jsx)(ha.a,{component:"legend",children:"External authentication"}),Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{id:"external-auth-address",label:"Active Directory / LDAP URL",type:"text",variant:"outlined",fullWidth:!0,onChange:U,name:"externalAuthenticationAddress",value:g.externalAuthenticationAddress,error:S.externalAuthenticationAddress,helperText:"Example: LDAP://192.168.1.10/"})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{id:"external-auth-default-domain",label:"Default domain",type:"text",variant:"outlined",fullWidth:!0,onChange:U,name:"externalAuthenticationDefaultDomain",value:g.externalAuthenticationDefaultDomain,error:S.externalAuthenticationDefaultDomain,helperText:"Username will be transformed to username@domain. Example: company.local"})})]}),Object(W.jsx)(he.a,{style:{margin:"2em"}}),Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(ha.a,{component:"legend",children:"Security policy"})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(je.a,{id:"authenticationUnsuccessfulTiresToLockUser",label:"Unsuccessful tries to lock user",variant:"outlined",fullWidth:!0,type:"number",InputProps:{inputProps:{min:1,max:10}},onChange:U,name:"authenticationUnsuccessfulTiresToLockUser",error:S.authenticationUnsuccessfulTiresToLockUser,value:""===g.authenticationUnsuccessfulTiresToLockUser?g.authenticationUnsuccessfulTiresToLockUser:parseInt(g.authenticationUnsuccessfulTiresToLockUser)})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(je.a,{id:"authenticationMinutesToKeepUserLocked",label:"Minutes to keep user locked",variant:"outlined",fullWidth:!0,type:"number",InputProps:{inputProps:{min:1,max:1440}},onChange:U,name:"authenticationMinutesToKeepUserLocked",error:S.authenticationMinutesToKeepUserLocked,value:""===g.authenticationMinutesToKeepUserLocked?g.authenticationMinutesToKeepUserLocked:parseInt(g.authenticationMinutesToKeepUserLocked)})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(je.a,{id:"authenticationMinutesOfInactivityToSignOut",label:"Minutes of inactivity to sign out",variant:"outlined",fullWidth:!0,type:"number",InputProps:{inputProps:{min:3,max:120}},onChange:U,name:"authenticationMinutesOfInactivityToSignOut",error:S.authenticationMinutesOfInactivityToSignOut,value:""===g.authenticationMinutesOfInactivityToSignOut?g.authenticationMinutesOfInactivityToSignOut:parseInt(g.authenticationMinutesOfInactivityToSignOut)})}),Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:g.authenticationAllowUsersToEnable2FA,name:"authenticationAllowUsersToEnable2FA"}),label:"Allow users to enable two factor authentication (2FA using authenticator apps)",onChange:U})})})]}),Object(W.jsx)(Hi,{onClickDone:M,inProgress:u})]})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},ws=n(171),ks=n.n(ws);function Ss(e){var t,n,a,r,i,s,c,o=e.formState,l=null===o||void 0===o||null===(t=o.licenseInfo)||void 0===t?void 0:t.features,d=null===l||void 0===l?void 0:l.join(".");return Object(W.jsx)(P.a,{container:!0,spacing:3,children:Object(W.jsx)(P.a,{item:!0,xs:12,children:(null===o||void 0===o?void 0:o.licenseInfo)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)("ul",{children:[Object(W.jsxs)("li",{title:d,children:["License ID: ",o.licenseInfo.license_id]}),Object(W.jsxs)("li",{children:["Issued to: ",o.licenseInfo.issued_to]}),(null===(n=o.licenseInfo)||void 0===n?void 0:n.expires_text)?Object(W.jsxs)("li",{children:["Expires at: ",null===(a=o.licenseInfo)||void 0===a?void 0:a.expires_text]}):Object(W.jsxs)(W.Fragment,{children:[(null===o||void 0===o||null===(r=o.licenseInfo)||void 0===r?void 0:r.expires_at)&&Object(W.jsxs)("li",{children:["Expires at: ",ae(1e3*o.licenseInfo.expires_at)]}),Object(W.jsxs)("li",{children:["Days remaining: ",Math.ceil((o.licenseInfo.expires_at-new Date/1e3)/3600/24)]})]}),Object(W.jsxs)("li",{children:["Hardware licence:",o.licenseInfo.hardware_available?Object(W.jsx)("span",{children:" Connected"}):Object(W.jsx)("span",{children:" Not available"})]}),(null===o||void 0===o||null===(i=o.licenseInfo)||void 0===i||null===(s=i.features)||void 0===s?void 0:s.includes("chn"))&&Object(W.jsxs)("li",{children:["License challenge in ",null===o||void 0===o||null===(c=o.licenseInfo)||void 0===c?void 0:c.challengeRemainingDays," days"]})]})})})})}var Cs,Ts,Ns,Ps,Ds,Is,$s,As,Fs,Us,Ms,Ls,Es,qs,Rs,Bs,Ws,zs,Gs,Ks,Hs,Vs,Ys,Qs,Js,Xs,Zs,ec,tc,nc,ac,rc,ic,sc,cc,oc=n(655),lc=n(656),dc=Object(Z.b)(Cs||(Cs=Object(p.a)(["\nquery {\n  action_mgmt_license_info {\n    result\n  }\n}\n"]))),uc=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},paper:{width:"100%",marginBottom:e.spacing(1)}}})),bc=function(){var e,t,n,a,i,s=uc(),c=r.a.useState(),u=Object(d.a)(c,2),b=u[0],j=u[1],p=Object(ee.a)(dc).data;return r.a.useEffect((function(){var e;console.log(p);var t=null===p||void 0===p||null===(e=p.action_mgmt_license_info)||void 0===e?void 0:e.result;t&&(j((function(e){return Object(l.a)(Object(l.a)({},e),{},{licenseInfo:t})})),console.log("license",t))}),[p]),Object(W.jsxs)(X.a,{className:s.paper,children:[Object(W.jsx)(be,{toolbarTitle:"System License",toolbarIcon:Object(W.jsx)(ks.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)(Ss,{formState:b}),Object(W.jsxs)("center",{children:[Object(W.jsx)(z.a,{variant:"outlined",component:o.b,to:"/dashboard/settings/system-license/edit",color:"primary",size:"medium",startIcon:Object(W.jsx)(oc.a,{}),style:{margin:"auto",marginBottom:20},children:"Renew license key"}),"\xa0 \xa0",(null===b||void 0===b||null===(e=b.licenseInfo)||void 0===e||null===(t=e.features)||void 0===t?void 0:t.includes("chn"))&&Object(W.jsx)(z.a,{disabled:(null===b||void 0===b||null===(n=b.licenseInfo)||void 0===n?void 0:n.challengeRemainingDays)>5,component:o.b,to:"/dashboard/settings/system-license/challenge",variant:"outlined",color:"primary",size:"medium",startIcon:Object(W.jsx)(lc.a,{}),style:{margin:"auto",marginBottom:20},children:(null===b||void 0===b?void 0:b.daysToChallenge)>5?Object(W.jsxs)(W.Fragment,{children:[" Challenge is active (",null===b||void 0===b||null===(a=b.licenseInfo)||void 0===a?void 0:a.challengeRemainingDays," days) "]}):Object(W.jsxs)(W.Fragment,{children:[" Request challenge code (",null===b||void 0===b||null===(i=b.licenseInfo)||void 0===i?void 0:i.challengeRemainingDays," days) "]})})]})]})},jc=n(321),pc=n.n(jc),mc=Object(Z.b)(Ts||(Ts=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  }  \n  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),Oc=Object(Z.b)(Ns||(Ns=Object(p.a)(['\nquery {\n  settings (where: {_and: [\n    {type: {_eq: "system"}},\n  ]}) {\n    name\n    value\n  }\n}\n']))),hc=Object(Z.b)(Ps||(Ps=Object(p.a)(["\nmutation ($redirect: Boolean!, $key: String!, $certification: String!) {\n  action_mgmt_ssl(redirect: $redirect, key: $key, certification: $certification) {\n    success\n  }\n}\n"]))),gc=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),xc=function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsText(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))},fc=function(){var e=gc(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(d.a)(c,2),u=o[0],p=o[1],m=r.a.useState({redirectToHttps:!1}),O=Object(d.a)(m,2),g=O[0],x=O[1],f=r.a.useRef(),v=r.a.useRef(),_=Object(ee.a)(Oc),y=_.loading,w=_.error,k=_.data,S=(_.refetch,Object(Je.a)(mc)),C=Object(d.a)(S,1)[0],T=Object(Je.a)(hc),N=Object(d.a)(T,1)[0];r.a.useEffect((function(){if(!y&&!w){var e={};k.settings.forEach((function(t){return e[t.name]=t.value}));var t="true"===(null===e||void 0===e?void 0:e.redirectToHttps);x((function(e){return Object(l.a)(Object(l.a)({},e),{},{redirectToHttps:t})}))}}),[k]);var D=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),n=g.redirectToHttps,e.prev=2,e.next=5,C({variables:{name:"redirectToHttps",value:n.toString()}});case 5:if(a=g.redirectToHttps,r="",i="",!f.current.files[0]||!v.current.files[0]){e.next=15;break}return e.next=11,xc(f.current.files[0]);case 11:return r=e.sent,e.next=14,xc(v.current.files[0]);case 14:i=e.sent;case 15:return e.next=17,N({variables:{redirect:a,certification:r,key:i}});case 17:s({message:"Successful. Server reboot is required.",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),console.log(e.t0),alert("Data access error");case 25:p(!1);case 26:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"HTTPS Configuration",toolbarIcon:Object(W.jsx)(pc.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:D,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Enable secure HTTP"}),Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:g.redirectToHttps,onChange:function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;x((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}))},name:"redirectToHttps"}),label:"Redirect HTTP requests to HTTPS"})})]})}),Object(W.jsxs)(P.a,{item:!0,xs:12,style:{textAlign:"center"},children:[Object(W.jsxs)(z.a,{variant:"outlined",color:"primary",component:"label",style:{margin:12},startIcon:Object(W.jsx)(Wi.a,{}),children:["Select SSL certificate",Object(W.jsx)("input",{ref:f,type:"file",hidden:!0,accept:".crt, .cert, .pem"})]}),Object(W.jsxs)(z.a,{variant:"outlined",color:"primary",component:"label",style:{margin:12},startIcon:Object(W.jsx)(Wi.a,{}),children:["Select SSL key",Object(W.jsx)("input",{ref:v,type:"file",accept:".key, .cert, .pem",hidden:!0})]})]})]}),Object(W.jsx)(Hi,{onClickDone:D,inProgress:u})]})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},vc=Object(Z.b)(Ds||(Ds=Object(p.a)(['\nmutation ($name: String!, $value: String!) {  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),_c=Object(Z.b)(Is||(Is=Object(p.a)(["\nmutation ($name: String!, $value: String!) {\n    update_settings(where: {name: {_eq: $name}}, _set: {value: $value})\n    {\n        affected_rows\n    }\n}\n"]))),yc=Object(Z.b)($s||($s=Object(p.a)(['\nquery {\n  settings (where: {_and: [\n    {type: {_eq: "system"}},\n  ]}) {\n    name\n    value\n  }\n}\n']))),wc=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),kc=function(){var e=wc(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(d.a)(c,2),u=o[0],p=o[1],m=r.a.useState({syslogProtocol:"udp",syslogAddress:"",syslogPort:""}),O=Object(d.a)(m,2),g=O[0],x=O[1],f=r.a.useState({syslogProtocol:null,syslogAddress:null,syslogPort:null}),v=Object(d.a)(f,2),_=v[0],y=v[1],w=r.a.useState({syslogAddress:!1,syslogPort:!1}),k=Object(d.a)(w,2),S=k[0],T=k[1],N=Object(ee.a)(yc),D=N.loading,I=N.error,$=N.data,A=(N.refetch,Object(Je.a)(vc)),F=Object(d.a)(A,1)[0],U=Object(Je.a)(_c),M=Object(d.a)(U,1)[0];r.a.useEffect((function(){var e,t,n;if(!D&&!I){var a={};$.settings.forEach((function(e){return a[e.name]=e.value}));var r=null!==(e=a.syslogAddress)&&void 0!==e?e:"",i=null!==(t=a.syslogPort)&&void 0!==t?t:"",s=null!==(n=a.syslogProtocol)&&void 0!==n?n:"udp";x((function(e){return Object(l.a)(Object(l.a)({},e),{},{syslogAddress:r,syslogPort:i,syslogProtocol:s})})),y((function(e){var t,n,r;return Object(l.a)(Object(l.a)({},e),{},{syslogAddress:null!==(t=a.syslogAddress)&&void 0!==t?t:null,syslogPort:null!==(n=a.syslogPort)&&void 0!==n?n:null,syslogProtocol:null!==(r=a.syslogProtocol)&&void 0!==r?r:null})}))}}),[$]);var L=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;x((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}));T((function(e){var t,n;return t=e,n=!1,Object.keys(t).forEach((function(e){return t[e]=n})),e}))},E=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p(!0),e.prev=1,""===(null===g||void 0===g?void 0:g.syslogProtocol)||(null===_||void 0===_?void 0:_.syslogProtocol)){e.next=6;break}return e.next=5,F({variables:{name:"syslogProtocol",value:g.syslogProtocol}});case 5:y((function(e){return Object(l.a)(Object(l.a)({},e),{},{syslogProtocol:g.syslogProtocol})}));case 6:if(""===(null===g||void 0===g?void 0:g.syslogAddress)||(null===_||void 0===_?void 0:_.syslogAddress)){e.next=10;break}return e.next=9,F({variables:{name:"syslogAddress",value:g.syslogAddress}});case 9:y((function(e){return Object(l.a)(Object(l.a)({},e),{},{syslogAddress:g.syslogAddress})}));case 10:if(""===(null===g||void 0===g?void 0:g.syslogPort)||(null===_||void 0===_?void 0:_.syslogPort)){e.next=14;break}return e.next=13,F({variables:{name:"syslogPort",value:g.syslogPort}});case 13:y((function(e){return Object(l.a)(Object(l.a)({},e),{},{syslogPort:g.syslogPort})}));case 14:if((null===g||void 0===g?void 0:g.syslogProtocol)===(null===_||void 0===_?void 0:_.syslogProtocol)||!(null===_||void 0===_?void 0:_.syslogProtocol)){e.next=18;break}return e.next=17,M({variables:{name:"syslogProtocol",value:g.syslogProtocol}});case 17:y((function(e){return Object(l.a)(Object(l.a)({},e),{},{syslogProtocol:g.syslogProtocol})}));case 18:if((null===g||void 0===g?void 0:g.syslogAddress)===(null===_||void 0===_?void 0:_.syslogAddress)||!(null===_||void 0===_?void 0:_.syslogAddress)){e.next=22;break}return e.next=21,M({variables:{name:"syslogAddress",value:g.syslogAddress}});case 21:y((function(e){return Object(l.a)(Object(l.a)({},e),{},{syslogAddress:g.syslogAddress})}));case 22:if((null===g||void 0===g?void 0:g.syslogPort)===(null===_||void 0===_?void 0:_.syslogPort)||!(null===_||void 0===_?void 0:_.syslogPort)){e.next=26;break}return e.next=25,M({variables:{name:"syslogPort",value:g.syslogPort}});case 25:y((function(e){return Object(l.a)(Object(l.a)({},e),{},{syslogPort:g.syslogPort})}));case 26:s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(1),console.log(e.t0),alert("Data access error");case 34:p(!1);case 35:case"end":return e.stop()}}),e,null,[[1,30]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Syslog Server Configuration",toolbarIcon:Object(W.jsx)(Me.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:E,children:[Object(W.jsx)(ha.a,{component:"legend",children:"System logs will be forwarded to syslog server if address and port provided."}),Object(W.jsx)("br",{}),Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(je.a,{select:!0,label:"Protocol",name:"syslogProtocol",value:g.syslogProtocol,onChange:L,helperText:"Transport protocol (UDP/TCP)",variant:"outlined",fullWidth:!0,children:[Object(W.jsx)(C.a,{value:"udp",children:"UDP"},"udp"),Object(W.jsx)(C.a,{value:"tcp",children:"TCP"},"tcp")]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(je.a,{label:"Server address",type:"text",variant:"outlined",fullWidth:!0,onChange:L,name:"syslogAddress",value:g.syslogAddress,error:S.syslogAddress,helperText:"Example: 192.168.1.10"})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(je.a,{label:"Server port",type:"text",variant:"outlined",fullWidth:!0,onChange:L,name:"syslogPort",value:g.syslogPort,error:S.syslogPort,helperText:"Example: 514"})})]}),Object(W.jsx)(Hi,{onClickDone:E,inProgress:u})]})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},Sc=n(657),Cc=n(658),Tc=n(659),Nc=n(660),Pc=Object(Z.b)(As||(As=Object(p.a)(["\n{\n  action_mgmt_disk_info {\n    meta\n  }\n}\n"]))),Dc=Object(Z.b)(Fs||(Fs=Object(p.a)(["\nmutation {\n  action_mgmt_disk_cleanup {\n    success\n  }\n}\n"]))),Ic=Object(Z.b)(Us||(Us=Object(p.a)(["\nmutation ($params: json) {\n  action_mgmt_disk_export_recordings(params: $params) {\n    meta\n    success\n  }\n}\n"]))),$c=Object(Z.b)(Ms||(Ms=Object(p.a)(["\nmutation {\n  action_mgmt_disk_import_recordings {\n    success\n  }\n}\n"]))),Ac=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),Fc=function(){var e,t,n,i,s,c,o=Ac(),u=Object(a.useState)({isOpen:!1,message:""}),p=Object(d.a)(u,1)[0],m=Object(ee.a)(Pc).data,O=Object(Je.a)(Dc),g=Object(d.a)(O,1)[0],x=Object(Je.a)(Ic),f=Object(d.a)(x,1)[0],v=Object(Je.a)($c),_=Object(d.a)(v,1)[0],y=Object(a.useState)({}),w=Object(d.a)(y,2),k=w[0],S=w[1],C=r.a.useState({daysToKeepRecordings:"",cleanupInProgress:!1,exportInProgress:!1,importInProgress:!1,dateFrom:null,dateTo:null}),T=Object(d.a)(C,2),N=T[0],D=T[1],I=r.a.useState({daysToKeepRecordings:!1}),$=Object(d.a)(I,2),A=$[0],F=$[1];Object(a.useEffect)((function(){var e,t,n,a;(null===m||void 0===m||null===(e=m.action_mgmt_disk_info)||void 0===e||null===(t=e.meta)||void 0===t?void 0:t[0])&&S((function(e){var t,n;return Object(l.a)(Object(l.a)({},e),{},{system:null===m||void 0===m||null===(t=m.action_mgmt_disk_info)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n[0]})})),(null===m||void 0===m||null===(n=m.action_mgmt_disk_info)||void 0===n||null===(a=n.meta)||void 0===a?void 0:a[1])&&S((function(e){var t,n;return Object(l.a)(Object(l.a)({},e),{},{store:null===m||void 0===m||null===(t=m.action_mgmt_disk_info)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n[1]})}))}),[m]);var U=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;D((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}));F((function(e){var t,n;return t=e,n=!1,Object.keys(t).forEach((function(e){return t[e]=n})),e}))},M=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("WARNING:\nDisk cleanup is recommended when there are no LIVE sessions.\nAre you sure?")){e.next=3;break}return e.abrupt("return");case 3:return D((function(e){return Object(l.a)(Object(l.a)({},e),{},{cleanupInProgress:!0})})),e.prev=4,e.next=7,g();case 7:t=e.sent,console.log(t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:D((function(e){return Object(l.a)(Object(l.a)({},e),{},{cleanupInProgress:!1})})),alert("Disk cleanup completed.");case 16:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===(t=N.dateFrom)||void 0===t?void 0:t.startOf("day"),r=null===(n=N.dateTo)||void 0===n?void 0:n.endOf("day"),a<=r){e.next=5;break}return F((function(e){return Object(l.a)(Object(l.a)({},e),{},{dateFrom:!0,dateTo:!0})})),e.abrupt("return");case 5:if(window.confirm("WARNING:\nRecordings CAN NOT be played after you exported them!\nAre you sure?")){e.next=8;break}return e.abrupt("return");case 8:return D((function(e){return Object(l.a)(Object(l.a)({},e),{},{exportInProgress:!0})})),e.prev=9,e.next=12,f({variables:{params:{dateFrom:a,dateTo:r}}});case 12:i=e.sent,console.log(i),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),console.log(e.t0);case 19:D((function(e){return Object(l.a)(Object(l.a)({},e),{},{exportInProgress:!1})})),alert("Recordings export completed.");case 21:case"end":return e.stop()}}),e,null,[[9,16]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Move recording files in shared directory to storage?")){e.next=3;break}return e.abrupt("return");case 3:return D((function(e){return Object(l.a)(Object(l.a)({},e),{},{importInProgress:!0})})),e.prev=4,e.next=7,_();case 7:r=e.sent,console.log(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:D((function(e){return Object(l.a)(Object(l.a)({},e),{},{importInProgress:!1})})),!0===(null===(t=r)||void 0===t||null===(n=t.data)||void 0===n||null===(a=n.action_mgmt_disk_import_recordings)||void 0===a?void 0:a.success)?alert("Recordings import completed."):alert("Import failed see browser console for error details");case 16:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:o.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Storage Management",toolbarIcon:Object(W.jsx)(Sc.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:o.root,children:Object(W.jsxs)("form",{className:o.form,noValidate:!0,autoComplete:"off",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Storage information and cleanup"}),Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)("ul",{children:Object(W.jsxs)("li",{children:[Object(W.jsx)("span",{children:" System disk information "}),Object(W.jsxs)("ul",{children:[Object(W.jsxs)("li",{children:["Used Space: ",ie(null===k||void 0===k||null===(e=k.system)||void 0===e?void 0:e.used)]}),Object(W.jsxs)("li",{children:["Available Space: ",ie(null===k||void 0===k||null===(t=k.system)||void 0===t?void 0:t.available)]}),Object(W.jsxs)("li",{children:["Used Capacity: ",null===k||void 0===k||null===(n=k.system)||void 0===n?void 0:n.capacity]})]})]})})}),Object(W.jsxs)(P.a,{item:!0,xs:6,children:[Object(W.jsx)("ul",{children:Object(W.jsxs)("li",{children:[Object(W.jsx)("span",{children:" Store disk information "}),Object(W.jsxs)("ul",{children:[Object(W.jsxs)("li",{children:["Used Space: ",ie(null===k||void 0===k||null===(i=k.store)||void 0===i?void 0:i.used)]}),Object(W.jsxs)("li",{children:["Free Space: ",ie(null===k||void 0===k||null===(s=k.store)||void 0===s?void 0:s.available)]}),Object(W.jsxs)("li",{children:["Used Capacity: ",null===k||void 0===k||null===(c=k.store)||void 0===c?void 0:c.capacity]})]})]})}),Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:o.button,startIcon:Object(W.jsx)(Cc.a,{}),style:{margin:12},onClick:M,disabled:N.cleanupInProgress,children:"Disk cleanup"})]})]}),Object(W.jsx)(he.a,{style:{margin:"2em"}}),Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(ha.a,{component:"legend",children:"Export recordings to shared directory"})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(kn,{onChange:function(e){return U({target:{name:"dateFrom",value:e}})},label:"From date",value:N.dateFrom,size:"small",error:A.dateFrom})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(kn,{onChange:function(e){return U({target:{name:"dateTo",value:e}})},label:"To date",value:N.dateTo,size:"small",error:A.dateFrom})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",className:o.button,startIcon:Object(W.jsx)(Tc.a,{}),style:{margin:17},onClick:L,disabled:N.exportInProgress,children:"Export recordings"})})]}),Object(W.jsx)(he.a,{style:{margin:"2em"}}),Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(ha.a,{component:"legend",children:"Import recordings from shared directory"})}),Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:o.button,startIcon:Object(W.jsx)(Nc.a,{}),style:{margin:12},onClick:E,disabled:N.importInProgress,children:"Import recordings from shared directory"})})]})]})}),Object(W.jsx)(zt.a,{open:p.isOpen,message:p.message})]})},Uc=n(661),Mc=Object(Z.b)(Ls||(Ls=Object(p.a)(["\nquery ($fromDate: timestamptz!) {\n  sessions\n    (\n        order_by: {created_at: desc},\n        where: {\n            created_at: {_gte: $fromDate}\n        }\n    ) {\n    id\n    created_at\n \n  }\n}\n"]))),Lc=function(e){e.sort();for(var t=[],n=null,a=0,r=0;r<e.length;r++)e[r]!==n?(a>0&&t.push({Date:n,sessions:a}),n=e[r],a=1):a++;return a>0&&t.push({Date:n,sessions:a}),t},Ec=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(Mc),s=Object(d.a)(i,1)[0],c=Object(a.useState)({fromDate:new Date((new Date).getTime()-2592e6).toUTCString()}),o=Object(d.a)(c,1)[0],u=Object(ee.a)(s,{variables:o,notifyOnNetworkStatusChange:!0}).data;Object(a.useEffect)((function(){if(u){var e=u.sessions,t=[];e.forEach((function(e){t.push(ae(e.created_at,!1))}));var n=Lc(t);r(n.sort((function(e,t){return new Date(t.Date)-new Date(e.Date)})).reverse())}}),[u]);var b={data:n,xField:"Date",yField:"sessions",label:{position:"middle",style:{fill:"#FFFFFF",opacity:.6}},xAxis:{label:{autoHide:!0,autoRotate:!1}}};return Object(W.jsx)(Uc.a,Object(l.a)({},b))},qc=n(663),Rc=Object(Z.b)(Es||(Es=Object(p.a)(["\nquery Query {\n  connections\n    (order_by: {created_at: desc}) {\n    id\n    name\n    protocol\n    hostname\n  }\n}\n"]))),Bc=function(){var e=Object(a.useState)({}),t=Object(d.a)(e,1)[0],n=Object(a.useState)([]),r=Object(d.a)(n,2),i=r[0],s=r[1],c=Object(ee.a)(Rc,{variables:t,notifyOnNetworkStatusChange:!0}).data;Object(a.useEffect)((function(){if(c){var e=c.connections,t=[];e.forEach((function(e){t.push(e.protocol)}));var n=Lc(t);s(n)}}),[c]);var o={appendPadding:10,data:i,angleField:"sessions",colorField:"Date",radius:.9,label:{type:"inner",offset:"-30%",content:function(e){var t=e.percent;return"".concat((100*t).toFixed(0),"%")},style:{fontSize:14,textAlign:"center"}},interactions:[{type:"element-active"}]};return Object(W.jsx)(qc.a,Object(l.a)({},o))},Wc=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),zc=function(){var e=Wc();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"System Reports",toolbarIcon:Object(W.jsx)(Ge.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)(P.a,{container:!0,children:[Object(W.jsxs)(P.a,{item:!0,xs:6,children:[Object(W.jsx)("div",{style:{padding:"20px"},children:Object(W.jsx)("h3",{children:"Daily sessions"})}),Object(W.jsx)("div",{style:{width:"100%",marginTop:"30px",padding:30},children:Object(W.jsx)(Ec,{})})]}),Object(W.jsxs)(P.a,{item:!0,xs:6,children:[Object(W.jsx)("div",{style:{padding:"20px"},children:Object(W.jsx)("h3",{children:"Connections by protocol"})}),Object(W.jsx)("div",{style:{width:"100%",marginTop:"30px",padding:30},children:Object(W.jsx)(Bc,{})})]})]})})]})},Gc=Object(x.a)((function(e){return{button:{height:100,marginBottom:20},label:{flexDirection:"column"},icon:{fontSize:"32px !important",marginBottom:e.spacing.unit}}})),Kc=function(e){var t=e.icon,n=e.href,a=e.label,r=Gc(),i=t;return Object(W.jsx)(P.a,{item:!0,md:3,sm:6,xs:6,style:{textAlign:"center"},children:Object(W.jsxs)(z.a,{component:o.b,to:"/dashboard/settings/"+n,classes:{root:r.button,label:r.label},children:[Object(W.jsx)(i,{className:r.icon}),a]})})},Hc=n(477),Vc=n.n(Hc),Yc=n(223),Qc=n.n(Yc),Jc=n(87),Xc=n.n(Jc),Zc=n(340),eo=n.n(Zc),to=Object(x.a)((function(e){return{paper:{width:"100%",marginBottom:e.spacing(1)}}})),no=function(e){var t=e.hasFeatures,n=e.hamFeatures,a=e.transparentFeature,r=to();return Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Settings",toolbarIcon:Object(W.jsx)(Vc.a,{style:{margin:"-4px 8px"}})}),Object(W.jsxs)(P.a,{container:!0,children:[Object(W.jsx)(Kc,{label:"System License",href:"system-license",icon:ks.a}),Object(W.jsx)(Kc,{label:"Storage Management",href:"storage-management",icon:Sc.a}),Object(W.jsx)(Kc,{label:"Authentication",href:"authentication",icon:gs.a}),Object(W.jsx)(Kc,{label:"Export and Import",href:"export-import",icon:Gi.a}),Object(W.jsx)(Kc,{label:"Custom Branding",href:"custom-branding",icon:ds.a}),Object(W.jsx)(Kc,{label:"HTTPS Configuration",href:"https-configuration",icon:pc.a}),Object(W.jsx)(Kc,{label:"Syslog Server",href:"syslog-server",icon:Me.a}),Object(W.jsx)(Kc,{label:"System Reports",href:"system-reports",icon:Ge.a}),Object(W.jsx)(Kc,{label:"Server Time",href:"server-time",icon:eo.a}),Object(W.jsx)(Kc,{label:"DNS",href:"set-dns",icon:Se.a}),(t||n)&&Object(W.jsx)(Kc,{label:"High Availability",href:"high-availability",icon:Qc.a}),a&&Object(W.jsx)(Kc,{label:"Transparent Mode",href:"transparent",icon:Xc.a})]})]})},ao=Object(Z.b)(qs||(qs=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  } \n  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),ro=Object(Z.b)(Rs||(Rs=Object(p.a)(["\nmutation ($name: String!, $value: String!) {\n    update_settings(where: {name: {_eq: $name}}, _set: {value: $value})\n    {\n        affected_rows\n    }\n}\n"]))),io=Object(Z.b)(Bs||(Bs=Object(p.a)(['\nmutation ($name: String!, $value: String!) {  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),so=Object(Z.b)(Ws||(Ws=Object(p.a)(["\nquery {\n  action_mgmt_license_info {\n    result\n  }\n}\n"]))),co=Object(Z.b)(zs||(zs=Object(p.a)(['\nmutation MyMutation {\n    delete_settings(where: {type: {_eq: "system"}, name: {_eq: "expiryDateByFeatureEX"}}) {\n      affected_rows\n    }\n}  \n']))),oo=Object(Z.b)(Gs||(Gs=Object(p.a)(['\nquery MyQuery {\n    settings(where: {name: {_eq: "licenseKey"}}) {\n      value\n    }\n}  \n']))),lo=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),uo=function(){var e=lo(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(d.a)(c,2),u=o[0],p=o[1],m=r.a.useState(""),O=Object(d.a)(m,2),h=O[0],g=O[1],x=Object(Je.a)(io),f=Object(d.a)(x,1)[0],v=Object(Je.a)(ao),_=Object(d.a)(v,1)[0],y=Object(Je.a)(ro),w=Object(d.a)(y,1)[0],k=Object(Oe.g)(),S=Object(ln.a)(so),C=Object(d.a)(S,2),T=C[0],N=C[1].data,P=Object(ee.a)(oo,{variables:{},notifyOnNetworkStatusChange:!0}),D=(P.loading,P.error,P.data),I=(P.refetch,r.a.useState(null)),$=Object(d.a)(I,2),A=$[0],F=$[1],U=r.a.useState(!1),M=Object(d.a)(U,2),L=M[0],E=M[1],q=Object(Je.a)(co),R=Object(d.a)(q,1)[0];Object(a.useEffect)((function(){var e;D&&F(null===D||void 0===D||null===(e=D.settings[0])||void 0===e?void 0:e.value)}),[D]),Object(a.useEffect)(Object(j.a)(b.a.mark((function e(){var t,n,a,r,i,c,o,d,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===N||void 0===N||null===(t=N.action_mgmt_license_info)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.isLicenseValid)){e.next=18;break}if(L){e.next=16;break}if(null===(i=null===N||void 0===N||null===(a=N.action_mgmt_license_info)||void 0===a||null===(r=a.result)||void 0===r?void 0:r.features)||void 0===i?void 0:i.includes("ex")){e.next=9;break}return e.next=6,R();case 6:e.sent,e.next=16;break;case 9:return(d=null===N||void 0===N||null===(c=N.action_mgmt_license_info)||void 0===c||null===(o=c.result)||void 0===o?void 0:o.expiryDateByFeatureEX)||(d=2),u=(u=(new Date).getTime()+3600*parseInt(d)*24*1e3).toString(),e.next=15,_({variables:{name:"expiryDateByFeatureEX",value:u}});case 15:e.sent;case 16:s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})})),k.goBack()}),1500);case 18:case"end":return e.stop()}}),e)}))),[N]);var B=function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(p(!0),E(t==A),e.prev=4,!(null===D||void 0===D||null===(n=D.settings[0])||void 0===n?void 0:n.value)){e.next=11;break}return e.next=8,f({variables:{name:"licenseKey",value:t}});case 8:e.sent,e.next=14;break;case 11:return e.next=13,w({variables:{name:"licenseKey",value:t}});case 13:e.sent;case 14:T(),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),console.log(e.t0),alert("Data access error");case 21:p(!1);case 22:case"end":return e.stop()}}),e,null,[[4,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"System License Renew",toolbarIcon:Object(W.jsx)(ks.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",children:[Object(W.jsx)(je.a,{id:"license-key",label:"License Key",type:"text",variant:"outlined",fullWidth:!0,onChange:function(e){g(e.target.value)},name:"licenseKey",value:h,autoFocus:!0}),Object(W.jsx)(Hi,{onClickDone:function(){return B(h)},inProgress:u,backLinkUrl:"/dashboard/settings"})]})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},bo=Object(Z.b)(Ks||(Ks=Object(p.a)(["\nmutation ($answer: String) {\n  action_mgmt_license_challenge(answer: $answer) {\n    success\n    challengeCode\n  }\n}\n"]))),jo=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)},challenge:{fontFamily:"monospace",fontWeight:"bold",fontSize:"20px"}}})),po=function(){var e=jo(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(d.a)(c,2),u=o[0],p=o[1],m=r.a.useState(""),O=Object(d.a)(m,2),h=O[0],g=O[1],x=r.a.useState(""),f=Object(d.a)(x,2),v=f[0],_=f[1],y=Object(Je.a)(bo),w=Object(d.a)(y,1)[0],k=Object(Oe.g)(),S=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({variables:{answer:null}});case 2:n=e.sent,a=n.data,_(null===a||void 0===a||null===(t=a.action_mgmt_license_challenge)||void 0===t?void 0:t.challengeCode);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)(S,[]);var C=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:p(!0);try{r=w({variables:{answer:t}}),console.log(r),(null===r||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.action_mgmt_license_challenge)||void 0===a?void 0:a.success)?(s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})})),k.goBack()}),1e3)):alert("Answer code not valid")}catch(i){console.log(i),alert("Data access error")}p(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"System License Challenge",toolbarIcon:Object(W.jsx)(ks.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",children:[Object(W.jsx)(je.a,{label:"Challenge Code",type:"text",variant:"outlined",fullWidth:!0,className:e.challenge,value:v,InputProps:{readOnly:!0}}),Object(W.jsx)(je.a,{id:"Answer-Code",label:"Answer Code",type:"text",variant:"outlined",fullWidth:!0,onChange:function(e){g(e.target.value)},name:"licenseKey",value:h,autoFocus:!0}),Object(W.jsx)(Hi,{onClickDone:function(){return C(h)},inProgress:u,backLinkUrl:"/dashboard/settings"})]})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},mo=n(478),Oo=n.n(mo),ho=Object(Z.b)(Hs||(Hs=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  }  \n  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),go=Object(Z.b)(Vs||(Vs=Object(p.a)(['\nquery {\n  settings (where: {_and: [\n    {type: {_eq: "system"}},\n  ]}) {\n    name\n    value\n  }\n}\n']))),xo=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),fo=function(){var e=xo(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=(n[1],r.a.useState(!1)),c=Object(d.a)(s,2),o=(c[0],c[1],Object(ee.a)(go)),l=o.loading,u=o.error,b=o.data,j=Object(Je.a)(ho),p=Object(d.a)(j,1)[0],m=r.a.useState(""),O=Object(d.a)(m,2),h=O[0],g=O[1];return r.a.useEffect((function(){if(!l&&!u){var e={};b.settings.forEach((function(t){return e[t.name]=t.value})),g(null===e||void 0===e?void 0:e.haMySecret)}}),[b]),Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"High Availability (Master)",toolbarIcon:Object(W.jsx)(Qc.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsx)("form",{className:e.form,noValidate:!0,autoComplete:"off",children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:10,children:Object(W.jsx)(je.a,{label:"Master Secret",type:"pwd",fullWidth:!0,variant:"outlined",InputProps:{readOnly:!0},value:h})}),Object(W.jsx)(P.a,{item:!0,xs:2,children:Object(W.jsx)(w.a,{style:{margin:"15px 0px"},color:"primary",onClick:function(){if(window.confirm("Warning : \nRegenerating Secret Means That The Old Secret Will No longer Work \nAre You sure?")){var e=mr()()+mr()();g(e),p({variables:{name:"haMySecret",value:e}})}},children:Object(W.jsx)(Oo.a,{margin:"normal"})})})]})})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},vo=Object(Z.b)(Ys||(Ys=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  }  \n  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),_o=Object(Z.b)(Qs||(Qs=Object(p.a)(['\nquery {\n  settings (where: {_and: [\n    {type: {_eq: "system"}},\n  ]}) {\n    name\n    value\n  }\n}\n']))),yo=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),wo=function(){var e,t=yo(),n=Object(a.useState)({isOpen:!1,message:""}),i=Object(d.a)(n,2),s=i[0],c=i[1],o=r.a.useState(!1),u=Object(d.a)(o,2),p=u[0],m=u[1],O=r.a.useState({haSyncActive:!1,haMasterAddress:"",haMasterSecret:"",haSyncIntervalMinutes:""}),g=Object(d.a)(O,2),x=g[0],f=g[1],v=r.a.useState({haMasterAddress:!1,haMasterSecret:!1,haSyncIntervalMinutes:!1}),_=Object(d.a)(v,2),y=_[0],w=_[1],k=Object(ee.a)(_o),S=k.loading,T=k.error,N=k.data,D=Object(Je.a)(vo),I=Object(d.a)(D,1)[0],$=r.a.useState(""),A=Object(d.a)($,2),F=A[0],U=A[1];r.a.useEffect((function(){if(!S&&!T){var e={};N.settings.forEach((function(t){return e[t.name]=t.value}));try{var t=parseInt(null===e||void 0===e?void 0:e.haLastSyncAt);t=ae(t),U(t)}catch(T){U("Never")}f((function(t){return Object(l.a)(Object(l.a)(Object(l.a)({},t),e),{},{haSyncActive:"true"===e.haSyncActive})}))}}),[N]);var M=function(e){var t=e.target.name,n="checkbox"===e.target.type?e.target.checked:e.target.value;f((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}));w((function(e){var t,n;return t=e,n=!1,Object.keys(t).forEach((function(e){return t[e]=n})),e}))},L=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,I({variables:{name:"haSyncActive",value:JSON.stringify(x.haSyncActive)}});case 4:return e.next=6,I({variables:{name:"haMasterAddress",value:x.haMasterAddress}});case 6:return e.next=8,I({variables:{name:"haMasterSecret",value:x.haMasterSecret}});case 8:return e.next=10,I({variables:{name:"haSyncIntervalMinutes",value:x.haSyncIntervalMinutes}});case 10:c({message:"Successful",isOpen:!0}),setTimeout((function(){c((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),alert("Data access error");case 18:m(!1);case 19:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:t.paper,children:[Object(W.jsx)(be,{toolbarTitle:"High Availability (Slave)",toolbarIcon:Object(W.jsx)(Qc.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:t.root,children:Object(W.jsxs)("form",{className:t.form,noValidate:!0,autoComplete:"off",onSubmit:L,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{label:"Master URL Address",type:"text",variant:"outlined",fullWidth:!0,onChange:M,name:"haMasterAddress",value:x.haMasterAddress,error:y.haMasterAddress,helperText:"Example: http://192.168.1.10/data-service"})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{label:"Master Secret",type:"pwd",variant:"outlined",fullWidth:!0,onChange:M,name:"haMasterSecret",value:x.haMasterSecret,error:y.haMasterSecret})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,(e={variant:"outlined",label:"Sync Interval Minutes",margin:"normal",align:"left",value:x.haSyncIntervalMinutes,fullWidth:!0,select:!0,onChange:M,name:"haSyncIntervalMinutes"},Object(h.a)(e,"value",x.haSyncIntervalMinutes),Object(h.a)(e,"error",y.haSyncIntervalMinutes),Object(h.a)(e,"children",[120,240,720,1440,2880].map((function(e){return Object(W.jsxs)(C.a,{value:e.toString(),children:[e," Minutes"]},e)}))),e))}),Object(W.jsx)(P.a,{item:!0,md:6,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"High Availability Sync Activate"}),Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:x.haSyncActive,onChange:M,name:"haSyncActive"}),label:"Sync Activate"})})]})})]}),Object(W.jsx)(he.a,{style:{margin:"2em"}}),Object(W.jsxs)("p",{children:["Last Sync At : ",Object(W.jsx)("b",{children:F})]}),Object(W.jsx)(Hi,{onClickDone:L,inProgress:p})]})}),Object(W.jsx)(zt.a,{open:s.isOpen,message:s.message})]})},ko=Object(Z.b)(Js||(Js=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  }  \n  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),So=Object(Z.b)(Xs||(Xs=Object(p.a)(['\nquery {\n  settings (where: {_and: [\n    {type: {_eq: "system"}},\n  ]}) {\n    name\n    value\n  }\n}\n']))),Co=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),To=function(){var e=Co(),t=Object(a.useState)({isOpen:!1,message:""}),n=Object(d.a)(t,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(d.a)(c,2),u=o[0],p=o[1],m=Object(a.useState)({transparentModeRDP:!1,transparentIpAddress:""}),O=Object(d.a)(m,2),h=O[0],g=O[1],x=Object(ee.a)(So),f=x.loading,v=x.error,_=x.data,y=Object(Je.a)(ko),w=Object(d.a)(y,1)[0];r.a.useEffect((function(){if(!f&&!v){var e={};if(_.settings.forEach((function(t){return e[t.name]=t.value})),null===e||void 0===e?void 0:e.transparentModeRDP){var t=!1;"true"===(null===e||void 0===e?void 0:e.transparentModeRDP)&&(t=!0),g((function(e){return Object(l.a)(Object(l.a)({},e),{},{transparentModeRDP:t})}))}(null===e||void 0===e?void 0:e.transparentIpAddress)&&g((function(t){return Object(l.a)(Object(l.a)({},t),{},{transparentIpAddress:null===e||void 0===e?void 0:e.transparentIpAddress})}))}}),[_]);var k=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,w({variables:{name:"transparentModeRDP",value:JSON.stringify(h.transparentModeRDP)}});case 4:return e.next=6,w({variables:{name:"transparentIpAddress",value:h.transparentIpAddress}});case 6:s({message:"Successful",isOpen:!0}),setTimeout((function(){s((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),alert("Data access error");case 14:p(!1);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Transparent Mode",toolbarIcon:Object(W.jsx)(Xc.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsxs)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:k,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,md:12,children:Object(W.jsxs)(mn.a,{component:"fieldset",children:[Object(W.jsx)(ha.a,{component:"legend",children:"Permission to use transparent mode"}),Object(W.jsx)(On.a,{style:{padding:"1em 2em"},children:Object(W.jsx)(hn.a,{control:Object(W.jsx)(gn.a,{checked:h.transparentModeRDP,onChange:function(e){g((function(t){return Object(l.a)(Object(l.a)({},t),{},{transparentModeRDP:e.target.checked})}))},name:"haSyncActive"}),label:"Allows transparent mode to be used for RDP connections"})})]})}),Object(W.jsx)(P.a,{item:!0,lg:4,children:Object(W.jsx)(je.a,{label:"Transparent IP Address",type:"text",variant:"outlined",fullWidth:!0,onChange:function(e){g((function(t){return Object(l.a)(Object(l.a)({},t),{},{transparentIpAddress:e.target.value})}))},value:null===h||void 0===h?void 0:h.transparentIpAddress,helperText:"Example: http://192.168.1.10"})})]}),Object(W.jsx)(Hi,{onClickDone:k,inProgress:u})]})}),Object(W.jsx)(zt.a,{open:i.isOpen,message:i.message})]})},No=Object(Z.b)(Zs||(Zs=Object(p.a)(["\nmutation ($date: String!) {\n    action_set_time_server(date: $date) {\n      result\n      time\n    }\n}\n"]))),Po=Object(Z.b)(ec||(ec=Object(p.a)(["\nmutation{\n    action_say_time_server{\n        result\n        time\n    }\n}\n"]))),Do=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),Io=function(e){var t=e.loggedInUser,n=Yi(),i=Object(a.useState)({isOpen:!1,message:""}),s=Object(d.a)(i,2),c=s[0],o=s[1],u=r.a.useState(!0),p=Object(d.a)(u,2),m=p[0],O=p[1],g=Do(),x=r.a.useState({year:"",month:"",day:"",hour:"",minute:""}),f=Object(d.a)(x,2),v=f[0],_=f[1],y=r.a.useState({year:"",month:"",day:"",hour:"",minute:""}),w=Object(d.a)(y,2),k=w[0],S=w[1],C=Object(Je.a)(Po),T=Object(d.a)(C,1)[0],N=Object(Je.a)(No),D=Object(d.a)(N,1)[0],I=function(e){var t=e.target.name,n=e.target.value;"year"==t&&((""==n||n<2e3)&&(n=2e3),_((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}))),"month"==t&&(""==n||n<1?n=1:n>12&&(n=12),_((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}))),"day"==t&&(""==n||n<1?n=1:n>31&&(n=31),_((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}))),"hour"==t&&(""==n||n<0?n=0:n>23&&(n=23),_((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}))),"minute"==t&&(""==n||n<1?n=1:n>59&&(n=59),_((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))})))},$=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,i,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Date(t),a=n.getFullYear(),r=n.getMonth()+1,i=n.getDate(),s=n.getUTCHours(),c=n.getUTCMinutes(),_((function(e){return Object(l.a)(Object(l.a)({},e),{},{year:a})})),_((function(e){return Object(l.a)(Object(l.a)({},e),{},{month:r})})),_((function(e){return Object(l.a)(Object(l.a)({},e),{},{day:i})})),_((function(e){return Object(l.a)(Object(l.a)({},e),{},{hour:s})})),_((function(e){return Object(l.a)(Object(l.a)({},e),{},{minute:c})}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(Object(j.a)(b.a.mark((function e(){var t,n,a,r,i,s,c,o,d,u,j,p,m,h;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T();case 3:if(!(null===(i=e.sent)||void 0===i||null===(t=i.data)||void 0===t||null===(n=t.action_say_time_server)||void 0===n?void 0:n.result)){e.next=22;break}return o=null===i||void 0===i||null===(s=i.data)||void 0===s||null===(c=s.action_say_time_server)||void 0===c?void 0:c.time.trim(),e.next=8,$(o);case 8:d=new Date(o),u=d.getFullYear(),j=d.getMonth()+1,p=d.getDate(),m=d.getUTCHours(),h=d.getUTCMinutes(),S((function(e){return Object(l.a)(Object(l.a)({},e),{},{year:u})})),S((function(e){return Object(l.a)(Object(l.a)({},e),{},{month:j})})),S((function(e){return Object(l.a)(Object(l.a)({},e),{},{day:p})})),S((function(e){return Object(l.a)(Object(l.a)({},e),{},{hour:m})})),S((function(e){return Object(l.a)(Object(l.a)({},e),{},{minute:h})})),O(!1),e.next=23;break;case 22:(null===i||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.action_say_time_server)||void 0===r?void 0:r.result)||(alert(null===i||void 0===i?void 0:i.time),O(!1));case 23:e.next=30;break;case 25:e.prev=25,e.t0=e.catch(0),console.log(e.t0),alert(e.t0),O(!1);case 30:case"end":return e.stop()}}),e,null,[[0,25]])}))),[]);var A=function(){var e=Object(j.a)(b.a.mark((function e(){var a,r,i,s,c,d,u,j,p,m,h;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=v.year){e.next=3;break}return alert('Field " Year " is empty'),e.abrupt("return");case 3:if(""!=v.month){e.next=6;break}return alert('Field " Month " is empty'),e.abrupt("return");case 6:if(""!=v.day){e.next=9;break}return alert('Field " Day " is empty'),e.abrupt("return");case 9:if(""!=v.hour){e.next=12;break}return alert('Field " Hour " is empty'),e.abrupt("return");case 12:if(""!=v.minute){e.next=15;break}return alert('Field " Minute " is empty'),e.abrupt("return");case 15:return a="".concat(v.year,"-").concat(v.month,"-").concat(v.day," ").concat(v.hour,":").concat(v.minute,":00"),O(!0),e.prev=17,e.next=20,D({variables:{date:a}});case 20:if(!(null===(d=e.sent)||void 0===d||null===(r=d.data)||void 0===r||null===(i=r.action_set_time_server)||void 0===i?void 0:i.result)){e.next=34;break}return p=null===d||void 0===d||null===(u=d.data)||void 0===u||null===(j=u.action_set_time_server)||void 0===j?void 0:j.time.trim(),e.next=25,$(p);case 25:return m="".concat(v.year,"-").concat(v.month,"-").concat(v.day," ").concat(v.hour,":").concat(v.minute,":00"),h="".concat(k.year,"-").concat(k.month,"-").concat(k.day," ").concat(k.hour,":").concat(k.minute,":00"),e.next=29,n("Time Server Changed","Time Server changed to ".concat(m),{new:m},{old:h},null===t||void 0===t?void 0:t.id,null===t||void 0===t?void 0:t.username);case 29:O(!1),o({message:"Successful. Server reboot is required.",isOpen:!0}),setTimeout((function(){o((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=35;break;case 34:(null===d||void 0===d||null===(s=d.data)||void 0===s||null===(c=s.action_say_time_server)||void 0===c?void 0:c.result)||(alert(null===d||void 0===d?void 0:d.time),O(!1));case 35:e.next=42;break;case 37:e.prev=37,e.t0=e.catch(17),console.log(e.t0),alert(e.t0),O(!1);case 42:case"end":return e.stop()}}),e,null,[[17,37]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:g.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Server Time",toolbarIcon:Object(W.jsx)(eo.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:g.root,children:Object(W.jsxs)("form",{className:g.form,noValidate:!0,autoComplete:"off",children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,md:2,children:Object(W.jsx)(je.a,{label:"Year",type:"number",InputProps:{inputProps:{min:2e3,max:2040}},variant:"outlined",fullWidth:!0,name:"year",value:v.year,onChange:I,helperText:"Example: 2023"})}),Object(W.jsx)(P.a,{item:!0,md:2,children:Object(W.jsx)(je.a,{label:"Month",type:"number",InputProps:{inputProps:{min:1,max:12}},variant:"outlined",fullWidth:!0,name:"month",value:v.month,onChange:I,helperText:"Example: 1-12"})}),Object(W.jsx)(P.a,{item:!0,md:2,children:Object(W.jsx)(je.a,{label:"Day",type:"number",InputProps:{inputProps:{min:1,max:31}},variant:"outlined",fullWidth:!0,name:"day",value:v.day,onChange:I,helperText:"Example: 1-31"})}),Object(W.jsx)(P.a,{item:!0,md:2}),Object(W.jsx)(P.a,{item:!0,md:2,children:Object(W.jsx)(je.a,{label:"Hour",variant:"outlined",fullWidth:!0,name:"hour",type:"number",InputProps:{inputProps:{min:0,max:23}},value:v.hour,onChange:I,helperText:"Example: 0-23"})}),Object(W.jsx)(P.a,{item:!0,md:2,children:Object(W.jsx)(je.a,{label:"Minute",type:"number",InputProps:{inputProps:{min:1,max:59}},variant:"outlined",fullWidth:!0,name:"minute",value:v.minute,onChange:I,helperText:"Example: 0-59"})})]}),Object(W.jsx)(P.a,{item:!0,md:12,children:Object(W.jsx)("h4",{children:"* The server time must be UTC, and if the time is changed incorrectly, the time of all events will be recorded incorrectly, and the time changer is responsible for that. After changing the time, you must reboot the server once."})}),Object(W.jsx)(Hi,{onClickDone:A,inProgress:m})]})}),Object(W.jsx)(zt.a,{open:c.isOpen,message:c.message})]})},$o=Object(Z.b)(tc||(tc=Object(p.a)(["\nmutation {\n    action_dns_get {\n        result\n        DNS1\n        DNS2\n    }\n}\n"]))),Ao=Object(Z.b)(nc||(nc=Object(p.a)(["\nmutation {\n    action_dns_remove {\n        result\n        DNS1\n        DNS2\n    }\n}\n"]))),Fo=Object(Z.b)(ac||(ac=Object(p.a)(["\nmutation ($DNS1: String!, $DNS2: String!) {\n    action_dns_set(DNS1: $DNS1, DNS2: $DNS2) {\n        result\n        DNS1\n        DNS2\n        msg\n    }\n}\n"]))),Uo=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(5)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)},wrapper:{margin:e.spacing(1),position:"relative",display:"inline"},formFooter:{textAlign:"right",padding:e.spacing(1)}}})),Mo=function(e){var t=e.loggedInUser,n=Yi(),i=Object(a.useState)({isOpen:!1,message:""}),s=Object(d.a)(i,2),c=s[0],o=s[1],u=r.a.useState(!0),p=Object(d.a)(u,2),m=p[0],O=p[1],g=Uo(),x=r.a.useState({DNS1:"",DNS2:""}),f=Object(d.a)(x,2),v=f[0],_=f[1],y=r.a.useState({DNS1:"",DNS2:""}),w=Object(d.a)(y,2),k=w[0],S=w[1],C=Object(Je.a)(Fo),T=Object(d.a)(C,1)[0],N=Object(Je.a)(Ao),D=Object(d.a)(N,1)[0],I=Object(Je.a)($o),$=Object(d.a)(I,1)[0],A=function(){var e=Object(j.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_((function(e){return Object(l.a)(Object(l.a)({},e),{},{DNS1:t})})),_((function(e){return Object(l.a)(Object(l.a)({},e),{},{DNS2:n})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();Object(a.useEffect)(Object(j.a)(b.a.mark((function e(){var t,n,a,r,i,s,c,o,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$();case 3:if(!(null===(i=e.sent)||void 0===i||null===(t=i.data)||void 0===t||null===(n=t.action_dns_get)||void 0===n?void 0:n.result)){e.next=12;break}return S((function(e){var t,n;return Object(l.a)(Object(l.a)({},e),{},{DNS1:null===i||void 0===i||null===(t=i.data)||void 0===t||null===(n=t.action_dns_get)||void 0===n?void 0:n.DNS1})})),S((function(e){var t,n;return Object(l.a)(Object(l.a)({},e),{},{DNS2:null===i||void 0===i||null===(t=i.data)||void 0===t||null===(n=t.action_dns_get)||void 0===n?void 0:n.DNS2})})),e.next=9,A(null===i||void 0===i||null===(s=i.data)||void 0===s||null===(c=s.action_dns_get)||void 0===c?void 0:c.DNS1,null===i||void 0===i||null===(o=i.data)||void 0===o||null===(d=o.action_dns_get)||void 0===d?void 0:d.DNS2);case 9:O(!1),e.next=13;break;case 12:(null===i||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.action_dns_get)||void 0===r?void 0:r.result)||(alert("There is an error to get DNS."),O(!1));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0),O(!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])}))),[]);var F=function(e){var t=e.target.name,n=e.target.value;n=n.trim(),_((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},t,n))}))},U=function(){var e=Object(j.a)(b.a.mark((function e(){var a,r,i,s,c,d,u,j,p,m,h;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=v.DNS1||""!=v.DNS2){e.next=3;break}return alert("You must enter at least one DNS!"),e.abrupt("return");case 3:return O(!0),e.prev=4,e.next=7,T({variables:{DNS1:v.DNS1,DNS2:v.DNS2}});case 7:if(!(null===(c=e.sent)||void 0===c||null===(a=c.data)||void 0===a||null===(r=a.action_dns_set)||void 0===r?void 0:r.result)){e.next=18;break}return e.next=11,A(null===c||void 0===c||null===(d=c.data)||void 0===d||null===(u=d.action_dns_set)||void 0===u?void 0:u.DNS1,null===c||void 0===c||null===(j=c.data)||void 0===j||null===(p=j.action_dns_set)||void 0===p?void 0:p.DNS2);case 11:return e.next=13,n("The DNS Changed","DNS1 changed : ".concat(null===v||void 0===v?void 0:v.DNS1," \n DNS2 changed : ").concat(null===v||void 0===v?void 0:v.DNS2),{DNS1:null===v||void 0===v?void 0:v.DNS1,DNS2:null===v||void 0===v?void 0:v.DNS2},{DNS1:null===k||void 0===k?void 0:k.DNS1,DNS2:null===k||void 0===k?void 0:k.DNS2},null===t||void 0===t?void 0:t.id,null===t||void 0===t?void 0:t.username);case 13:o({message:"Successful",isOpen:!0}),setTimeout((function(){o((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),O(!1),e.next=19;break;case 18:(null===c||void 0===c||null===(i=c.data)||void 0===i||null===(s=i.action_dns_get)||void 0===s?void 0:s.result)||(alert(null===c||void 0===c||null===(m=c.data)||void 0===m||null===(h=m.action_dns_set)||void 0===h?void 0:h.msg),O(!1));case 19:e.next=26;break;case 21:e.prev=21,e.t0=e.catch(4),console.log(e.t0),alert(e.t0),O(!1);case 26:case"end":return e.stop()}}),e,null,[[4,21]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(j.a)(b.a.mark((function e(){var a,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.prev=1,e.next=4,D();case 4:if(!(null===(i=e.sent)||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.action_dns_remove)||void 0===r?void 0:r.result)){e.next=15;break}return e.next=8,A("","");case 8:return e.next=10,n("The DNS removed","DNS1 changed : '' \n DNS2 changed : ''",{DNS1:null===v||void 0===v?void 0:v.DNS1,DNS2:null===v||void 0===v?void 0:v.DNS2},{DNS1:null===k||void 0===k?void 0:k.DNS1,DNS2:null===k||void 0===k?void 0:k.DNS2},null===t||void 0===t?void 0:t.id,null===t||void 0===t?void 0:t.username);case 10:o({message:"Successful: DNS Removed",isOpen:!0}),O(!1),setTimeout((function(){o((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=17;break;case 15:alert("There is an error to remove DNS."),O(!1);case 17:e.next=24;break;case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0),alert(e.t0),O(!1);case 24:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)(X.a,{className:g.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Set DNS",toolbarIcon:Object(W.jsx)(Se.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/settings"}),Object(W.jsx)("div",{className:g.root,children:Object(W.jsxs)("form",{className:g.form,noValidate:!0,autoComplete:"off",children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{label:"DNS 1",type:"text",value:v.DNS1,variant:"outlined",fullWidth:!0,name:"DNS1",onChange:F,helperText:"Example: 192.168.1.1"})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{label:"DNS 2",type:"text",value:v.DNS2,variant:"outlined",fullWidth:!0,name:"DNS2",onChange:F,helperText:"Example: 192.168.1.1"})})]}),Object(W.jsx)("div",{className:g.formFooter,children:Object(W.jsx)("div",{className:g.wrapper,children:Object(W.jsx)(z.a,{color:"primary",onClick:M,size:"large",children:"Remove DNS"})})}),Object(W.jsx)(Hi,{onClickDone:U,inProgress:m})]})}),Object(W.jsx)(zt.a,{open:c.isOpen,message:c.message})]})},Lo=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}}})),Eo=function(e){var t,n,a,r,i,s=e.licenseInfo,c=e.loggedInUser,o=Lo(),l=null===s||void 0===s||null===(t=s.action_mgmt_license_info)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.features,d=null===l||void 0===l||null===(a=l.includes)||void 0===a?void 0:a.call(l,"ham"),u=null===l||void 0===l||null===(r=l.includes)||void 0===r?void 0:r.call(l,"has"),b=null===l||void 0===l||null===(i=l.includes)||void 0===i?void 0:i.call(l,"trs");return Object(W.jsx)("div",{className:o.root,style:{width:"100%"},children:Object(W.jsxs)(Oe.d,{children:[Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings",children:Object(W.jsx)(no,{hasFeatures:u,hamFeatures:d,transparentFeature:b})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/system-license",component:bc}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/system-license/edit",component:uo}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/system-license/challenge",component:po}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/storage-management",component:Fc}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/authentication",component:ys}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/export-import",render:function(){return Object(W.jsx)(os,{loggedInUser:c})}}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/custom-branding",component:Os}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/https-configuration",component:fc}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/syslog-server",component:kc}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/system-reports",component:zc}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/server-time",render:function(){return Object(W.jsx)(Io,{loggedInUser:c})}}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/set-dns",render:function(){return Object(W.jsx)(Mo,{loggedInUser:c})}}),Object(W.jsxs)(Oe.b,{exact:!0,path:"/dashboard/settings/high-availability",children:[d&&Object(W.jsx)(fo,{}),u&&Object(W.jsx)(wo,{})]}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/settings/transparent",children:b&&Object(W.jsx)(To,{})})]})})},qo=Object(x.a)((function(e){return{root:{width:"100%"}}})),Ro=Object(Z.b)(rc||(rc=Object(p.a)(['\nquery {\n  sessions(\n    order_by: {created_at: desc},\n    where: {status: {_eq: "live"}}\n  ) {\n    id\n    meta\n    status\n    access_rule {\n      name\n      meta\n    }\n    connection {\n      name\n    }\n    user {\n      username\n    }\n  }\n}\n']))),Bo=Object(Z.b)(ic||(ic=Object(p.a)(['\nquery ($filter: String!) {\n  sessions(\n    order_by: {created_at: desc}, \n    where: {\n    _or: [\n      {status: {_eq: "live"}}, \n      {connection: {name: {_ilike: $filter}}},\n      {user: {username: {_ilike: $filter}}},\n      {access_rule: {name: {_ilike: $filter}}},\n    ]\n  }) {\n    id\n    meta\n    status\n    access_rule {\n      name\n    }\n    connection {\n      name\n    }\n    user {\n      username\n    }\n  }\n}\n']))),Wo=[{id:"play",numeric:!1,disablePadding:!0,label:""},{id:"username",numeric:!1,disablePadding:!1,label:"Username"},{id:"connection",numeric:!1,disablePadding:!1,label:"Connection"},{id:"access_rule",numeric:!1,disablePadding:!1,label:"Access Rule"},{id:"status",numeric:!1,disablePadding:!1,label:"Status"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Started - Closed At"}],zo=function(){var e=qo(),t=Object(a.useState)(Ro),n=Object(d.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)(!1),c=Object(d.a)(s,2),o=c[0],l=c[1],u=Object(a.useState)({}),b=Object(d.a)(u,2),j=b[0],p=b[1],m=Object(ee.a)(r,{variables:j,notifyOnNetworkStatusChange:!0}),O=m.loading,h=m.data,g=m.refetch,x=Object(a.useState)([]),f=Object(d.a)(x,2),v=f[0],_=f[1];Object(a.useEffect)((function(){y()}),[o]),Object(a.useEffect)((function(){g()}),[]),Object(a.useEffect)((function(){var e,t=null!==(e=null===h||void 0===h?void 0:h.sessions)&&void 0!==e?e:[];_(t)}),[h]);var y=function(e){o&&e&&""!==e.target.value.trim()?w("%"+e.target.value.trim()+"%"):k()},w=function(e){i(Bo),p({filter:e})},k=function(){i(Ro),p({})};return Object(W.jsx)("div",{className:e.root,children:Object(W.jsx)(Ct,{rowsSelectable:!1,rowsAddable:!1,tableTitle:"Live Sessions",rows:v,showProgress:O,headCells:Wo,rowCells:function(e){var t=e.row;return Object(W.jsx)(ai,{row:t})},onClickRefresh:function(){g()},onClickFilter:function(){l((function(e){return!e}))},showFilterPanel:o,onChangeFilterText:y,toolbarIcon:Object(W.jsx)(_e.a,{style:{margin:"-4px 8px"}})})})},Go=n(479),Ko=n.n(Go),Ho=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function Vo(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=Ho(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var Yo=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}}}})),Qo=Object(Z.b)(sc||(sc=Object(p.a)(["\nquery {\n  action_auth_locked_users {\n    id\n    user {\n      id\n      username\n      name\n      meta\n      role\n    }\n  }\n}\n"]))),Jo=Object(Z.b)(cc||(cc=Object(p.a)(["\nmutation ($userId: uuid!) {\n  action_auth_locked_users_unlock(userId: $userId) {\n    success\n  }\n}\n"]))),Xo=[{id:"unlock",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"username",numeric:!1,disablePadding:!1,label:"Username"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"role",numeric:!1,disablePadding:!1,label:"Role"},{id:"authentication-type",numeric:!1,disablePadding:!1,label:"Authentication"}],Zo=function(){var e,t=Yo(),n=Object(a.useState)(!1),r=Object(d.a)(n,2),i=r[0],s=r[1],c=Object(a.useState)(Qo),l=Object(d.a)(c,2),u=l[0],p=(l[1],Object(a.useState)(!1)),m=Object(d.a)(p,2),O=m[0],h=m[1],g=Object(a.useState)({}),x=Object(d.a)(g,2),f=x[0],v=(x[1],Object(ee.a)(u,{variables:f,notifyOnNetworkStatusChange:!0})),_=v.loading,y=(v.error,v.data),S=v.refetch,C=Object(Je.a)(Jo),T=Object(d.a)(C,1)[0];Object(a.useEffect)((function(){N()}),[O]),Object(a.useEffect)((function(){S()}),[]);var N=function(e){O&&e&&""!==e.target.value.trim()?P("%"+e.target.value.trim()+"%"):D()},P=function(e){},D=function(){},I=(Object(Oe.g)(),function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T({variables:{userId:t}});case 2:return e.next=4,S();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$=Object(a.useState)([]),A=Object(d.a)($,2),F=A[0],U=A[1],M=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting"),console.log(F),e.next=4,S();case 4:s(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:t.root,children:[Object(W.jsx)(Ct,{rowsSelectable:!1,tableTitle:"Locked Users",rows:null!==(e=null===y||void 0===y?void 0:y.action_auth_locked_users)&&void 0!==e?e:[],showProgress:_,rowsAddable:!1,rowsFilterable:!1,headCells:Xo,rowCells:function(e){var t=e.row;return t=t.user,Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Unlock",children:Object(W.jsx)(w.a,{onClick:function(e){return I(t.id)},color:"primary","aria-label":"Unlock",children:Object(W.jsx)(Ko.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.username}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.role}),Object(W.jsxs)(Ve.a,{align:"right",style:{width:50,textAlign:"center"},children:["internal"===t.meta.authType&&Object(W.jsx)(k.a,{title:"Internal",children:Object(W.jsx)(It.a,{fontSize:"small"})}),"external"===t.meta.authType&&Object(W.jsx)(k.a,{title:"External",children:Object(W.jsx)(At.a,{fontSize:"small"})})]})]})},onClickDelete:function(e){console.log(e),U(e),s(!0)},onClickRefresh:function(){S()},onClickFilter:function(){h((function(e){return!e}))},showFilterPanel:O,onChangeFilterText:N,addLinkUrl:"/dashboard/users/add",extraToolbar:function(){return Object(W.jsx)(k.a,{title:"Users",children:Object(W.jsx)(w.a,{"aria-label":"refresh",component:o.b,to:"users",children:Object(W.jsx)(B.a,{})})})},toolbarIcon:Object(W.jsx)(B.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(Vo,{isOpen:i,closeMe:function(){s(!1)},onConfirm:M,itemsCount:F.length})]})},el=n(489),tl=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function nl(e){var t=e.isOpen,n=e.closeMe,r=e.contentText,i=e.contentDescription,s=e.contentDatetime,c=tl(),o=Object(a.useState)(!1),l=Object(d.a)(o,2),u=l[0],b=l[1],j=function(){n()},p=[],m=r?JSON.parse(r):{};for(var O in m.data&&delete m.data,m)p.push({key:O.replaceAll(/_/g," "),value:m[O]});return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:j,BackdropProps:{classes:{root:c.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"md",children:[Object(W.jsx)(nt.a,{id:"alert-dialog-title",children:"Log Details"}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:[Object(W.jsx)("b",{children:i}),Object(W.jsx)("br",{}),Object(W.jsx)("i",{children:s}),u?Object(W.jsx)("div",{children:Object(W.jsx)("pre",{children:r})}):Object(W.jsx)("div",{children:p.map((function(e){return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("p",{style:{marginBottom:0,fontWeight:"bold",textTransform:"capitalize"},children:Object(W.jsx)("i",{children:e.key})}),Object(W.jsx)("p",{style:{marginTop:0,whiteSpace:"pre-wrap"},children:e.value})]})}))})]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:function(){return b(!u)},color:"primary",autoFocus:!0,children:u?"Summery View":"Detailed View"}),Object(W.jsx)(z.a,{onClick:j,color:"primary",autoFocus:!0,children:"Close"})]})]})})}var al,rl,il,sl,cl,ol,ll,dl,ul,bl,jl,pl,ml,Ol,hl,gl=function(e){var t=e.setWhere,n=Object(a.useState)({search:"",dateFrom:null,dateTo:null}),r=Object(d.a)(n,2),i=r[0],s=r[1];Object(a.useEffect)((function(){var e,n,a={};i.search||i.dateFrom||i.dateTo?(i.search&&(a._or=[{meta:{_contains:{reason:i.search}}},{meta:{_contains:{username:i.search}}},{meta:{_contains:{entity_id:i.search}}},{meta:{_contains:{by_username:i.search}}},{meta:{_contains:{to_connection_name:i.search}}},{meta:{_contains:{user_ip_address:i.search}}},{service:{_ilike:"%"+i.search+"%"}},{type:{_ilike:"%"+i.search+"%"}}]),i.dateTo&&(a.created_at=Object(l.a)(Object(l.a)({},null!==(e=a.created_at)&&void 0!==e?e:{}),{},{_lte:i.dateTo})),i.dateFrom&&(a.created_at=Object(l.a)(Object(l.a)({},null!==(n=a.created_at)&&void 0!==n?n:{}),{},{_gte:i.dateFrom})),t(a)):t(null)}),[i]);return Object(W.jsx)("div",{children:Object(W.jsxs)(P.a,{container:!0,spacing:1,style:{margin:"1%",width:"98%"},children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsx)(je.a,{label:"Search",variant:"outlined",fullWidth:!0,margin:"normal",value:i.search,onChange:function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{search:null===e||void 0===e?void 0:e.target.value})}))}})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(kn,{onChange:function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{dateFrom:(null===e||void 0===e?void 0:e.startOf("day"))||null})}))},label:"From date",value:i.dateFrom})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsx)(kn,{onChange:function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{dateTo:(null===e||void 0===e?void 0:e.endOf("day"))||null})}))},label:"To date",value:i.dateTo})})]})})},xl=["defaultWhere"],fl=Object(x.a)((function(e){return{root:{width:"100%"}}})),vl=Object(Z.b)(al||(al=Object(p.a)(["\nquery ($where: logs_bool_exp) {\n  logs(\n    order_by: {created_at: desc}, \n    where: $where\n  ) {\n    id\n    meta\n    service\n    type\n    created_at\n  }\n}\n"]))),_l=[{id:"view",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Date and time"},{id:"type",numeric:!1,disablePadding:!1,label:"Type"},{id:"group_name",numeric:!1,disablePadding:!1,label:"Information",notSortable:!0},{id:"username",numeric:!1,disablePadding:!1,label:"Username",notSortable:!0},{id:"user_ip_address",numeric:!1,disablePadding:!1,label:"User IP",notSortable:!0}],yl=function(e){var t=e.defaultWhere,n=Object(el.a)(e,xl),r=fl(),i=Object(a.useState)({where:t}),s=Object(d.a)(i,2),c=s[0],o=s[1],u=Object(ee.a)(vl,{variables:c||{where:t}}),p=u.loading,m=u.data,O=u.refetch,h=Object(a.useState)(!1),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)(null),_=Object(d.a)(v,2),y=_[0],S=_[1],C=Object(a.useState)([]),T=Object(d.a)(C,2),N=T[0],P=T[1],D=Object(a.useState)(!1),I=Object(d.a)(D,2),$=I[0],A=I[1],F=Object(a.useState)(""),U=Object(d.a)(F,2),M=U[0],L=U[1],E=Object(a.useState)(""),q=Object(d.a)(E,2),R=q[0],B=q[1],z=Object(a.useState)(""),G=Object(d.a)(z,2),K=G[0],H=G[1];Object(a.useEffect)((function(){y?V(y):Y()}),[y]),Object(a.useEffect)((function(){P((null===m||void 0===m?void 0:m.logs)||[])}),[m]);var V=function(e){t||o({where:e})},Y=function(){t||o({})},Q=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L(JSON.stringify(t.meta,null,2)),H(t.type),B(ae(t.created_at)),A(!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:r.root,children:[Object(W.jsx)(Ct,Object(l.a)({rowsSelectable:!1,rowsAddable:!1,tableTitle:"System Logs",rows:N,showProgress:p,headCells:_l,rowCells:function(e){var t,n,a,r,i,s,c=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50,paddingRight:0},children:Object(W.jsx)(k.a,{title:"Details",children:Object(W.jsx)(w.a,{onClick:function(e){return Q(c)},color:"primary","aria-label":"view",children:Object(W.jsx)(Me.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:ae(c.created_at)}),Object(W.jsx)(Ve.a,{children:c.type}),Object(W.jsx)(Ve.a,{children:(null===(t=c.meta)||void 0===t?void 0:t.reason)||(null===(n=c.meta)||void 0===n?void 0:n.connection_group_name)||(null===(a=c.meta)||void 0===a?void 0:a.user_group_name)||""}),Object(W.jsx)(Ve.a,{children:(null===(r=c.meta)||void 0===r?void 0:r.username)||(null===(i=c.meta)||void 0===i?void 0:i.by_username)}),Object(W.jsx)(Ve.a,{children:null===(s=c.meta)||void 0===s?void 0:s.user_ip_address})]})},onClickRefresh:function(){O()},onClickFilter:function(){f((function(e){return!e}))},showFilterPanel:x,toolbarIcon:Object(W.jsx)(Me.a,{style:{margin:"-4px 8px"}}),customFilter:gl,customFilterProps:{setWhere:S}},n)),Object(W.jsx)(nl,{isOpen:$,closeMe:function(){A(!1)},contentText:M,contentDatetime:R,contentDescription:K})]})},wl=Object(x.a)((function(e){return{root:{width:"100%"}}})),kl=function(){var e=wl();return Object(W.jsx)("div",{className:e.root,children:Object(W.jsx)(yl,{})})},Sl=n(689),Cl=n(375),Tl=n.n(Cl),Nl=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px"}}})),Pl=Object(Z.b)(rl||(rl=Object(p.a)(["\nquery ($id: uuid!) {\n  users_by_pk(id: $id){\n    id\n    username\n    password\n    name\n    role\n    meta\n    user_group_users {\n        user_group_id,\n        user_group{\n            name\n        }\n    }\n  }\n}\n"]))),Dl=function(e){var t=e.insertMode,n=void 0!==t&&t,r=(e.loggedInUser,Nl()),i=Object(a.useState)(!1),s=Object(d.a)(i,2),c=s[0],o=s[1],l=Object(a.useState)(""),u=Object(d.a)(l,2),b=u[0],j=u[1],p=Object(a.useState)(""),m=Object(d.a)(p,2),O=m[0],h=m[1],g=Object(a.useState)(""),x=Object(d.a)(g,2),f=x[0],v=x[1],_=Object(a.useState)(""),y=Object(d.a)(_,2),w=y[0],k=y[1],S=Object(a.useState)(""),C=Object(d.a)(S,2),T=C[0],N=C[1],D=Object(a.useState)(""),I=Object(d.a)(D,2),$=I[0],A=I[1],F=Object(a.useState)([]),U=Object(d.a)(F,2),M=U[0],L=U[1],E=Object(a.useState)(""),q=Object(d.a)(E,2),R=q[0],B=q[1],z=Object(a.useState)([]),G=Object(d.a)(z,2),K=(G[0],G[1]),H=Object(Oe.i)().id,V=Object(ln.a)(Pl,{variables:{id:H}}),Y=Object(d.a)(V,2),Q=Y[0],J=Y[1].data;Object(a.useEffect)((function(){n||Q()}),[]),Object(a.useEffect)((function(){if(J){var e=J.users_by_pk;j(e.name),v(e.role),h(e.username),k(e.meta.authType),N(e.meta.expiresAt),A(e.meta.isDisabled),L(e.user_group_users),B(e.meta.mustChangePassword);var t=e.user_group_users.map((function(e){return e.user_group_id}));K(t),o(!1)}else!n&&o(!0)}),[J]);var Z={meta:{_contains:{entity_id:H}}};return Object(W.jsxs)("div",{className:r.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)(be,{toolbarTitle:"User Details",backLinkUrl:"/dashboard/users",inProgress:c}),Object(W.jsx)("div",{className:r.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)("h3",{children:"Username: "}),Object(W.jsx)("span",{children:O})]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)("h3",{children:"Name: "}),Object(W.jsx)("span",{children:b})]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{style:{textTransform:"capitalize"},className:r.paper,children:[Object(W.jsx)("h3",{children:"Role: "}),Object(W.jsx)(Sl.a,{label:f,color:"primary"})]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{style:{textTransform:"capitalize"},className:r.paper,children:[Object(W.jsx)("h3",{children:"Authentication Type: "}),Object(W.jsx)("span",{children:"internal"===w?Object(W.jsx)(Sl.a,{icon:Object(W.jsx)(It.a,{fontSize:"small"}),label:"internal",color:"primary"}):Object(W.jsx)(Sl.a,{icon:Object(W.jsx)(At.a,{fontSize:"small"}),label:"external",color:"primary"})})]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)("h3",{children:"Expires at: "}),Object(W.jsx)("span",{children:T&&ae(T)}),Object(W.jsx)("span",{children:!T&&"Not Existed"})]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)("h3",{children:"Disabled: "}),Object(W.jsx)("span",{children:$?Object(W.jsx)(Sl.a,{icon:Object(W.jsx)(Tl.a,{fontSize:"small"}),label:"Yes",color:"primary"}):Object(W.jsx)(Sl.a,{icon:Object(W.jsx)(wn.a,{fontSize:"small"}),label:"No",color:"primary"})})]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)("h3",{children:"Must Change Password: "}),Object(W.jsx)("span",{children:R?Object(W.jsx)(Sl.a,{icon:Object(W.jsx)(Tl.a,{fontSize:"small"}),label:"Yes",color:"primary"}):Object(W.jsx)(Sl.a,{icon:Object(W.jsx)(wn.a,{fontSize:"small"}),label:"No",color:"primary"})})]})}),Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)("h3",{children:"User Groups: "}),M.map((function(e){return Object(W.jsx)(Sl.a,{style:{marginLeft:"5px"},label:e.user_group.name,color:"primary"})}))]})})]})})]}),Object(W.jsx)(yl,{tableTitle:"User Logs",defaultWhere:Z,rowsFilterable:!1})]})},Il=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px",height:"100%"}}})),$l=Object(Z.b)(il||(il=Object(p.a)(["\nquery ($id: uuid!) {\n  users_by_pk(id: $id) {\n    user_group_users {\n      user_group {\n        name\n        access_rule_user_groups {\n          access_rule {\n            id\n            name\n            meta\n            access_rule_connection_groups_aggregate {\n              aggregate {\n                count\n              }\n            }\n            access_rule_connections_aggregate {\n              aggregate {\n                count\n              }\n            }\n            access_rule_user_groups_aggregate {\n              aggregate {\n                count\n              }\n            }\n            access_rule_users_aggregate {\n              aggregate {\n                count\n              }\n            }\n          }\n        }\n      }\n    }\n    access_rule_users {\n      access_rule {\n        id\n        name\n        meta\n        access_rule_connection_groups_aggregate {\n          aggregate {\n            count\n          }\n        }\n        access_rule_connections_aggregate {\n          aggregate {\n            count\n          }\n        }\n        access_rule_user_groups_aggregate {\n          aggregate {\n            count\n          }\n        }\n        access_rule_users_aggregate {\n          aggregate {\n            count\n          }\n        }\n\n      }\n    }\n  }\n}\n"]))),Al=function(e){var t=e.insertMode,n=void 0!==t&&t,r=(e.loggedInUser,Il()),i=Object(a.useState)(!1),s=Object(d.a)(i,2),c=s[0],o=s[1],l=Object(a.useState)([]),u=Object(d.a)(l,2),b=(u[0],u[1],Object(Oe.i)().id),j=Object(ee.a)($l,{variables:{id:b},notifyOnNetworkStatusChange:!0}),p=j.loading,m=(j.error,j.data),O=j.refetch,h=Object(a.useState)([]),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)([]),_=Object(d.a)(v,2),y=_[0],S=_[1],C=[{id:"edit",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"users",numeric:!1,disablePadding:!1,label:"Users (Groups)"},{id:"connections",numeric:!1,disablePadding:!1,label:"Connections (Groups)"},{id:"upload",numeric:!1,disablePadding:!1,label:"Upload"},{id:"download",numeric:!1,disablePadding:!1,label:"Download"},{id:"clipboard",numeric:!1,disablePadding:!1,label:"Clipboard"}];Object(a.useEffect)((function(){var e,t,n=null!==(e=null===m||void 0===m||null===(t=m.users_by_pk)||void 0===t?void 0:t.access_rule_users)&&void 0!==e?e:[];f(n.map((function(e){return{id:e.access_rule.id,name:e.access_rule.name,users:"".concat(e.access_rule.access_rule_users_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_user_groups_aggregate.aggregate.count,")"),connections:"".concat(e.access_rule.access_rule_connections_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_connection_groups_aggregate.aggregate.count,")"),upload:e.access_rule.meta.canUpload?"\u2713":"",download:e.access_rule.meta.canDownload?"\u2713":"",clipboard:e.access_rule.meta.canCopy||e.access_rule.meta.canPaste?"\u2713":""}})))}),[m]),Object(a.useEffect)((function(){var e,t,n=null!==(e=null===m||void 0===m||null===(t=m.users_by_pk)||void 0===t?void 0:t.user_group_users)&&void 0!==e?e:[];S(n.map((function(e){return{name:e.user_group.name,access_rules:e.user_group.access_rule_user_groups.map((function(e){return{id:e.access_rule.id,name:e.access_rule.name,users:"".concat(e.access_rule.access_rule_users_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_user_groups_aggregate.aggregate.count,")"),connections:"".concat(e.access_rule.access_rule_connections_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_connection_groups_aggregate.aggregate.count,")"),upload:e.access_rule.meta.canUpload?"\u2713":"",download:e.access_rule.meta.canDownload?"\u2713":"",clipboard:e.access_rule.meta.canCopy||e.access_rule.meta.canPaste?"\u2713":""}}))}})))}),[m]);var T=function(){O()},N=function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Edit",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void D.push({pathname:"/dashboard/access-rules/"+n,state:{backUrl:"/dashboard/users/".concat(b,"/access-rules")}});var n},color:"primary","aria-label":"edit",children:Object(W.jsx)(Qe.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.users}),Object(W.jsx)(Ve.a,{children:t.connections}),Object(W.jsx)(Ve.a,{children:t.upload}),Object(W.jsx)(Ve.a,{children:t.download}),Object(W.jsx)(Ve.a,{children:t.clipboard})]})};Object(a.useEffect)((function(){m?o(!1):!n&&o(!0)}),[m]);var D=Object(Oe.g)();return Object(W.jsx)("div",{className:r.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)(be,{toolbarTitle:"User Access Rules",backLinkUrl:"/dashboard/users",inProgress:c,toolbarIcon:Object(W.jsx)(V.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)("div",{className:r.root,style:{padding:"20px"},children:Object(W.jsx)(P.a,{container:!0,spacing:3,children:Object(W.jsx)(Ct,{tableTitle:"Direct Access Rules",rows:null!==x&&void 0!==x?x:[],showProgress:p,headCells:C,rowCells:N,rowsSelectable:!1,rowsAddable:!1,rowsFilterable:!1,onClickRefresh:T})})}),y.map((function(e){var t;return Object(W.jsx)("div",{className:r.root,style:{padding:"20px"},children:Object(W.jsx)(P.a,{container:!0,spacing:3,children:Object(W.jsx)(Ct,{tableTitle:"User Group Access Rules: "+e.name,rows:null!==(t=null===e||void 0===e?void 0:e.access_rules)&&void 0!==t?t:[],showProgress:p,headCells:C,rowCells:N,rowsSelectable:!1,rowsAddable:!1,rowsFilterable:!1,onClickRefresh:T})})})}))]})})},Fl=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px",height:"100%"}}})),Ul=Object(Z.b)(sl||(sl=Object(p.a)(["\nquery ($id: uuid!) {\n  connections_by_pk(id: $id) {\n    connection_group_connections {\n      connection_group {\n        name\n        access_rule_connection_groups {\n          access_rule {\n            id\n            name\n            meta\n            access_rule_user_groups_aggregate {\n              aggregate {\n                count\n              }\n            }\n            access_rule_users_aggregate {\n              aggregate {\n                count\n              }\n            }\n            access_rule_connection_groups_aggregate {\n              aggregate {\n                count\n              }\n            }\n            access_rule_connections_aggregate {\n              aggregate {\n                count\n              }\n            }\n          }\n        }\n      }\n    }\n    access_rule_connections {\n      access_rule {\n        id\n        name\n        meta\n        access_rule_user_groups_aggregate {\n          aggregate {\n            count\n          }\n        }\n        access_rule_users_aggregate {\n          aggregate {\n            count\n          }\n        }\n        access_rule_connection_groups_aggregate {\n          aggregate {\n            count\n          }\n        }\n        access_rule_connections_aggregate {\n          aggregate {\n            count\n          }\n        }\n      }\n    }\n  }\n}\n"]))),Ml=function(e){var t=e.insertMode,n=void 0!==t&&t,r=(e.loggedInUser,Fl()),i=Object(a.useState)(!1),s=Object(d.a)(i,2),c=s[0],o=s[1],l=Object(a.useState)([]),u=Object(d.a)(l,2),b=(u[0],u[1],Object(Oe.i)().id),j=Object(ee.a)(Ul,{variables:{id:b},notifyOnNetworkStatusChange:!0}),p=j.loading,m=(j.error,j.data),O=j.refetch,h=Object(a.useState)([]),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)([]),_=Object(d.a)(v,2),y=_[0],S=_[1],C=[{id:"edit",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"name",numeric:!1,disablePadding:!1,label:"Name"},{id:"users",numeric:!1,disablePadding:!1,label:"Users (Groups)"},{id:"connections",numeric:!1,disablePadding:!1,label:"Connections (Groups)"},{id:"upload",numeric:!1,disablePadding:!1,label:"Upload"},{id:"download",numeric:!1,disablePadding:!1,label:"Download"},{id:"clipboard",numeric:!1,disablePadding:!1,label:"Clipboard"}];Object(a.useEffect)((function(){var e,t,n=null!==(e=null===m||void 0===m||null===(t=m.connections_by_pk)||void 0===t?void 0:t.access_rule_connections)&&void 0!==e?e:[];f(n.map((function(e){return{id:e.access_rule.id,name:e.access_rule.name,users:"".concat(e.access_rule.access_rule_users_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_user_groups_aggregate.aggregate.count,")"),connections:"".concat(e.access_rule.access_rule_connections_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_connection_groups_aggregate.aggregate.count,")"),upload:e.access_rule.meta.canUpload?"\u2713":"",download:e.access_rule.meta.canDownload?"\u2713":"",clipboard:e.access_rule.meta.canCopy||e.access_rule.meta.canPaste?"\u2713":""}})))}),[m]),Object(a.useEffect)((function(){var e,t,n=null!==(e=null===m||void 0===m||null===(t=m.connections_by_pk)||void 0===t?void 0:t.connection_group_connections)&&void 0!==e?e:[];S(n.map((function(e){return{name:e.connection_group.name,access_rules:e.connection_group.access_rule_connection_groups.map((function(e){return{id:e.access_rule.id,name:e.access_rule.name,users:"".concat(e.access_rule.access_rule_users_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_user_groups_aggregate.aggregate.count,")"),connections:"".concat(e.access_rule.access_rule_connections_aggregate.aggregate.count," (").concat(e.access_rule.access_rule_connection_groups_aggregate.aggregate.count,")"),upload:e.access_rule.meta.canUpload?"\u2713":"",download:e.access_rule.meta.canDownload?"\u2713":"",clipboard:e.access_rule.meta.canCopy||e.access_rule.meta.canPaste?"\u2713":""}}))}})))}),[m]);var T=function(){O()},N=function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Edit",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void D.push({pathname:"/dashboard/access-rules/"+n,state:{backUrl:"/dashboard/connections/".concat(b,"/access-rules")}});var n},color:"primary","aria-label":"edit",children:Object(W.jsx)(Qe.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.name}),Object(W.jsx)(Ve.a,{children:t.users}),Object(W.jsx)(Ve.a,{children:t.connections}),Object(W.jsx)(Ve.a,{children:t.upload}),Object(W.jsx)(Ve.a,{children:t.download}),Object(W.jsx)(Ve.a,{children:t.clipboard})]})};Object(a.useEffect)((function(){m?o(!1):!n&&o(!0)}),[m]);var D=Object(Oe.g)();return Object(W.jsx)("div",{className:r.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:r.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Connection Access Rules",backLinkUrl:"/dashboard/connections",inProgress:c,toolbarIcon:Object(W.jsx)(V.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)("div",{className:r.root,style:{padding:"20px"},children:Object(W.jsx)(P.a,{container:!0,spacing:3,children:Object(W.jsx)(Ct,{tableTitle:"Direct Access Rules",rows:null!==x&&void 0!==x?x:[],showProgress:p,headCells:C,rowCells:N,rowsSelectable:!1,rowsAddable:!1,rowsFilterable:!1,onClickRefresh:T})})}),y.map((function(e){var t;return Object(W.jsx)("div",{className:r.root,style:{padding:"20px"},children:Object(W.jsx)(P.a,{container:!0,spacing:3,children:Object(W.jsx)(Ct,{tableTitle:"Connection Group Access Rules: "+e.name,rows:null!==(t=e.access_rules)&&void 0!==t?t:[],showProgress:p,headCells:C,rowCells:N,rowsSelectable:!1,rowsAddable:!1,rowsFilterable:!1,onClickRefresh:T})})})}))]})})},Ll=Object(x.a)((function(e){return{root:{width:"100%"}}})),El=Object(Z.b)(cl||(cl=Object(p.a)(["\nquery ($filter: SessionsSearchFilter!) {\n  action_sess_sessions_search(filter: $filter) {\n    id\n    session {\n        id\n        meta\n        status\n        created_at\n        access_rule {\n          name\n        }\n        connection {\n          name\n        }\n        user {\n          username\n        }\n    }\n  }\n}\n"]))),ql=(Object(Z.b)(ol||(ol=Object(p.a)(["\nmutation ($sessionId: uuid!, $task: String!) {\n  action_mgmt_encoder(sessionId: $sessionId, task: $task) {\n    meta\n  }\n}\n"]))),Object(Z.b)(ll||(ll=Object(p.a)(["\nquery ($filter: SessionsSearchFilter!) {\n  action_sess_sessions_search(filter: $filter) {\n    id\n    session {\n        id\n        meta\n        status\n        created_at\n        access_rule {\n          name\n        }\n        connection {\n          name\n        }\n        user {\n          username\n        }\n    }\n  }\n}\n"])))),Rl=[{id:"play",numeric:!1,disablePadding:!0,label:""},{id:"username",numeric:!1,disablePadding:!1,label:"Username"},{id:"connection",numeric:!1,disablePadding:!1,label:"Connection"},{id:"access_rule",numeric:!1,disablePadding:!1,label:"Access Rule"},{id:"status",numeric:!1,disablePadding:!1,label:"Status"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Started - Closed At"}],Bl=function(){var e=Ll(),t=Object(a.useState)(El),n=Object(d.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)(!1),c=Object(d.a)(s,2),u=c[0],b=c[1],j=Object(a.useState)({}),p=Object(d.a)(j,2),m=p[0],O=p[1],h=Object(ee.a)(r,{variables:m,notifyOnNetworkStatusChange:!0}),g=h.loading,x=(h.error,h.data),f=h.refetch,v=Object(a.useState)({text:"",dateFrom:null,dateTo:null}),_=Object(d.a)(v,2),y=_[0],S=_[1],C=Object(a.useState)([]),T=Object(d.a)(C,2),N=T[0],D=T[1];Object(a.useEffect)((function(){I()}),[u]),Object(a.useEffect)((function(){var e,t=(null!==(e=null===x||void 0===x?void 0:x.action_sess_sessions_search)&&void 0!==e?e:[]).map((function(e){return null===e||void 0===e?void 0:e.session})).filter((function(e){return!!e}));D(t)}),[x]),Object(a.useEffect)((function(){$({text:y.text})}),[y]),Object(a.useEffect)((function(){f()}),[]);var I=function(e){S((function(t){return Object(l.a)(Object(l.a)({},t),{},{text:null===e||void 0===e?void 0:e.target.value})}))},$=function(e){i(ql),O({filter:e})};return Object(W.jsx)("div",{className:e.root,children:Object(W.jsx)(Ct,{rowsSelectable:!1,rowsAddable:!1,tableTitle:"Sessions Search",extraToolbar:function(){return Object(W.jsx)(k.a,{title:"Sessions History",children:Object(W.jsx)(w.a,{component:o.b,to:"sessions-history",children:Object(W.jsx)(Ae.a,{})})})},rowsFilterable:!1,rows:null!==N&&void 0!==N?N:[],showProgress:g,headCells:Rl,rowCells:function(e){var t=e.row;return Object(W.jsx)(ai,{row:t})},onClickRefresh:function(){f()},onClickFilter:function(){b((function(e){return!e}))},showFilterPanel:!0,onChangeFilterText:I,toolbarIcon:Object(W.jsx)(Ar.a,{style:{margin:"-4px 8px"}}),customFilter:function(){return Object(W.jsx)("div",{children:Object(W.jsx)(P.a,{container:!0,spacing:1,style:{margin:"1%",width:"98%"},children:Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(je.a,{label:"Search keystrokes",variant:"outlined",autoFocus:!0,fullWidth:!0,margin:"normal",value:y.text,onChange:I})})})})}})})},Wl=Object(Z.b)(dl||(dl=Object(p.a)(["\nquery ACTION_AUTH_STATUS {\n    action_auth_status {\n        id\n        role\n        username\n        meta\n    }\n}\n"]))),zl=function(e){var t=e.lastWindowActivityAt,n=e.doLogout,r=Object(Oe.h)(),i=Object(a.useRef)();Object(a.useEffect)((function(){return re(window,(function(){t.current=new Date})),i.current=setInterval(s,1e4),function(){clearInterval(i.current)}}),[]);var s=function(){var e=Object(j.a)(b.a.mark((function e(){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(a=new Date-t.current,e.prev=3,!(a<1e4)){e.next=10;break}return e.next=7,o();case 7:n=e.sent,e.next=13;break;case 10:return e.next=12,l();case 12:n=e.sent;case 13:d(n),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),console.log("beat error:",e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(){return e.apply(this,arguments)}}(),c=Object(dn.a)(),o=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.query({query:Wl});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.query({query:Wl,context:{headers:{"x-app-no-activity":"1"}}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(e){var t,a;(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(a=t.action_auth_status)||void 0===a?void 0:a.id)||r.pathname.startsWith("/sign-in")||n()};return Object(W.jsx)(W.Fragment,{})},Gl=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a,r,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({variables:{sessionId:n,task:"keystrokes"}});case 2:if(s=e.sent,"started"!==(null===s||void 0===s||null===(a=s.data)||void 0===a||null===(r=a.action_mgmt_encoder)||void 0===r||null===(i=r.meta)||void 0===i?void 0:i.status)){e.next=6;break}return e.abrupt("return",{success:!0});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Kl=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a,r,i,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===n||void 0===n||null===(a=n.meta)||void 0===a?void 0:a.transparentMode)){e.next=6;break}return e.next=3,t({variables:{sessionId:null===n||void 0===n?void 0:n.id,task:"transparentVideo"}});case 3:e.sent,e.next=12;break;case 6:return e.next=8,t({variables:{sessionId:null===n||void 0===n?void 0:n.id,task:"video"}});case 8:if(c=e.sent,"started"!==(null===c||void 0===c||null===(r=c.data)||void 0===r||null===(i=r.action_mgmt_encoder)||void 0===i||null===(s=i.meta)||void 0===s?void 0:s.status)){e.next=12;break}return e.abrupt("return",{success:!0});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Hl=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a,r,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({variables:{sessionId:n,task:"ocr"}});case 2:if(s=e.sent,"started"!==(null===s||void 0===s||null===(a=s.data)||void 0===a||null===(r=a.action_mgmt_encoder)||void 0===r||null===(i=r.meta)||void 0===i?void 0:i.status)){e.next=6;break}return e.abrupt("return",{success:!0});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Vl=n(229),Yl=n.n(Vl),Ql=n(664),Jl=n(665),Xl=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)},"& h3":{margin:"3px 0",fontStyle:"italic"}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px"}}})),Zl=Object(Z.b)(ul||(ul=Object(p.a)(["\nquery ($id: uuid!) {\n  sessions_by_pk(id: $id){\n    id\n    meta\n    status\n    created_at\n    access_rule {\n      name\n    }\n    connection {\n      name\n    }\n    user {\n      username\n    }  \n  }\n}\n"]))),ed=Object(Z.b)(bl||(bl=Object(p.a)(["\nmutation ($sessionId: uuid!, $task: String!) {\n  action_mgmt_encoder(sessionId: $sessionId, task: $task) {\n    meta\n  }\n}\n"]))),td=function(e){var t,n,r,i,s,c,o,l,u,p=e.licenseInfo,m=Object(Oe.i)().id,O=Xl(),h=Object(a.useState)(!1),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)({}),_=Object(d.a)(v,2),y=_[0],S=_[1],C=Object(a.useState)({}),T=Object(d.a)(C,2),N=T[0],D=T[1],I=Object(Oe.g)(),$=Object(a.useState)({}),A=Object(d.a)($,2),F=A[0],U=A[1],M=Object(a.useState)({}),L=Object(d.a)(M,2),E=L[0],q=L[1],R=Object(a.useState)(!0),B=Object(d.a)(R,2),G=B[0],K=B[1],H=Object(a.useState)({}),V=Object(d.a)(H,2),Y=V[0],Q=V[1],J=Object(a.useState)({}),Z=Object(d.a)(J,2),te=Z[0],ne=Z[1],re=Object(a.useState)(!0),se=Object(d.a)(re,2),ce=se[0],oe=se[1],le=null===p||void 0===p||null===(t=p.action_mgmt_license_info)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.features,de=null===le||void 0===le?void 0:le.includes("ocr"),ue=Object(a.useState)({}),je=Object(d.a)(ue,2),pe=je[0],me=je[1],he=Object(a.useState)({}),ge=Object(d.a)(he,2),xe=ge[0],fe=ge[1],ve=Object(a.useState)(!0),_e=Object(d.a)(ve,2),ye=_e[0],we=_e[1],ke=Object(a.useRef)(),Se=Object(ee.a)(Zl,{variables:{id:m}}),Ce=Se.data,Te=Se.refetch,Ne=Object(Je.a)(ed),Pe=Object(d.a)(Ne,1)[0];Object(a.useEffect)((function(){if(null===Ce||void 0===Ce?void 0:Ce.sessions_by_pk){var e,t=Ce.sessions_by_pk;(null===t||void 0===t||null===(e=t.meta)||void 0===e?void 0:e.transparentMode)&&I.push("/dashboard/sessions-history/".concat(m,"/view-transparent")),S(t),f(!1)}else f(!0)}),[Ce]),Object(a.useEffect)((function(){return De(),ke.current=setInterval(Ge,5e3),function(){clearInterval(ke.current)}}),[]);var De=function(){Ie(),$e(),Ae(),Fe(),Ue(),Me(),Le()},Ie=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(m,"recording");case 2:t=e.sent,D(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(m,"keystrokes");case 2:t=e.sent,Q(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(m,"video");case 2:t=e.sent,U(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(m,"video-part");case 2:t=e.sent,q(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(m,"keystrokes-part");case 2:t=e.sent,ne(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(m,"ocr");case 2:t=e.sent,me(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Le=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(m,"ocr-part");case 2:t=e.sent,fe(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a,r,i,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/control-service/rec/recording"+"?sessionId=".concat(t,"&format=").concat(n),i={},(s=window.localStorage.getItem("AuthToken"))&&(i.authorization="Bearer ".concat(s)),e.next=6,fetch(r,{method:"head",headers:i});case 6:return c=e.sent,e.abrupt("return",{available:200===c.status||304===c.status,size:200===c.status||304===c.status?null===c||void 0===c||null===(a=c.headers)||void 0===a?void 0:a.get("Content-Length"):void 0,url:r});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qe=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="/control-service/rec/recording"+"?sessionId=".concat(t,"&format=recording"),a="/playback-service?s="+btoa(n),window.open(a,"_blank");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Re=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe(!1),e.next=3,Gl(Pe,m);case 3:t=e.sent,console.log(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to start rendering this session?")){e.next=6;break}return K(!1),e.next=4,Kl(Pe,m);case 4:t=e.sent,console.log(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),We=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="/control-service/rec/recording"+"?sessionId=".concat(m,"&format=keystrokes"),window.open(t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ze=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="/control-service/rec/recording"+"?sessionId=".concat(m,"&format=video"),window.open(t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ge=function(){Te(),De()},Ke=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to start OCR on this session?")){e.next=6;break}return we(!1),e.next=4,Hl(Pe,m);case 4:t=e.sent,console.log(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="/control-service/rec/recording"+"?sessionId=".concat(m,"&format=ocr"),window.open(t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ve="";(null===F||void 0===F?void 0:F.available)&&(Ve="Available"),(null===F||void 0===F?void 0:F.available)||(Ve="Not Available"),(null===E||void 0===E?void 0:E.available)&&(Ve="In-Progress");var Ye="";(null===Y||void 0===Y?void 0:Y.available)&&(Ye="Available"),(null===Y||void 0===Y?void 0:Y.available)||(Ye="Not Available"),(null===te||void 0===te?void 0:te.available)&&(Ye="In-Progress");var Qe="";return(null===pe||void 0===pe?void 0:pe.available)&&(Qe="Available"),(null===pe||void 0===pe?void 0:pe.available)||(Qe="Not Available"),(null===xe||void 0===xe?void 0:xe.available)&&(Qe="In-Progress"),Object(W.jsx)("div",{className:O.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Session Details",backLinkUrl:"/dashboard/sessions-history",inProgress:x,extraIcons:function(){return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(k.a,{title:"Refresh",children:Object(W.jsx)(w.a,{"aria-label":"refresh",onClick:Ge,children:Object(W.jsx)(Ot.a,{})})})})}}),Object(W.jsx)("div",{className:O.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Username"}),Object(W.jsx)("span",{children:null===y||void 0===y||null===(r=y.user)||void 0===r?void 0:r.username})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Connection Name"}),Object(W.jsx)("span",{children:null===y||void 0===y||null===(i=y.connection)||void 0===i?void 0:i.name})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Access Rule Name"}),Object(W.jsx)("span",{children:null===y||void 0===y||null===(s=y.access_rule)||void 0===s?void 0:s.name})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Session Status"}),Object(W.jsx)("span",{children:null===y||void 0===y?void 0:y.status})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Session Started at"}),Object(W.jsx)("span",{children:(null===y||void 0===y||null===(c=y.meta)||void 0===c?void 0:c.liveAt)?ae(null===y||void 0===y||null===(o=y.meta)||void 0===o?void 0:o.liveAt):ae(null===y||void 0===y?void 0:y.created_at)})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Session Closed at"}),Object(W.jsx)("span",{children:(null===y||void 0===y||null===(l=y.meta)||void 0===l?void 0:l.closedAt)?ae(null===y||void 0===y||null===(u=y.meta)||void 0===u?void 0:u.closedAt):"N/A"})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Session Unique ID"}),Object(W.jsx)("span",{children:null===y||void 0===y?void 0:y.id})]})})]})}),Object(W.jsx)("h4",{children:"Recording Details"}),Object(W.jsx)("div",{className:O.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Recording Status"}),Object(W.jsx)("span",{children:(null===N||void 0===N?void 0:N.available)?"Available":"Not Available"})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Recording Size"}),Object(W.jsx)("span",{children:(null===N||void 0===N?void 0:N.size)?ie((null===N||void 0===N?void 0:N.size)/1024):"N/A"})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Recording Playback"}),Object(W.jsx)("span",{children:Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Mr.a,{}),onClick:function(){return qe(m)},children:"Playback"})})]})})]})}),Object(W.jsx)("h4",{children:"Video Details"}),Object(W.jsx)("div",{className:O.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Video Status"}),Object(W.jsx)("span",{children:Ve})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Video Size"}),Object(W.jsxs)("span",{children:[(null===F||void 0===F?void 0:F.size)?ie(F.size/1024):"N/A",(null===E||void 0===E?void 0:E.size)?" (Part: "+ie(E.size/1024)+")":""]})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Download Video"}),Object(W.jsxs)("span",{children:[Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Yl.a,{}),onClick:Be,disabled:!G,children:"Render Video"}),"\xa0 \xa0 \xa0",Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Yl.a,{}),onClick:ze,disabled:!(null===F||void 0===F?void 0:F.available),children:"Download Video"})]})]})})]})}),Object(W.jsx)("h4",{children:"Keystrokes Details"}),Object(W.jsx)("div",{className:O.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Keystrokes Status"}),Object(W.jsx)("span",{children:Ye})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Keystrokes Size"}),Object(W.jsxs)("span",{children:[(null===Y||void 0===Y?void 0:Y.size)?ie(Y.size/1024):"N/A",(null===te||void 0===te?void 0:te.size)?" (Part: "+ie(te.size/1024)+")":""]})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Download Keystrokes"}),Object(W.jsxs)("span",{children:[Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Ql.a,{}),onClick:Re,disabled:!ce,children:"Extract Keystrokes"}),"\xa0 \xa0 \xa0",Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Ql.a,{}),onClick:We,disabled:!(null===Y||void 0===Y?void 0:Y.available),children:"Download Keystrokes"})]})]})})]})}),de&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("h4",{children:"OCR Details"}),Object(W.jsx)("div",{className:O.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"OCR Status"}),Object(W.jsx)("span",{children:Qe})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"OCR Size"}),Object(W.jsxs)("span",{children:[(null===pe||void 0===pe?void 0:pe.size)?ie(pe.size/1024):"N/A",(null===xe||void 0===xe?void 0:xe.size)?" (Part: "+ie(xe.size/1024)+")":""]})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:O.paper,children:[Object(W.jsx)("h3",{children:"Download OCR"}),Object(W.jsxs)("span",{children:[Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Jl.a,{}),onClick:Ke,disabled:!ye,children:"Extract OCR"}),"\xa0 \xa0 \xa0",Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Jl.a,{}),onClick:He,disabled:!(null===F||void 0===F?void 0:F.available),children:"Download OCR"})]})]})})]})})]})]})})},nd=n(678),ad=function(e){var t,n,a,r,i=e.licenseInfo,s=null===i||void 0===i||null===(t=i.action_mgmt_license_info)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.features,c=null===i||void 0===i||null===(a=i.action_mgmt_license_info)||void 0===a||null===(r=a.result)||void 0===r?void 0:r.challengeRemainingDays,l=Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(z.a,{color:"inherit",variant:"outlined",size:"small",component:o.b,to:"/dashboard/settings/system-license/challenge",children:"Go to challenge"})});return Object(W.jsxs)(W.Fragment,{children:[(null===s||void 0===s?void 0:s.includes("chn"))&&c<=5&&Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsxs)(nd.a,{severity:"warning",variant:"filled",action:l,children:["License challenge is required to keep system working in ",c," days. \xa0 \xa0"]})}),(null===s||void 0===s?void 0:s.includes("has"))&&Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(nd.a,{severity:"info",variant:"filled",children:"Your are using slave server (High Availability)."})})]})},rd=function(e){var t=e.row,n=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a,r,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/control-service/rec/recording"+"?sessionId=".concat(t,"&format=").concat(n),e.next=3,fetch(a,{method:"head"});case 3:if(r=e.sent,!(200===r.status||304===r.status)){e.next=7;break}return e.abrupt("return",{url:a});case 7:return e.prev=7,e.next=10,r.json();case 10:return i=e.sent,s=i.message,e.abrupt("return",{message:s});case 15:e.prev=15,e.t0=e.catch(7);case 17:return e.abrupt("return",{});case 18:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),a=function(){var e=Object(j.a)(b.a.mark((function e(t){var a,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t,"recording-play");case 2:(null===(a=e.sent)||void 0===a?void 0:a.url)?(r="/playback-service?s="+btoa(a.url),window.open(r,"_blank")):(i=(null===a||void 0===a?void 0:a.message)||"Recording not available",alert(i));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:150,paddingRight:0},children:Object(W.jsx)(k.a,{title:"Playback",children:Object(W.jsx)(w.a,{onClick:function(e){var n,r;return a(null===(n=t.name)||void 0===n||null===(r=n.split("."))||void 0===r?void 0:r[0])},color:"primary","aria-label":"view",children:Object(W.jsx)(Mr.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.name})]})},id=Object(x.a)((function(e){return{root:{width:"100%"}}})),sd=Object(Z.b)(jl||(jl=Object(p.a)(["\nquery {\n  action_rec_sessions_play {\n    name\n  }\n}\n"]))),cd=[{id:"play",numeric:!1,disablePadding:!0,label:""},{id:"name",numeric:!1,disablePadding:!1,label:"name"}],od=function(){var e=id(),t=Object(a.useState)(sd),n=Object(d.a)(t,1)[0],r=Object(ee.a)(n),i=r.loading,s=r.data,c=r.refetch,l=Object(a.useState)([]),u=Object(d.a)(l,2),b=u[0],j=u[1];Object(a.useEffect)((function(){var e,t=null!==(e=null===s||void 0===s?void 0:s.action_rec_sessions_play)&&void 0!==e?e:[];j(t)}),[s]);return Object(W.jsx)("div",{className:e.root,children:Object(W.jsx)(Ct,{rowsSelectable:!1,rowsAddable:!1,tableTitle:"Sessions Player",extraToolbar:function(){return Object(W.jsx)(k.a,{title:"Sessions History",children:Object(W.jsx)(w.a,{component:o.b,to:"sessions-history",children:Object(W.jsx)(Ae.a,{})})})},rowsFilterable:!1,rows:null!==b&&void 0!==b?b:[],showProgress:i,headCells:cd,rowCells:function(e){var t=e.row;return Object(W.jsx)(rd,{row:t})},onClickRefresh:function(){c()},showFilterPanel:!0,toolbarIcon:Object(W.jsx)(Ar.a,{style:{margin:"-4px 8px"}}),customFilter:function(){return Object(W.jsx)(W.Fragment,{})}})})},ld=Object(x.a)((function(e){return{button:{height:100,marginBottom:20},label:{flexDirection:"column"},icon:{fontSize:"32px !important",marginBottom:e.spacing.unit}}})),dd=function(e){var t=e.icon,n=e.href,a=e.label,r=ld(),i=t;return Object(W.jsx)(P.a,{item:!0,md:3,sm:6,xs:6,style:{textAlign:"center"},children:Object(W.jsxs)(z.a,{component:o.b,to:"/dashboard/network-tools/"+n,classes:{root:r.button,label:r.label},children:[Object(W.jsx)(i,{className:r.icon}),a]})})},ud=n(341),bd=n.n(ud),jd=Object(x.a)((function(e){return{paper:{width:"100%",marginBottom:e.spacing(1)}}})),pd=function(){var e=jd();return Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Network Tools",toolbarIcon:Object(W.jsx)(Ee.a,{style:{margin:"-4px 8px"}})}),Object(W.jsxs)(P.a,{container:!0,children:[Object(W.jsx)(dd,{label:"Ping",href:"ping",icon:Se.a}),Object(W.jsx)(dd,{label:"Traceroute",href:"traceroute",icon:bd.a})]})]})},md=n(224),Od=n.n(md),hd=Object(x.a)((function(e){return{paper:{width:"100%",marginBottom:e.spacing(1)},paperNetworkTools:{width:"100%",minHeight:"50vh",backgroundColor:"#E8E8E8"},root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},icon:{fontSize:"32px !important",marginBottom:e.spacing.unit},loading:{color:"gray",textAlign:"center",paddingTop:"50px"}}})),gd=Object(Z.b)(pl||(pl=Object(p.a)(["\n    mutation ( $ipNumber: String! ){\n        action_ping (ip: $ipNumber) {\n            result\n        }\n    }\n"]))),xd=function(){var e=Object(Je.a)(gd),t=Object(d.a)(e,1)[0],n=r.a.useState(!1),a=Object(d.a)(n,2),i=a[0],s=a[1],c=r.a.useState(""),o=Object(d.a)(c,2),l=o[0],u=o[1],p=r.a.useState(!1),m=Object(d.a)(p,2),O=m[0],h=m[1],g=r.a.useState({host:"",output:"",alive:"",time:""}),x=Object(d.a)(g,2),f=x[0],v=x[1],_=function(e){0==e.length&&s(!1),u(e);v({host:"",output:"",alive:"",time:""})},y=function(e){var t=e.split(".");return!(t.length<4||""==t[t.length-1])},w=function(){var e=Object(j.a)(b.a.mark((function e(){var n,a,r,i,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(l),y(l)){e.next=4;break}return s(!0),e.abrupt("return");case 4:return s(!1),h(!0),e.prev=6,e.next=9,t({variables:{ipNumber:l}});case 9:r=e.sent,i=null===r||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.action_ping)||void 0===a?void 0:a.result,c={host:null===i||void 0===i?void 0:i.host,output:null===i||void 0===i?void 0:i.output,alive:"".concat(null===i||void 0===i?void 0:i.alive),time:null===i||void 0===i?void 0:i.time},h(!1),v(c),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),console.log(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(){return e.apply(this,arguments)}}(),k=hd();return Object(W.jsx)("div",{className:k.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:k.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Ping",toolbarIcon:Object(W.jsx)(Se.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/network-tools"}),Object(W.jsx)(P.a,{container:!0,children:Object(W.jsxs)(P.a,{item:!0,md:12,sm:12,xs:6,style:{padding:"40px"},children:[Object(W.jsxs)("div",{style:{width:"100%",textAlign:"center"},children:[Object(W.jsx)(je.a,{label:"Ping example:192.168.1.1",type:"text",size:"small",fullWidth:!0,variant:"outlined",error:i,InputProps:{readOnly:!1},onChange:function(e){_(e.target.value)}}),Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:k.button,startIcon:Object(W.jsx)(Od.a,{}),style:{margin:"0 0 18px 0"},onClick:w,children:"Ping"})]}),Object(W.jsxs)(X.a,{className:k.paperNetworkTools,children:[f.host&&function(e){return Object(W.jsxs)("ul",{style:{listStyleType:"none",padding:"50px 10px",fontSize:"smaller",fontFamily:"sans-serif"},children:[Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"IP :"})," ",null===e||void 0===e?void 0:e.host]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Alive :"})," ",null===e||void 0===e?void 0:e.alive]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Output :"})," ",null===e||void 0===e?void 0:e.output]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Time :"})," ",null===e||void 0===e?void 0:e.time]})]})}(f),O&&Object(W.jsx)("h4",{className:k.loading,children:"Waiting..."})]})]})})]})})},fd=n(480),vd=n.n(fd),_d=Object(x.a)((function(e){return{paper:{width:"100%",marginBottom:e.spacing(1)},paperNetworkTools:{width:"100%",minHeight:"50vh",backgroundColor:"#E8E8E8"},root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},icon:{fontSize:"32px !important",marginBottom:e.spacing.unit},result:{listStyleType:"none",padding:"50px 10px",fontSize:"small",fontFamily:"sans-serif"},loading:{color:"gray",textAlign:"center",paddingTop:"50px"},errorMessage:{color:"gray",textAlign:"center",paddingTop:"50px"}}})),yd=Object(Z.b)(ml||(ml=Object(p.a)(["\n    mutation ( $ipNumber: String! ){\n        action_traceroute (ip: $ipNumber) {\n            hops\n        }\n    }\n"]))),wd=function(){var e=Object(Je.a)(yd),t=Object(d.a)(e,1)[0],n=r.a.useState(!1),a=Object(d.a)(n,2),i=a[0],s=a[1],c=r.a.useState(""),o=Object(d.a)(c,2),l=o[0],u=o[1],p=r.a.useState(!1),m=Object(d.a)(p,2),O=m[0],h=m[1],g=r.a.useState([]),x=Object(d.a)(g,2),f=x[0],v=x[1],_=r.a.useState(""),y=Object(d.a)(_,2),w=y[0],k=y[1],S=_d(),C=function(e){0==e.length&&s(!1),u(e),v([]),k("")},T=function(e){var t=e.split(".");if(4!=t.length||""==t[t.length-1])return!1;for(var n=0;n<t.length;n++)if(-1!==t[n].indexOf(" "))return!1;return!0},N=function(){var e=Object(j.a)(b.a.mark((function e(){var n,a,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(l),T(l)){e.next=4;break}return s(!0),e.abrupt("return");case 4:return s(!1),h(!0),e.prev=6,e.next=9,t({variables:{ipNumber:l}});case 9:r=e.sent,i=null===r||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.action_traceroute)||void 0===a?void 0:a.hops,k(""),h(!1),v(i),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(6),console.log(e.t0.message),h(!1),k(e.t0.message);case 21:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{className:S.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:S.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Traceroute",toolbarIcon:Object(W.jsx)(bd.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/network-tools"}),Object(W.jsx)(P.a,{container:!0,children:Object(W.jsxs)(P.a,{item:!0,md:12,sm:12,xs:6,style:{padding:"40px"},children:[Object(W.jsxs)("div",{style:{width:"100%",textAlign:"center"},children:[Object(W.jsx)(je.a,{label:"Traceroute example:192.168.1.1",type:"text",size:"small",fullWidth:!0,variant:"outlined",error:i,InputProps:{readOnly:!1},onChange:function(e){C(e.target.value)}}),Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:S.button,startIcon:Object(W.jsx)(vd.a,{}),style:{margin:"0 0 18px 0"},onClick:N,children:"Traceroute"})]}),Object(W.jsxs)(X.a,{className:S.paperNetworkTools,children:[f&&Object(W.jsx)("div",{className:S.result,dangerouslySetInnerHTML:{__html:function(e){var t="";return e.map((function(e){(null===e||void 0===e?void 0:e.ip)?t+="<p><b>".concat(null===e||void 0===e?void 0:e.ip," => </b>").concat(null===e||void 0===e?void 0:e.rtt1," </p>"):t+="<p><b>False</b></p>"})),t}(f)}}),O&&Object(W.jsx)("h4",{className:S.loading,children:"Waiting..."}),w&&Object(W.jsx)("h4",{className:S.errorMessage,children:w})]})]})})]})})},kd=Object(x.a)((function(e){return{paper:{width:"100%",marginBottom:e.spacing(1)},paperNetworkTools:{width:"100%",minHeight:"50vh",backgroundColor:"#E8E8E8"},root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},icon:{fontSize:"32px !important",marginBottom:e.spacing.unit},loading:{color:"gray",textAlign:"center",paddingTop:"50px"}}})),Sd=Object(Z.b)(Ol||(Ol=Object(p.a)(["\n    mutation MyMutation {\n        action_netstat {\n            ipAddress\n            netstatResult\n        }\n    }  \n"]))),Cd=function(){var e=Object(Je.a)(Sd),t=Object(d.a)(e,1)[0],n=r.a.useState(!1),a=Object(d.a)(n,2),i=(a[0],a[1]),s=r.a.useState(!1),c=Object(d.a)(s,2),o=c[0],l=c[1],u=r.a.useState(""),p=Object(d.a)(u,2),m=p[0],O=p[1],h=r.a.useState(null),g=Object(d.a)(h,2),x=g[0],f=g[1],v=function(){var e=Object(j.a)(b.a.mark((function e(){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(""),f(null),i(!1),l(!0),e.prev=4,e.next=7,t();case 7:a=e.sent,r=null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.action_netstat,O(null===r||void 0===r?void 0:r.ipAddress),f(null===r||void 0===r?void 0:r.netstatResult),l(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(){return e.apply(this,arguments)}}(),_=kd();return Object(W.jsx)("div",{className:_.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:_.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Netstat",toolbarIcon:Object(W.jsx)(K.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/network-tools"}),Object(W.jsx)(P.a,{container:!0,children:Object(W.jsxs)(P.a,{item:!0,md:12,sm:6,xs:6,style:{padding:"40px"},children:[Object(W.jsx)("div",{style:{width:"100%",textAlign:"center"},children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:_.button,startIcon:Object(W.jsx)(Od.a,{}),style:{margin:"0 0 5px 0"},onClick:v,children:"Netstat"})}),Object(W.jsxs)(X.a,{style:{padding:"10px"},className:_.paperNetworkTools,children:[Object(W.jsx)("h4",{children:m.length>0&&"Your IP Address is :"+m}),Object(W.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:x&&x}),o&&Object(W.jsx)("h4",{className:_.loading,children:"Waiting..."})]})]})})]})})},Td=Object(x.a)((function(e){return{paper:{width:"100%",marginBottom:e.spacing(1)},paperNetworkTools:{width:"100%",minHeight:"50vh",backgroundColor:"#E8E8E8"},root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},icon:{fontSize:"32px !important",marginBottom:e.spacing.unit},loading:{color:"gray",textAlign:"center",paddingTop:"50px"}}})),Nd=Object(Z.b)(hl||(hl=Object(p.a)(["\n    mutation MyMutation {\n        action_network_scan {\n            networkScanResult\n        }\n    }  \n"]))),Pd=function(){var e=Object(Je.a)(Nd),t=Object(d.a)(e,1)[0],n=r.a.useState(!1),a=Object(d.a)(n,2),i=(a[0],a[1]),s=r.a.useState(!1),c=Object(d.a)(s,2),o=c[0],l=c[1],u=r.a.useState(null),p=Object(d.a)(u,2),m=p[0],O=p[1],h=function(){var e=Object(j.a)(b.a.mark((function e(){var n,a,r,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(null),i(!1),l(!0),e.prev=3,e.next=6,t();case 6:r=e.sent,s=null===r||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.action_network_scan)||void 0===a?void 0:a.networkScanResult,O(s),l(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}(),g=Td();return Object(W.jsx)("div",{className:g.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:g.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Network Scan",toolbarIcon:Object(W.jsx)(Te.a,{style:{margin:"-4px 8px"}}),backLinkUrl:"/dashboard/network-tools"}),Object(W.jsx)(P.a,{container:!0,children:Object(W.jsxs)(P.a,{item:!0,md:12,sm:6,xs:6,style:{padding:"40px"},children:[Object(W.jsx)("div",{style:{width:"100%",textAlign:"center"},children:Object(W.jsx)(z.a,{variant:"outlined",color:"primary",size:"medium",className:g.button,startIcon:Object(W.jsx)(Od.a,{}),style:{margin:"0 0 5px 0"},onClick:h,children:"Scan"})}),Object(W.jsxs)(X.a,{style:{padding:"10px"},className:g.paperNetworkTools,children:[Object(W.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:m&&m}),o&&Object(W.jsx)("h4",{className:g.loading,children:"Waiting..."})]})]})})]})})},Dd=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}}})),Id=function(){var e=Dd();return Object(W.jsx)("div",{className:e.root,style:{width:"100%"},children:Object(W.jsxs)(Oe.d,{children:[Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools",component:pd}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/ping",component:xd}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/traceroute",component:xd}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/netstat",component:wd}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/network-scan",component:Pd})]})})},$d=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function Ad(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=$d(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var Fd,Ud,Md,Ld,Ed,qd,Rd,Bd,Wd,zd,Gd,Kd,Hd,Vd,Yd,Qd,Jd,Xd,Zd,eu=n(182),tu=n.n(eu),nu=n(181),au=n.n(nu),ru=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}},med_priority:{backgroundColor:"#ffea0021"},high_priority:{backgroundColor:"#ff17171d"},low_priority:{backgroundColor:"#00ff1119"}}})),iu=Object(Z.b)(Fd||(Fd=Object(p.a)(["\nquery {\n    notifications(\n        order_by: {created_at: desc}\n    ) {\n        created_at\n        creator\n        id\n        message\n        priority\n        subject\n        notification_creator {\n            username\n        }\n    }\n  }\n"]))),su=Object(Z.b)(Ud||(Ud=Object(p.a)(["\n\nquery ($filter: String!) {\n    notifications(\n        order_by: {created_at: desc}, \n        where: {\n            _or: [\n                {message: {_ilike: $filter}}, \n                {subject: {_ilike: $filter}} ,\n                {notification_creator: {username: {_ilike: $filter}}}\n            ],\n        }\n    ){\n        created_at\n        creator\n        id\n        message\n        priority\n        subject\n        notification_creator {\n            username\n        }\n    }\n  }\n"]))),cu=Object(Z.b)(Md||(Md=Object(p.a)(["\n    mutation ( $user_id: uuid! ){\n        insert_view_notifications(objects: {user_id: $user_id}) {\n            returning {\n                user_id\n                id\n                viewed_at\n            }\n        }\n    }\n"]))),ou=[{id:"display",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"sender",numeric:!1,disablePadding:!1,label:"Sender"},{id:"creator",numeric:!1,disablePadding:!1,label:"Creator"},{id:"subject",numeric:!1,disablePadding:!1,label:"Subject"},{id:"message",numeric:!1,disablePadding:!1,label:"Message"},{id:"priority",numeric:!1,disablePadding:!1,label:"Priority"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Created At"}],lu=function(e){var t=e.loggedInUser,n=e.countNotifications,i=e.setNotificationsCount,s=ru(),c=Object(Je.a)(cu),o=Object(d.a)(c,1)[0],l=Object(a.useState)(!1),u=Object(d.a)(l,2),p=u[0],m=(u[1],r.a.useState({})),O=Object(d.a)(m,2),h=O[0],g=O[1],x=Object(a.useState)(iu),f=Object(d.a)(x,2),v=f[0],_=f[1],y=Object(a.useState)(!1),S=Object(d.a)(y,2),C=S[0],T=S[1],N=Object(ee.a)(v,{variables:h,notifyOnNetworkStatusChange:!0}),P=N.loading,D=(N.error,N.data),I=N.refetch,$=Object(a.useState)([]),A=Object(d.a)($,2),F=A[0],U=A[1];Object(a.useEffect)((function(){var e,n=null!==(e=null===D||void 0===D?void 0:D.notifications)&&void 0!==e?e:[];U(n.map((function(e){var n,a,r;return{id:null===e||void 0===e?void 0:e.id,creator:(null===e||void 0===e||null===(n=e.notification_creator[0])||void 0===n?void 0:n.username)?null===e||void 0===e||null===(a=e.notification_creator)||void 0===a||null===(r=a[0])||void 0===r?void 0:r.username:"System",sender_status:(null===e||void 0===e?void 0:e.creator)==(null===t||void 0===t?void 0:t.id)?"sender":"receiver",subject:null===e||void 0===e?void 0:e.subject,message:null===e||void 0===e?void 0:e.message,priority:null===e||void 0===e?void 0:e.priority,created_at:null===e||void 0===e?void 0:e.created_at}})))}),[D]),Object(a.useEffect)((function(){M()}),[C]),Object(a.useEffect)(Object(j.a)(b.a.mark((function e(){var a,r,s,c,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I(),!(n>0)){e.next=14;break}return e.prev=2,e.next=5,o({variables:{user_id:t.id}});case 5:l=e.sent,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),alert("Notification view failed");case 12:(null===(a=l)||void 0===a||null===(r=a.data)||void 0===r||null===(s=r.insert_view_notifications)||void 0===s||null===(c=s.returning[0])||void 0===c?void 0:c.viewed_at)&&i(0);case 14:case"end":return e.stop()}}),e,null,[[2,8]])}))),[]);var M=function(e){C&&e&&""!==e.target.value.trim()?L("%"+e.target.value.trim()+"%"):E()},L=function(e){_(su),g({filter:e})},E=function(){_(iu)},q=Object(Oe.g)(),R=function(e){q.push("/dashboard/notifications/"+e+"/view")},B=Object(a.useState)([]),z=Object(d.a)(B,2),G=z[0];z[1];return Object(W.jsxs)("div",{className:s.root,children:[Object(W.jsx)(Ct,{tableTitle:"Notifications",rows:F,showProgress:P,headCells:ou,rowCells:function(e){var t=e.row;return"high"==(null===t||void 0===t?void 0:t.priority)?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{className:s.high_priority,align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Display",children:Object(W.jsx)(w.a,{onClick:function(e){return R(t.id)},color:"primary","aria-label":"Display",children:Object(W.jsx)(Xc.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:"sender"==t.sender_status?Object(W.jsx)(au.a,{}):Object(W.jsx)(tu.a,{})}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:t.creator}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:t.subject.substring(0,15)}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:t.message.substring(0,20)}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:"High"}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:ae(t.created_at)})]}):"medium"==(null===t||void 0===t?void 0:t.priority)?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{className:s.med_priority,align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Display",children:Object(W.jsx)(w.a,{onClick:function(e){return R(t.id)},color:"primary","aria-label":"Display",children:Object(W.jsx)(Xc.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:"sender"==t.sender_status?Object(W.jsx)(au.a,{}):Object(W.jsx)(tu.a,{})}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:t.creator}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:t.subject.substring(0,15)}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:t.message.substring(0,20)}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:"Medium"}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:ae(t.created_at)})]}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{className:s.low_priority,align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Display",children:Object(W.jsx)(w.a,{onClick:function(e){return R(t.id)},color:"primary","aria-label":"Display",children:Object(W.jsx)(Xc.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:"sender"==t.sender_status?Object(W.jsx)(au.a,{}):Object(W.jsx)(tu.a,{})}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:t.creator}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:t.subject.substring(0,15)}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:t.message.substring(0,20)}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:"Low"}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:ae(t.created_at)})]})},onClickRefresh:function(){I()},onClickFilter:function(){T((function(e){return!e}))},onClickDelete:function(e){alert("You are not able to delete notification")},showFilterPanel:C,onChangeFilterText:M,addLinkUrl:"/dashboard/notifications/add",toolbarIcon:Object(W.jsx)(Re.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(Ad,{isOpen:p,itemsCount:G.length})]})},du=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}},med_priority:{backgroundColor:"#ffea0021"},high_priority:{backgroundColor:"#ff17171d"},low_priority:{backgroundColor:"#00ff1119"}}})),uu=Object(Z.b)(Ld||(Ld=Object(p.a)(["\nquery ($user_id: uuid!) {\n    notifications(\n        where: { \n            _or: [\n                {notification_users: {user_id: {_eq: $user_id }}},\n                {creator: {_eq: $user_id}}\n            ]\n        },   \n        order_by: {created_at: desc}\n    ) {\n        created_at\n        creator\n        id\n        message\n        priority\n        subject\n        notification_creator {\n            username\n        }\n    }\n  }\n"]))),bu=Object(Z.b)(Ed||(Ed=Object(p.a)(["\nquery ($filter: String!, $user_id: uuid!) {\n    notifications(\n        order_by: {created_at: desc}, \n        where: {\n            _or: [\n                {message: {_ilike: $filter}}, \n                {subject: {_ilike: $filter}},\n                {notification_creator: {username: {_ilike: $filter}}}\n            ],\n            _and: {\n                _or :[\n                    {notification_users: {user_id: {_eq: $user_id}}},\n                    {creator: {_eq: $user_id}}\n                ]\n            }\n        }\n    ){\n        created_at\n        creator\n        id\n        message\n        priority\n        subject\n        notification_creator {\n            username\n        }\n    }\n  }\n"]))),ju=Object(Z.b)(qd||(qd=Object(p.a)(["\n    mutation ( $user_id: uuid! ){\n        insert_view_notifications(objects: {user_id: $user_id}) {\n            returning {\n                user_id\n                id\n                viewed_at\n            }\n        }\n    }\n"]))),pu=[{id:"display",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"sender",numeric:!1,disablePadding:!1,label:"Sender"},{id:"creator",numeric:!1,disablePadding:!1,label:"Creator"},{id:"subject",numeric:!1,disablePadding:!1,label:"Subject"},{id:"message",numeric:!1,disablePadding:!1,label:"Message"},{id:"priority",numeric:!1,disablePadding:!1,label:"Priority"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Created At"}],mu=function(e){var t=e.loggedInUser,n=e.countNotifications,i=e.setNotificationsCount,s=du(),c=Object(a.useState)(!1),o=Object(d.a)(c,2),l=o[0],u=(o[1],Object(Je.a)(ju)),p=Object(d.a)(u,1)[0],m=r.a.useState({user_id:null===t||void 0===t?void 0:t.id}),O=Object(d.a)(m,2),h=O[0],g=O[1],x=Object(a.useState)(uu),f=Object(d.a)(x,2),v=f[0],_=f[1],y=Object(a.useState)(!1),S=Object(d.a)(y,2),C=S[0],T=S[1],N=Object(ee.a)(v,{variables:h,notifyOnNetworkStatusChange:!0}),P=N.loading,D=(N.error,N.data),I=N.refetch,$=Object(a.useState)([]),A=Object(d.a)($,2),F=A[0],U=A[1];Object(a.useEffect)((function(){var e,n=null!==(e=null===D||void 0===D?void 0:D.notifications)&&void 0!==e?e:[];U(n.map((function(e){var n,a,r;return{id:null===e||void 0===e?void 0:e.id,creator:(null===e||void 0===e||null===(n=e.notification_creator[0])||void 0===n?void 0:n.username)?null===e||void 0===e||null===(a=e.notification_creator)||void 0===a||null===(r=a[0])||void 0===r?void 0:r.username:"System",sender_status:(null===e||void 0===e?void 0:e.creator)==(null===t||void 0===t?void 0:t.id)?"sender":"receiver",subject:null===e||void 0===e?void 0:e.subject,message:null===e||void 0===e?void 0:e.message,priority:null===e||void 0===e?void 0:e.priority,created_at:null===e||void 0===e?void 0:e.created_at}})))}),[D]),Object(a.useEffect)((function(){M()}),[C]),Object(a.useEffect)(Object(j.a)(b.a.mark((function e(){var a,r,s,c,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I(),!(n>0)){e.next=14;break}return e.prev=2,e.next=5,p({variables:{user_id:t.id}});case 5:o=e.sent,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),alert("Notification view failed");case 12:(null===(a=o)||void 0===a||null===(r=a.data)||void 0===r||null===(s=r.insert_view_notifications)||void 0===s||null===(c=s.returning[0])||void 0===c?void 0:c.viewed_at)&&i(0);case 14:case"end":return e.stop()}}),e,null,[[2,8]])}))),[]);var M=function(e){C&&e&&""!==e.target.value.trim()?L("%"+e.target.value.trim()+"%"):E()},L=function(e){_(bu),g({filter:e,user_id:t.id})},E=function(){_(uu),g({user_id:t.id})},q=Object(Oe.g)(),R=function(e){q.push("/dashboard/notifications/"+e+"/view")},B=Object(a.useState)([]),z=Object(d.a)(B,2),G=z[0];z[1];return Object(W.jsxs)("div",{className:s.root,children:[Object(W.jsx)(Ct,{tableTitle:"Notifications",rows:F,showProgress:P,headCells:pu,rowCells:function(e){var t=e.row;return"high"==(null===t||void 0===t?void 0:t.priority)?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{className:s.high_priority,align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Display",children:Object(W.jsx)(w.a,{onClick:function(e){return R(t.id)},color:"primary","aria-label":"Display",children:Object(W.jsx)(Xc.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:"sender"==t.sender_status?Object(W.jsx)(au.a,{}):Object(W.jsx)(tu.a,{})}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:t.creator}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:t.subject.substring(0,15)}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:t.message.substring(0,20)}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:"High"}),Object(W.jsx)(Ve.a,{className:s.high_priority,children:ae(t.created_at)})]}):"medium"==(null===t||void 0===t?void 0:t.priority)?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{className:s.med_priority,align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Display",children:Object(W.jsx)(w.a,{onClick:function(e){return R(t.id)},color:"primary","aria-label":"Display",children:Object(W.jsx)(Xc.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:"sender"==t.sender_status?Object(W.jsx)(au.a,{}):Object(W.jsx)(tu.a,{})}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:t.creator}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:t.subject.substring(0,15)}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:t.message.substring(0,20)}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:"Medium"}),Object(W.jsx)(Ve.a,{className:s.med_priority,children:ae(t.created_at)})]}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{className:s.low_priority,align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Display",children:Object(W.jsx)(w.a,{onClick:function(e){return R(t.id)},color:"primary","aria-label":"Display",children:Object(W.jsx)(Xc.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:"sender"==t.sender_status?Object(W.jsx)(au.a,{}):Object(W.jsx)(tu.a,{})}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:t.creator}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:t.subject.substring(0,15)}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:t.message.substring(0,20)}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:"Low"}),Object(W.jsx)(Ve.a,{className:s.low_priority,children:ae(t.created_at)})]})},onClickRefresh:function(){I()},onClickFilter:function(){T((function(e){return!e}))},onClickDelete:function(e){alert("You are not able to delete notification")},showFilterPanel:C,onChangeFilterText:M,addLinkUrl:"/dashboard/notifications/add",toolbarIcon:Object(W.jsx)(Re.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(Ad,{isOpen:l,itemsCount:G.length})]})},Ou=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),hu=Object(Z.b)(Rd||(Rd=Object(p.a)(["\nmutation (\n  $subject: String!, \n  $message: String!, \n  $creator: uuid!,\n  $users: [notification_user_insert_input!]!  \n  $priority: String!\n) {\n insert_notifications (objects: {\n    subject: $subject, \n    message: $message,\n    notification_users: {data: $users},\n    creator: $creator,\n    priority: $priority\n  }) {\n    returning {\n      id\n    }\n  }\n}\n"]))),gu=Object(Z.b)(Bd||(Bd=Object(p.a)(["\nquery {\n  users {\n    id\n    username\n  }\n  connections {\n    id\n    name\n  }\n  user_groups {\n    id\n    name\n  }\n  connection_groups {\n    id\n    name\n  }\n}\n"]))),xu=function(e){e.insertMode,e.licenseInfo;var t,n,r,i=e.loggedInUser,s=Ou(),c=Object(Oe.i)().id,o=Object(Oe.g)(),u=Object(a.useState)(!1),p=Object(d.a)(u,2),m=p[0],O=p[1],h=Object(a.useState)({users:[],userGroups:[]}),g=Object(d.a)(h,2),x=g[0],f=g[1],v=Object(a.useState)({subject:"",message:"",users:[],userGroups:[],priority:"low"}),_=Object(d.a)(v,2),y=_[0],w=_[1],k=Object(a.useState)({subject:!1,message:!1}),S=Object(d.a)(k,2),T=S[0],N=S[1],D=Object(a.useState)({isOpen:!1,message:""}),I=Object(d.a)(D,2),$=I[0],A=I[1];Object(ee.a)(gu,{onCompleted:function(e){var t=e.users.map((function(e){return{id:e.id,title:e.username}})),n=e.user_groups.map((function(e){return{id:e.id,title:e.name}}));f({users:t,userGroups:n})}});var F=Object(Je.a)(hu),U=Object(d.a)(F,1)[0],M=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,s,d,u,j,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==y.subject.trim()){e.next=3;break}return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{subject:!0})})),e.abrupt("return");case 3:if(""!==y.message.trim()){e.next=6;break}return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{message:!0})})),e.abrupt("return");case 6:return n=y.subject,a=y.message,r=y.priority,s=y.users.map((function(e){return{user_id:e}})),y.userGroups.map((function(e){return{notification_id:c,user_group_id:e}})),d=null===i||void 0===i?void 0:i.id,e.prev=12,e.next=15,U({variables:{subject:n,message:a,users:s,creator:d,priority:r}});case 15:e.sent,A({message:"Successful",isOpen:!0}),setTimeout((function(){A((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),o.push(null!==(u=null===o||void 0===o||null===(j=o.location)||void 0===j||null===(p=j.state)||void 0===p?void 0:p.backUrl)&&void 0!==u?u:"/dashboard/notifications"),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(12),console.log(e.t0),alert("Data access error");case 25:O(!1);case 26:case"end":return e.stop()}}),e,null,[[12,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:s.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:s.paper,children:[Object(W.jsx)(be,{toolbarTitle:"New Notification",toolbarIcon:Object(W.jsx)(Re.a,{style:{margin:"-4px 8px"}}),backLinkUrl:null!==(t=null===o||void 0===o||null===(n=o.location)||void 0===n||null===(r=n.state)||void 0===r?void 0:r.backUrl)&&void 0!==t?t:"/dashboard/notifications",onClickDone:M,inProgress:m}),Object(W.jsx)("div",{className:s.root,children:Object(W.jsxs)("form",{className:s.form,noValidate:!0,autoComplete:"off",onSubmit:M,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{dir:"rtl",item:!0,md:6,children:Object(W.jsx)(je.a,{id:"subject",label:"Subject",variant:"standard",onChange:function(e){w((function(t){return Object(l.a)(Object(l.a)({},t),{},{subject:e.target.value})})),N((function(e){return Object(l.a)(Object(l.a)({},e),{},{subject:!1})}))},fullWidth:!0,value:y.name,error:T.name,required:!0})}),Object(W.jsx)(P.a,{item:!0,md:6,children:Object(W.jsxs)(je.a,{id:"priority",label:"Priority",variant:"outlined",onChange:function(e){console.log(e.target.value),w((function(t){return Object(l.a)(Object(l.a)({},t),{},{priority:e.target.value})}))},fullWidth:!0,value:y.name,error:T.name,required:!0,select:!0,defaultValue:"low",children:[Object(W.jsx)(C.a,{value:"low",children:"Low"}),Object(W.jsx)(C.a,{value:"medium",children:"Medium"}),Object(W.jsx)(C.a,{value:"high",children:"High"})]})}),Object(W.jsx)(P.a,{dir:"rtl",align:"center",item:!0,md:12,children:Object(W.jsx)(je.a,{id:"name",label:"Message",variant:"filled",multiline:!0,onChange:function(e){w((function(t){return Object(l.a)(Object(l.a)({},t),{},{message:e.target.value})})),N((function(e){return Object(l.a)(Object(l.a)({},e),{},{message:!1})}))},fullWidth:!0,value:y.name,error:T.name,required:!0})}),Object(W.jsx)(P.a,{item:!0,sm:6,children:Object(W.jsx)(Xt,{id:"users",label:"Users",placeholder:"Username",fullWidth:!0,items:x.users,selectedIds:y.users,onChange:function(e,t){var n=t.map((function(e){return e.id}));w((function(e){return Object(l.a)(Object(l.a)({},e),{},{users:n})}))}})})]}),Object(W.jsx)(bn,{backLinkUrl:"/dashboard/notifications",onClickDone:M,inProgress:m})]})})]}),Object(W.jsx)(zt.a,{open:$.isOpen,message:$.message})]})},fu=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px",minHeight:"50vh"},med_priority:{backgroundColor:"#ffea0021"},high_priority:{backgroundColor:"#ff17171d"},low_priority:{backgroundColor:"#00ff1119"},typography:{textAlign:"center"}}})),vu=Object(Z.b)(Wd||(Wd=Object(p.a)(["\nquery ($id: uuid!, $user_id: uuid!) {\n    notifications(\n        where: \n            {\n                _and: [\n                    {id: {_eq: $id}},\n                    {\n                        _or: [\n                            {notification_users: {user_id: {_eq: $user_id}}},\n                            {notification_creator: {id: {_eq: $user_id}}}\n                        ]\n                    }\n                ]\n            }\n    ) {\n        creator\n        message\n        created_at\n        priority\n        subject\n        meta\n        notification_creator {\n            username\n        }\n    }\n}\n"]))),_u=Object(Z.b)(zd||(zd=Object(p.a)(["\nquery ($userId: uuid!, $notifId: uuid!) {\n    notification_user(\n        where:{ \n            _and: [\n                {notification_id: {_eq: $notifId}},\n                {notification: {notification_creator: {id: {_eq: $userId}}}}\n            ]\n        }\n    ) {\n      user {\n        username\n      }\n    }\n}\n"]))),yu=function(e){var t,n,i,s,c=e.loggedInUser,l=(Object(Oe.g)(),fu()),u=Object(Oe.i)().id,b=r.a.useState({}),j=Object(d.a)(b,2),p=j[0],m=j[1],O=Object(a.useState)(!1),h=Object(d.a)(O,2),g=h[0],x=h[1],f=r.a.useState([]),_=Object(d.a)(f,2),y=_[0],w=_[1],k=Object(ln.a)(_u,{variables:{notifId:u,userId:null===c||void 0===c?void 0:c.id}}),S=Object(d.a)(k,2),C=S[0],T=S[1].data,N=Object(ee.a)(vu,{variables:{id:u,user_id:null===c||void 0===c?void 0:c.id},notifyOnNetworkStatusChange:!0}),D=(N.loading,N.error,N.data);N.refetch;return Object(a.useEffect)((function(){var e,t,n,a;(null===D||void 0===D||null===(e=D.notifications)||void 0===e?void 0:e[0])?(m(null===D||void 0===D||null===(t=D.notifications)||void 0===t?void 0:t[0]),(null===D||void 0===D||null===(n=D.notifications)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.creator)==(null===c||void 0===c?void 0:c.id)&&C()):x(!0)}),[D]),Object(a.useEffect)((function(){T&&w(null===T||void 0===T?void 0:T.notification_user)}),[T]),Object(W.jsx)("div",{className:l.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:(l.paper,"low"==(null===p||void 0===p?void 0:p.priority)?l.low_priority:"high"==(null===p||void 0===p?void 0:p.priority)?l.high_priority:"medium"==(null===p||void 0===p?void 0:p.priority)?l.med_priority:{}),children:[Object(W.jsx)(be,{toolbarTitle:"Notification from "+(null===p||void 0===p||null===(t=p.notification_creator)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.username),backLinkUrl:"/dashboard/notifications",toolbarIcon:Object(W.jsx)(Re.a,{style:{margin:"-4px 8px"}}),inProgress:g}),Object(W.jsx)("div",{className:l.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(W.jsx)(P.a,{item:!0,xs:9,children:Object(W.jsx)(X.a,{className:l.paper,children:Object(W.jsxs)(P.a,{container:!0,spacing:3,style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(W.jsxs)(P.a,{item:!0,xs:12,children:[Object(W.jsxs)(v.a,{className:l.typography,children:[Object(W.jsx)("h3",{children:null===p||void 0===p?void 0:p.subject}),ae(null===p||void 0===p?void 0:p.created_at)]}),Object(W.jsx)(v.a,{className:l.typography,children:Object(W.jsx)("p",{children:null===p||void 0===p?void 0:p.message})})]}),(null===p||void 0===p||null===(i=p.meta)||void 0===i?void 0:i.link)&&Object(W.jsx)(z.a,{component:o.b,color:"inherit",variant:"outlined",size:"small",to:null===p||void 0===p||null===(s=p.meta)||void 0===s?void 0:s.link,children:"Check This Notification"})]})})}),y.length>0&&Object(W.jsx)(P.a,{item:!0,xs:9,children:Object(W.jsx)(X.a,{children:Object(W.jsx)(P.a,{container:!0,style:{padding:"10px"},children:Object(W.jsxs)(P.a,{item:!0,xs:12,children:[y.length>0&&Object(W.jsx)(v.a,{className:l.typography,children:Object(W.jsx)("h4",{children:"This notification has been sent to the following users: "})}),y&&y.map((function(e){var t;return Object(W.jsx)(Sl.a,{style:{margin:"2px"},label:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.username,color:"primary"})}))]})})})})]})})]})})},wu=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px",minHeight:"50vh"},med_priority:{backgroundColor:"#ffea0021"},high_priority:{backgroundColor:"#ff17171d"},low_priority:{backgroundColor:"#00ff1119"},typography:{textAlign:"center"}}})),ku=Object(Z.b)(Gd||(Gd=Object(p.a)(["\nquery ($id: uuid!) {\n    notifications(\n        where: \n            {id: {_eq: $id}}\n    ) {\n        creator\n        message\n        created_at\n        priority\n        subject\n        meta\n        notification_creator {\n            username\n        }\n    }\n}\n"]))),Su=Object(Z.b)(Kd||(Kd=Object(p.a)(["\nquery ($notifId: uuid!) {\n    notification_user(\n        where:{ \n            notification_id: {_eq: $notifId},\n        }\n    ) {\n      user {\n        username\n      }\n    }\n}\n"]))),Cu=function(e){e.loggedInUser,Object(Oe.g)();var t,n,i,s,c=wu(),l=Object(Oe.i)().id,u=r.a.useState({}),b=Object(d.a)(u,2),j=b[0],p=b[1],m=Object(a.useState)(!1),O=Object(d.a)(m,2),h=O[0],g=O[1],x=r.a.useState([]),f=Object(d.a)(x,2),_=f[0],y=f[1],w=Object(ln.a)(Su,{variables:{notifId:l}}),k=Object(d.a)(w,2),S=k[0],C=k[1].data,T=Object(ee.a)(ku,{variables:{id:l},notifyOnNetworkStatusChange:!0}),N=(T.loading,T.error,T.data);T.refetch;return Object(a.useEffect)((function(){var e,t;(null===N||void 0===N||null===(e=N.notifications)||void 0===e?void 0:e[0])?(p(null===N||void 0===N||null===(t=N.notifications)||void 0===t?void 0:t[0]),S()):g(!0)}),[N]),Object(a.useEffect)((function(){C&&y(null===C||void 0===C?void 0:C.notification_user)}),[C]),Object(W.jsx)("div",{className:c.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:(c.paper,"low"==(null===j||void 0===j?void 0:j.priority)?c.low_priority:"high"==(null===j||void 0===j?void 0:j.priority)?c.high_priority:"medium"==(null===j||void 0===j?void 0:j.priority)?c.med_priority:{}),children:[Object(W.jsx)(be,{toolbarTitle:"Notification from "+(null===j||void 0===j||null===(t=j.notification_creator)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.username),backLinkUrl:"/dashboard/notifications",toolbarIcon:Object(W.jsx)(Re.a,{style:{margin:"-4px 8px"}}),inProgress:h}),Object(W.jsx)("div",{className:c.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(W.jsx)(P.a,{item:!0,xs:9,children:Object(W.jsx)(X.a,{className:c.paper,children:Object(W.jsxs)(P.a,{container:!0,spacing:3,style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(W.jsxs)(P.a,{item:!0,xs:12,children:[Object(W.jsxs)(v.a,{className:c.typography,children:[Object(W.jsx)("h3",{children:null===j||void 0===j?void 0:j.subject}),ae(null===j||void 0===j?void 0:j.created_at)]}),Object(W.jsx)(v.a,{className:c.typography,children:Object(W.jsx)("p",{children:null===j||void 0===j?void 0:j.message})})]}),(null===j||void 0===j||null===(i=j.meta)||void 0===i?void 0:i.link)&&Object(W.jsx)(z.a,{component:o.b,color:"inherit",variant:"outlined",size:"small",to:null===j||void 0===j||null===(s=j.meta)||void 0===s?void 0:s.link,children:"Check This Notification"})]})})}),_.length>0&&Object(W.jsx)(P.a,{item:!0,xs:9,children:Object(W.jsx)(X.a,{children:Object(W.jsx)(P.a,{container:!0,style:{padding:"10px"},children:Object(W.jsxs)(P.a,{item:!0,xs:12,children:[_.length>0&&Object(W.jsx)(v.a,{className:c.typography,children:Object(W.jsx)("h4",{children:"This notification has been sent to the following users: "})}),_&&_.map((function(e){var t;return Object(W.jsx)(Sl.a,{style:{margin:"2px"},label:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.username,color:"primary"})}))]})})})})]})})]})})},Tu=n(666),Nu=Object(Z.b)(Hd||(Hd=Object(p.a)(["\n    mutation ( $user_id: uuid! ){\n        insert_view_notifications(objects: {user_id: $user_id}) {\n            returning {\n                user_id\n                id\n                viewed_at\n            }\n        }\n    }\n"]))),Pu=function(e){var t=e.notifications,n=e.countNotifications,a=e.user_id,i=e.setNotificationsCount,s=Object(Je.a)(Nu),c=Object(d.a)(s,1)[0],o=r.a.useState(null),l=Object(d.a)(o,2),u=l[0],p=l[1],m=function(){var e=Object(j.a)(b.a.mark((function e(t){var r,s,o,l,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p(t.currentTarget),!(n>0)){e.next=14;break}return e.prev=2,e.next=5,c({variables:{user_id:a}});case 5:d=e.sent,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),alert("Notification view failed");case 12:(null===(r=d)||void 0===r||null===(s=r.data)||void 0===s||null===(o=s.insert_view_notifications)||void 0===o||null===(l=o.returning[0])||void 0===l?void 0:l.viewed_at)&&i(0);case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),O=Object(Oe.g)();return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(w.a,{color:"inherit",onClick:m,"aria-controls":"simple-menu","aria-haspopup":"true",children:Object(W.jsx)(Tu.a,{badgeContent:n,color:"secondary",children:Object(W.jsx)(Re.a,{})})}),Object(W.jsxs)(S.a,{id:"simple-menu",anchorEl:u,keepMounted:!0,open:Boolean(u),onClose:function(){p(null)},style:{width:"350px",marginTop:"30px"},children:[t&&t.map((function(e){return Object(W.jsx)(C.a,{children:Object(W.jsxs)(v.a,{variant:"inherit",children:[null===e||void 0===e?void 0:e.subject,": ",e.message]})})})),Object(W.jsx)(C.a,{children:Object(W.jsx)(v.a,{onClick:function(){O.push("/dashboard/notifications/"),p(null)},style:{color:"gray",fontSize:"small"},children:"All Notifications"})})]})]})},Du=n(623),Iu=n(677),$u=n(620),Au=n(481),Fu=n.n(Au),Uu=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px",minHeight:"50vh"},users_style:{justifyContent:"left",alignItems:"center",display:"flex"},admin_style:{justifyContent:"right",alignItems:"center",display:"flex"},ticketDetails:{marginLeft:"20px",textAlign:"left"},gridMessage:{minHeight:"100px",justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120}}})),Mu=Object(Z.b)(Vd||(Vd=Object(p.a)(["\nquery ($id: uuid!) {\n    tickets_by_pk(id: $id) {\n        id\n        status\n        applicant_id\n        applicant_posittion\n        created_at\n        subject\n        priority\n        applicant_user {\n            username\n        }\n        messages (\n            order_by: {created_at: asc}\n        ) {\n            replyer_message\n            replyer_position\n            created_at\n            replyer_user {\n              username\n            }\n        }\n    }\n}\n"]))),Lu=Object(Z.b)(Yd||(Yd=Object(p.a)(["\nmutation (\n    $ticket_id: uuid!,\n    $replyer_position: String!,\n    $replyer_message: String!,\n    $replyer_id: uuid!\n) {\n    insert_ticket_messages(\n        objects: {\n            ticket_id: $ticket_id, \n            replyer_position: $replyer_position, \n            replyer_message: $replyer_message, \n            replyer_id: $replyer_id\n        }\n    ) {\n      affected_rows\n    }\n  }\n  \n"]))),Eu=Object(Z.b)(Qd||(Qd=Object(p.a)(["\nmutation (\n  $subject: String!, \n  $message: String!, \n  $creator: uuid!,\n  $users: [notification_user_insert_input!]!  \n  $priority: String!\n  $meta: jsonb\n) {\n insert_notifications (objects: {\n    subject: $subject, \n    message: $message,\n    notification_users: {data: $users},\n    creator: $creator,\n    priority: $priority,\n    meta: $meta\n  }) {\n    returning {\n      id\n    }\n  }\n}\n"]))),qu=Object(Z.b)(Jd||(Jd=Object(p.a)(["\nmutation ($ticket_id: uuid!, $status: String!) {\n    update_tickets(where: {id: {_eq: $ticket_id}}, _set: {status: $status}) {\n        affected_rows\n    }\n}\n"]))),Ru=function(e){var t,n,i=e.loggedInUser,s=Uu(),c=Object(Oe.i)().id,o=Object(a.useState)(!1),u=Object(d.a)(o,2),p=u[0],m=u[1],O=r.a.useState({}),h=Object(d.a)(O,2),g=h[0],x=h[1],f=r.a.useState(!1),_=Object(d.a)(f,2),y=_[0],S=_[1],C=r.a.useState(""),T=Object(d.a)(C,2),N=T[0],D=T[1],I=Object(ee.a)(Mu,{variables:{id:c},notifyOnNetworkStatusChange:!0}),$=(I.loading,I.error,I.data),A=I.refetch,F=Object(Je.a)(Lu),U=Object(d.a)(F,1)[0],M=Object(Je.a)(Eu),L=Object(d.a)(M,1)[0],E=Object(Je.a)(qu),q=Object(d.a)(E,1)[0],R=Object(a.useState)({replyer_id:null===i||void 0===i?void 0:i.id,replyer_message:"",replyer_position:null===i||void 0===i?void 0:i.role,ticket_id:c}),B=Object(d.a)(R,2),G=B[0],K=B[1],H=Object(a.useState)({isOpen:!1,message:""}),V=Object(d.a)(H,2),Y=(V[0],V[1]),Q=function(){A()},J=function(){S(!1)},Z=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!1),e.prev=1,e.next=4,q({variables:{ticket_id:c,status:N}});case 4:e.sent,Y({message:"Successful",isOpen:!0}),setTimeout((function(){Y((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),A(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),alert("Data access error");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/dashboard/tickets/"+c+"/view",e.prev=1,e.next=4,L({variables:{subject:"Ticket Answered",message:null===G||void 0===G?void 0:G.replyer_message,users:[{user_id:null===g||void 0===g?void 0:g.applicant_id}],creator:null===i||void 0===i?void 0:i.id,priority:null===g||void 0===g?void 0:g.priority,meta:{link:t}}});case 4:e.sent,Y({message:"Successful",isOpen:!0}),setTimeout((function(){Y((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),alert("Data access error");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){if($)try{x(null===$||void 0===$?void 0:$.tickets_by_pk),setTimeout((function(e){document.getElementById("messagesRow").scrollTo({top:3e7,behavior:"smooth"})}),500)}catch(e){console.log(e)}}),[$]),Object(a.useEffect)((function(){setInterval((function(){A()}),15e3)}),[]);var ne=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=G.replyer_id,a=G.replyer_message,r=G.replyer_position,i=G.ticket_id,""!==G.replyer_message.trim()){e.next=4;break}return alert("Write More characters on message box"),e.abrupt("return");case 4:if(n&&a&&r&&i){e.next=7;break}return alert("Data Not Found"),e.abrupt("return");case 7:return e.prev=7,e.next=10,U({variables:{replyer_id:n,replyer_message:a,replyer_position:r,ticket_id:i}});case 10:e.sent,Y({message:"Successful",isOpen:!0}),setTimeout((function(){Y((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),A(),K((function(e){return Object(l.a)(Object(l.a)({},e),{},{replyer_message:""})})),te(),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),console.log(e.t0),alert("Data access error");case 22:m(!1);case 23:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{className:s.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{style:{minHeight:"80vh"},children:[Object(W.jsx)(be,{extraIcons:function(){return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(k.a,{title:"Refresh",children:Object(W.jsx)(w.a,{"aria-label":"refresh",onClick:Q,children:Object(W.jsx)(Ot.a,{})})})})},toolbarTitle:"Ticket :  #"+(null===g||void 0===g?void 0:g.id),backLinkUrl:"/dashboard/tickets",inProgress:p}),Object(W.jsx)(Sl.a,{className:s.ticketDetails,label:"Created At : "+ae(null===g||void 0===g?void 0:g.created_at),color:"primary"}),Object(W.jsx)(Sl.a,{className:s.ticketDetails,label:"Ticket Status : "+(null===g||void 0===g?void 0:g.status),color:"primary"}),Object(W.jsx)(Sl.a,{className:s.ticketDetails,label:"Subject : "+(null===g||void 0===g?void 0:g.subject),color:"primary"}),Object(W.jsx)(Sl.a,{className:s.ticketDetails,label:"User : "+(null===g||void 0===g||null===(t=g.applicant_user)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.username),color:"primary"}),Object(W.jsx)(z.a,{onClick:function(){S(!0)},children:"Change The Status"}),Object(W.jsxs)(Xe.a,{open:y,onClose:J,children:[Object(W.jsx)(nt.a,{children:"You Can Change The Ticket Status: "}),Object(W.jsx)(et.a,{children:Object(W.jsx)("form",{className:s.container,children:Object(W.jsxs)(mn.a,{className:s.formControl,children:[Object(W.jsx)(Du.a,{htmlFor:"demo-dialog-native",children:"Status"}),Object(W.jsxs)(Iu.a,{native:!0,value:N,onChange:function(e){D(e.target.value)},input:Object(W.jsx)($u.a,{id:"demo-dialog-native"}),children:[Object(W.jsx)("option",{value:"open",children:"Open"}),Object(W.jsx)("option",{value:"waiting",children:"Waiting"}),Object(W.jsx)("option",{value:"closed",children:"Closed"})]})]})})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:J,color:"primary",children:"Cancel"}),Object(W.jsx)(z.a,{onClick:Z,color:"primary",children:"Ok"})]})]}),Object(W.jsx)("div",{id:"messagesRow",className:s.root,style:{backgroundColor:"#F1F1F1",padding:"20px",margin:"10px 0px",overflow:"scroll",height:"60vh"},children:(null===g||void 0===g?void 0:g.messages)&&(null===g||void 0===g?void 0:g.messages.map((function(e){var t;return Object(W.jsx)(P.a,{container:!0,className:"user"==(null===e||void 0===e?void 0:e.replyer_position)?s.users_style:s.admin_style,children:Object(W.jsxs)(P.a,{item:!0,xs:6,style:{display:"flex",width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"right"},children:[Object(W.jsx)(Sl.a,{label:null===e||void 0===e||null===(t=e.replyer_user)||void 0===t?void 0:t.username,className:"user"==(null===e||void 0===e?void 0:e.replyer_position)?s.usernameChipUser:null,style:{backgroundColor:"#393E46",color:"whitesmoke",fontWeight:"900",width:"30%",margin:"10px 0px -25px 0px",zIndex:"20"}}),Object(W.jsxs)(X.a,{className:s.gridMessage,style:{backgroundColor:"#CFD2CF",margin:"10px 0px",width:"100%"},children:[Object(W.jsx)(v.a,{style:{fontSize:"medium",minWidth:"70%",margin:"30px 0px 10px 0px",textAlign:"center",backgroundColor:"#EEEEEE",borderRadius:"10px"},children:null===e||void 0===e?void 0:e.replyer_message}),Object(W.jsx)(v.a,{children:Object(W.jsx)("h5",{children:ae(null===e||void 0===e?void 0:e.created_at)})})]})]})})})))}),Object(W.jsx)("form",{className:s.form,noValidate:!0,autoComplete:"off",onSubmit:ne,children:Object(W.jsx)(je.a,{dir:"rtl",variant:"filled",style:{whiteSpace:"pre-line",backgroundColor:"#F1F1F1",margin:"30px auto",width:"100%"},multiline:!0,rows:3,required:!0,value:null===G||void 0===G?void 0:G.replyer_message,onChange:function(e){K((function(t){return Object(l.a)(Object(l.a)({},t),{},{replyer_message:e.target.value})}))},InputProps:{endAdornment:Object(W.jsxs)(w.a,{onClick:ne,children:[" ",Object(W.jsx)(Fu.a,{})]})},placeholder:"Write Your Messages"})})]})})},Bu=Object(x.a)((function(e){return{backDrop:{backdropFilter:"blur(3px)",backgroundColor:"rgba(0,0,30,0.4)"}}}));function Wu(e){var t=e.isOpen,n=e.closeMe,a=e.onConfirm,r=e.itemsCount,i=Bu(),s=function(){n()};return Object(W.jsx)("div",{children:Object(W.jsxs)(Xe.a,{open:t,onClose:s,BackdropProps:{classes:{root:i.backDrop}},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsxs)(nt.a,{id:"alert-dialog-title",children:["Delete ",r," item",r>1&&"s","?"]}),Object(W.jsx)(et.a,{children:Object(W.jsxs)(tt.a,{id:"alert-dialog-description",children:["Warning! ",Object(W.jsx)("br",{})," This will permanently delete selected items, the action can not be undone!"]})}),Object(W.jsxs)(Ze.a,{children:[Object(W.jsx)(z.a,{onClick:s,color:"primary",autoFocus:!0,children:"Cancel"}),Object(W.jsx)(z.a,{onClick:a,color:"secondary",children:"Delete"})]})]})})}var zu,Gu,Ku,Hu,Vu,Yu,Qu,Ju,Xu,Zu,eb,tb,nb=Object(x.a)((function(e){return{root:{width:"100%","& > *":{}}}})),ab=Object(Z.b)(Xd||(Xd=Object(p.a)(["\nquery {\n    tickets(\n        order_by: {created_at: desc}, \n    ) {\n        id\n        created_at\n        subject\n        status\n        priority\n        applicant_user {\n            username\n        }\n    }\n}\n"]))),rb=Object(Z.b)(Zd||(Zd=Object(p.a)(["\nquery ($filter: String!) {\n    tickets(\n        order_by: {created_at: desc}, \n        where: {\n            _or:[\n                {subject: {_ilike: $filter}},\n                {applicant_user: {username: {_ilike: $filter}}}\n            ]\n        }\n    ){\n        id\n        created_at\n        subject\n        status\n        priority\n        applicant_user {\n            username\n        }\n    }\n}\n"]))),ib=[{id:"display",numeric:!1,disablePadding:!0,label:"",width:"50px"},{id:"subject",numeric:!1,disablePadding:!1,label:"Subject"},{id:"username",numeric:!1,disablePadding:!1,label:"Username"},{id:"priority",numeric:!1,disablePadding:!1,label:"Priority"},{id:"status",numeric:!1,disablePadding:!1,label:"Status"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Created At"}],sb=function(e){var t=e.loggedInUser,n=nb(),i=Object(Oe.g)(),s=Object(a.useState)(!1),c=Object(d.a)(s,2),o=c[0],l=(c[1],r.a.useState({user_id:null===t||void 0===t?void 0:t.id})),u=Object(d.a)(l,2),b=u[0],j=u[1],p=Object(a.useState)(!1),m=Object(d.a)(p,2),O=m[0],h=m[1],g=Object(a.useState)([]),x=Object(d.a)(g,2),f=x[0],v=x[1],_=Object(a.useState)(ab),y=Object(d.a)(_,2),S=y[0],C=y[1],T=Object(ee.a)(S,{variables:b,notifyOnNetworkStatusChange:!0}),N=T.loading,P=(T.error,T.data),D=T.refetch,I=function(e){O&&e&&""!==e.target.value.trim()?$("%"+e.target.value.trim()+"%"):A()},$=function(e){C(rb),j({filter:e,user_id:t.id})},A=function(){C(ab),j({user_id:t.id})},F=Object(a.useState)([]),U=Object(d.a)(F,2),M=U[0];U[1];Object(a.useEffect)((function(){var e,t=null!==(e=null===P||void 0===P?void 0:P.tickets)&&void 0!==e?e:[];v(t.map((function(e){var t,n;return{id:null===e||void 0===e?void 0:e.id,subject:null===e||void 0===e?void 0:e.subject,username:null===e||void 0===e||null===(t=e.applicant_user)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.username,priority:null===e||void 0===e?void 0:e.priority,status:null===e||void 0===e?void 0:e.status,created_at:null===e||void 0===e?void 0:e.created_at}})))}),[P]),Object(a.useEffect)((function(){I()}),[O]);return Object(W.jsxs)("div",{className:n.root,children:[Object(W.jsx)(Ct,{tableTitle:"Tickets",rows:f,showProgress:N,headCells:ib,rowCells:function(e){var t=e.row;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ve.a,{align:"right",style:{width:50},children:Object(W.jsx)(k.a,{title:"Display",children:Object(W.jsx)(w.a,{onClick:function(e){return n=t.id,void i.push("/dashboard/tickets/"+n+"/view");var n},color:"primary","aria-label":"Display",children:Object(W.jsx)(Xc.a,{fontSize:"small"})})})}),Object(W.jsx)(Ve.a,{children:t.subject.substring(0,15)}),Object(W.jsx)(Ve.a,{children:t.username}),Object(W.jsx)(Ve.a,{children:t.priority}),Object(W.jsx)(Ve.a,{children:t.status}),Object(W.jsx)(Ve.a,{children:ae(t.created_at)})]})},rowsAddable:!1,onClickRefresh:function(){D()},onClickFilter:function(){h((function(e){return!e}))},onClickDelete:function(e){alert("You are not able to delete Ticket")},showFilterPanel:O,onChangeFilterText:I,addLinkUrl:"/dashboard/tickets/add",toolbarIcon:Object(W.jsx)(We.a,{style:{margin:"-4px 8px"}})}),Object(W.jsx)(Wu,{isOpen:o,itemsCount:M.length})]})},cb=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)},"& h3":{margin:"3px 0",fontStyle:"italic"}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1),padding:"1px",paddingLeft:"10px",textAlign:"left",paddingBottom:"10px"}}})),ob=Object(Z.b)(zu||(zu=Object(p.a)(['\nquery ($id: uuid!) {\n  sessions_by_pk(id: $id){\n    id\n    meta\n    status\n    created_at\n    access_rule {\n      name\n    }\n    connection {\n      name\n    }\n    user {\n      username\n    }  \n  }\n  settings(where: {name: {_eq: "transparentIpAddress"}}) {\n    value\n  }\n}\n']))),lb=Object(Z.b)(Gu||(Gu=Object(p.a)(["\nmutation ($sessionId: uuid!) {\n  action_transparent_render_video(sessionId: $sessionId) {\n    result,\n    message,\n    link\n  }\n}\n"]))),db=Object(Z.b)(Ku||(Ku=Object(p.a)(["\nmutation($sessionId: uuid!) {\n  action_transparent_video_status (sessionId: $sessionId) {\n    result,\n    message,\n    link\n  }\n}\n"]))),ub=Object(Z.b)(Hu||(Hu=Object(p.a)(["\nmutation($sessionId: uuid!) {\n  action_transparent_keyStrokes (sessionId: $sessionId) {\n    result,\n    output\n  }\n}\n"]))),bb=function(e){e.licenseInfo;var t,n,r,i,s,c,o,u=Object(Oe.i)().id,p=cb(),m=Object(Oe.g)(),O=Object(a.useState)(!1),h=Object(d.a)(O,2),g=h[0],x=h[1],f=Object(a.useState)({}),v=Object(d.a)(f,2),_=v[0],y=v[1],S=Object(a.useState)(null),C=Object(d.a)(S,2),T=C[0],N=C[1],D=Object(a.useState)({}),I=Object(d.a)(D,2),$=I[0],A=I[1],F=Object(a.useState)(!0),U=Object(d.a)(F,2),M=U[0],L=U[1],E=Object(a.useState)(!1),q=Object(d.a)(E,2),R=q[0],B=q[1],G=Object(a.useState)("null"),K=Object(d.a)(G,2),H=K[0],V=K[1],Y=Object(a.useState)(!0),Q=Object(d.a)(Y,2),J=Q[0],Z=Q[1],te=Object(a.useRef)(),ne=Object(ee.a)(ob,{variables:{id:u}}),re=ne.data,ie=ne.refetch,se=Object(Je.a)(lb),ce=Object(d.a)(se,1)[0],oe=Object(Je.a)(ub),le=Object(d.a)(oe,1)[0],de=Object(Je.a)(db),ue=Object(d.a)(de,1)[0];Object(a.useEffect)((function(){var e,t;(null===re||void 0===re?void 0:re.settings)&&N(null===re||void 0===re||null===(e=re.settings)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.value);if(null===re||void 0===re?void 0:re.sessions_by_pk){var n,a=re.sessions_by_pk;(null===a||void 0===a||null===(n=a.meta)||void 0===n?void 0:n.transparentMode)||m.push("/dashboard/sessions-history/".concat(u,"/view")),y(a),x(!1)}else x(!0)}),[re]);var je=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue({variables:{sessionId:u}});case 2:n=e.sent,(null===(a=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.action_transparent_video_status)||void 0===a?void 0:a.result)?(A({available:null===a||void 0===a?void 0:a.result}),(null===a||void 0===a?void 0:a.link)?(A((function(e){return Object(l.a)(Object(l.a)({},e),{},{link:null===a||void 0===a?void 0:a.link})})),L(!1),B(!0),console.log(null===a||void 0===a?void 0:a.link)):(console.log(null===a||void 0===a?void 0:a.message),B(!1),L(!1))):(A({available:null===a||void 0===a?void 0:a.result}),console.log(null===a||void 0===a?void 0:a.message),L(!0));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){return je(),te.current=setInterval(ge,1e4),function(){clearInterval(te.current)}}),[]);var pe=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r,i,s,c,o,l,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z(!1),"ready"!=(null===(a=null===re||void 0===re?void 0:re.sessions_by_pk)||void 0===a?void 0:a.status)&&"initializing"!=(null===a||void 0===a?void 0:a.status)){e.next=5;break}return alert("The session has not started!"),e.abrupt("return");case 5:return e.next=7,le({variables:{sessionId:u}});case 7:(null===(r=e.sent)||void 0===r||null===(t=r.data)||void 0===t||null===(n=t.action_transparent_keyStrokes)||void 0===n?void 0:n.result)?V({result:!0,output:null===r||void 0===r||null===(i=r.data)||void 0===i||null===(s=i.action_transparent_keyStrokes)||void 0===s?void 0:s.output}):(V({result:!1,output:null===r||void 0===r||null===(c=r.data)||void 0===c||null===(o=c.action_transparent_keyStrokes)||void 0===o?void 0:o.output}),console.log(null===r||void 0===r||null===(l=r.data)||void 0===l||null===(d=l.action_transparent_keyStrokes)||void 0===d?void 0:d.message));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to start rendering this session?")){e.next=10;break}if("ready"!=(null===(a=null===re||void 0===re?void 0:re.sessions_by_pk)||void 0===a?void 0:a.status)&&"initializing"!=(null===a||void 0===a?void 0:a.status)){e.next=5;break}return alert("The session has not started!"),e.abrupt("return");case 5:return L(!1),e.next=8,ce({variables:{sessionId:u}});case 8:(null===(r=e.sent)||void 0===r||null===(t=r.data)||void 0===t||null===(n=t.action_transparent_render_video)||void 0===n?void 0:n.result)?L(!1):(alert(null===r||void 0===r||null===(i=r.data)||void 0===i||null===(s=i.action_transparent_render_video)||void 0===s?void 0:s.message),L(!0));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="".concat(T,":3001/session/v/").concat(u),window.open(t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ge=function(){ie(),je()},xe="";return(null===$||void 0===$?void 0:$.available)&&(xe="Available"),(null===$||void 0===$?void 0:$.available)||(xe="Not Available"),Object(W.jsx)("div",{className:p.root,style:{width:"100%"},children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)(be,{toolbarTitle:"Session Details",backLinkUrl:"/dashboard/sessions-history",inProgress:g,extraIcons:function(){return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(k.a,{title:"Refresh",children:Object(W.jsx)(w.a,{"aria-label":"refresh",onClick:ge,children:Object(W.jsx)(Ot.a,{})})})})}}),Object(W.jsx)("div",{className:p.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Username"}),Object(W.jsx)("span",{children:null===_||void 0===_||null===(t=_.user)||void 0===t?void 0:t.username})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Connection Name"}),Object(W.jsx)("span",{children:null===_||void 0===_||null===(n=_.connection)||void 0===n?void 0:n.name})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Access Rule Name"}),Object(W.jsx)("span",{children:null===_||void 0===_||null===(r=_.access_rule)||void 0===r?void 0:r.name})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Session Status"}),Object(W.jsx)("span",{children:null===_||void 0===_?void 0:_.status})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Session Started at"}),Object(W.jsx)("span",{children:(null===_||void 0===_||null===(i=_.meta)||void 0===i?void 0:i.liveAt)?ae(null===_||void 0===_||null===(s=_.meta)||void 0===s?void 0:s.liveAt):ae(null===_||void 0===_?void 0:_.created_at)})]})}),Object(W.jsx)(P.a,{item:!0,xs:3,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Session Closed at"}),Object(W.jsx)("span",{children:(null===_||void 0===_||null===(c=_.meta)||void 0===c?void 0:c.closedAt)?ae(null===_||void 0===_||null===(o=_.meta)||void 0===o?void 0:o.closedAt):"N/A"})]})}),Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Session Unique ID"}),Object(W.jsx)("span",{children:null===_||void 0===_?void 0:_.id})]})})]})}),Object(W.jsx)("h4",{children:"Video Details"}),Object(W.jsx)("div",{className:p.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:4,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Video Status"}),Object(W.jsx)("span",{children:xe})]})}),Object(W.jsx)(P.a,{item:!0,xs:8,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Download Video"}),Object(W.jsxs)("span",{children:[Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Yl.a,{}),onClick:me,disabled:!M,children:"Render Video"}),"\xa0 \xa0 \xa0",Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Yl.a,{}),onClick:he,disabled:!R,children:"Download Video"})]})]})})]})}),Object(W.jsx)("h4",{children:"Keystrokes Details"}),Object(W.jsx)("div",{className:p.root,style:{padding:"20px"},children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Render Keystrokes"}),Object(W.jsx)("span",{children:Object(W.jsx)(z.a,{size:"small",color:"primary",startIcon:Object(W.jsx)(Ql.a,{}),onClick:pe,disabled:!J,children:"Render Keystrokes"})})]})}),H&&Object(W.jsx)(P.a,{item:!0,xs:6,children:Object(W.jsxs)(X.a,{className:p.paper,children:[Object(W.jsx)("h3",{children:"Keystrokes Output:"}),Object(W.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:null===H||void 0===H?void 0:H.output})]})})]})})]})})},jb=Object(x.a)((function(e){return{root:{"& .MuiTextField-root":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}},form:{padding:e.spacing(2)},paper:{width:"100%",marginBottom:e.spacing(1)}}})),pb=Object(Z.b)(Vu||(Vu=Object(p.a)(['\nmutation ($name: String!, $value: String!) {\n\n  delete_settings (where: {_and: [\n    {type: {_eq: "system"}},\n    {name: {_eq: $name}}\n  ]}) {\n    affected_rows\n  }  \n  \n  insert_settings_one(object: {\n      type: "system", \n      name: $name, \n      value: $value, \n  }) {\n    id\n  }\n}\n']))),mb=Object(Z.b)(Yu||(Yu=Object(p.a)(['\nquery {\nsettings(where: {name: {_eq: "user-behavior-analytics"}}) {\n    value\n  }\n}\n']))),Ob=function(){var e=jb(),t=r.a.useState(!1),n=Object(d.a)(t,2),i=n[0],s=n[1],c=Object(a.useState)({isOpen:!1,message:""}),o=Object(d.a)(c,2),u=o[0],p=o[1],m=Object(a.useState)([]),O=Object(d.a)(m,2),h=O[0],g=O[1],x=Object(a.useState)([]),f=Object(d.a)(x,2),v=f[0],_=f[1],y=Object(Je.a)(pb),w=Object(d.a)(y,1)[0],k=Object(ee.a)(mb),S=(k.loading,k.error,k.data);Object(a.useEffect)((function(){var e,t,n=null===S||void 0===S||null===(e=S.settings)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.value;if(n){var a=[],r=JSON.parse(n);_(r),r.forEach((function(e){a.push(null===e||void 0===e?void 0:e.id)})),g(a)}}),[S]);var C=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,w({variables:{name:"user-behavior-analytics",value:JSON.stringify(v)}});case 4:p({message:"Successful",isOpen:!0}),setTimeout((function(){p((function(e){return Object(l.a)(Object(l.a)({},e),{},{isOpen:!1})}))}),1e3),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),alert("Data access error");case 12:s(!1);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsxs)("div",{className:e.root,style:{width:"100%"},children:[Object(W.jsxs)(X.a,{className:e.paper,children:[Object(W.jsx)(be,{toolbarTitle:"User Behaviour Analytics",toolbarIcon:Object(W.jsx)(Ge.a,{style:{margin:"-4px 8px"}}),onClickDone:C,inProgress:i}),Object(W.jsx)("div",{className:e.root,children:Object(W.jsx)("form",{className:e.form,noValidate:!0,autoComplete:"off",onSubmit:C,children:Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(Xt,{id:"users",label:"Abnormal Activity",placeholder:"Add Abnormal Activity",items:[{id:"login-failed",title:"Login Failed",description:"The number of failed logins for each user is higher than the previous days and the normal state"},{id:"suspicious-logins",title:"Suspicious Logins",description:"Monitor users' device and IP when logging in and suspicious cases"},{id:"suspicious-ticket",title:"Suspicious Ticket",description:"Monitoring of users who suddenly have more tickets than usual after a long time."},{id:"poor-password",title:"Poor Password",description:"Monitoring of users whose passwords are very weak"},{id:"suspicious-failed-session",title:"Suspicious Failed Session",description:"Monitoring of users who fail to login to their servers"}],fullWidth:!0,onChange:function(e,t){var n=t.map((function(e){return e.id}));g(n),_(t)},selectedIds:h})}),Object(W.jsx)(P.a,{item:!0,xs:12,children:v.map((function(e){return Object(W.jsxs)("p",{style:{fontSize:"medium"},children:[" ",Object(W.jsxs)("span",{style:{fontWeight:"bold"},children:[null===e||void 0===e?void 0:e.title," : "]}),null===e||void 0===e?void 0:e.description]})}))}),Object(W.jsx)(bn,{backLinkUrl:"/dashboard/users",onClickDone:C,inProgress:i})]})})})]}),Object(W.jsx)(zt.a,{open:u.isOpen,message:u.message})]})},hb=Object(Z.a)(Qu||(Qu=Object(p.a)(["\nmutation {\n  action_auth_sign_out {\n    success\n  }\n}\n"]))),gb=Object(Z.a)(Ju||(Ju=Object(p.a)(["\nquery {\n  action_mgmt_license_info {\n    result\n  }\n}\n"]))),xb=Object(Z.a)(Xu||(Xu=Object(p.a)(["\t\nquery Query($user_id: uuid!) {\t\n  view_notifications(\t\n    where: {\t\n      user_id: {_eq: $user_id}\t\n    }, \t\n    order_by: {viewed_at: desc},\t\n    limit: 1\t\n  ){\t\n    viewed_at\t\n    user_id\t\n    id\t\n  }\t\n}\t\n"]))),fb=Object(Z.a)(Zu||(Zu=Object(p.a)(["\t\n  query Query( $viewed_at: timestamptz!, $user_id: uuid! ) {\t\n    notifications(\t\n      where: {\t\n        created_at: {_gt: $viewed_at},\t\n        _or: [\n            {creator: {_eq: $user_id}}, \n            {notification_users: {user_id: {_eq: $user_id}}}\n        ]\n      }, \t\n      order_by: {created_at: desc},\t\n    ){\t\n      created_at\t\n      creator\t\n      id\t\n      subject\t\n      message\t\n      priority\t\n    }\t\n  }\t\n"]))),vb=Object(Z.a)(eb||(eb=Object(p.a)(["\t\n  query Query( $viewed_at: timestamptz!) {\t\n    notifications(\t\n      where: {\t\n        created_at: {_gt: $viewed_at},\t\n      }, \t\n      order_by: {created_at: desc},\t\n    ){\t\n      created_at\t\n      creator\t\n      id\t\n      subject\t\n      message\t\n      priority\t\n    }\t\n  }\t\n"]))),_b=Object(Z.a)(tb||(tb=Object(p.a)(['\nquery MyQuery {\n  settings(where: {name: {_eq: "roleOfTicketsManagement"}}) {\n    value\n  }\n}\n'])));function yb(){return Object(W.jsxs)(v.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(W.jsx)(A.a,{color:"inherit",href:"https://rajaco.com/",target:"_blank",children:"Raja IT"})," ",(new Date).getFullYear(),Object(W.jsx)("i",{children:" - v1.32.3 "})]})}var wb=Object(x.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:Object(l.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1,textAlign:"left"},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(h.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.up("sm"),{width:e.spacing(9)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240}}}));function kb(e){var t=e.loggedInUser,n=e.setLoggedInUser,i=e.intendedUrl,s=e.refetchAuthStatus,c=wb(),o=Object(Oe.g)(),l=Object(Oe.h)(),u=Object(a.useRef)([]),p=r.a.useState(!0),h=Object(d.a)(p,2),x=h[0],A=h[1],F=r.a.useState(!1),M=Object(d.a)(F,2),E=M[0],R=M[1],z=r.a.useState(null),G=Object(d.a)(z,2),K=G[0],H=G[1],V=Object(a.useRef)(new Date),Y=r.a.useState({user_id:t.id}),Q=Object(d.a)(Y,2),J=Q[0],X=Q[1],Z=r.a.useState(0),ee=Object(d.a)(Z,2),te=ee[0],ne=ee[1],ae=r.a.useState([]),re=Object(d.a)(ae,2),ie=re[0],se=re[1],ce=r.a.useState(["administrator"]),oe=Object(d.a)(ce,2),le=oe[0],de=oe[1],ue=Object(Je.a)(hb),be=Object(d.a)(ue,1)[0],je=Object(ln.a)(_b),pe=Object(d.a)(je,2),me=pe[0],he=pe[1].data,ge=Object(ln.a)(gb),xe=Object(d.a)(ge,2),fe=xe[0],ve=xe[1].data,_e=Object(ln.a)(xb,{variables:{user_id:null===t||void 0===t?void 0:t.id}}),ye=Object(d.a)(_e,2),we=ye[0],ke=ye[1].data,Se=Object(ln.a)(fb,{variables:J}),Ce=Object(d.a)(Se,2),Te=Ce[0],Ne=Ce[1].data,Pe=Object(ln.a)(vb,{variables:J}),De=Object(d.a)(Pe,2),Ie=De[0],$e=De[1].data;Object(a.useEffect)((function(){he&&de((function(e){var t,n;return[].concat(Object(O.a)(e),[null===he||void 0===he||null===(t=he.settings)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.value])}))}),[he]),Object(a.useEffect)((function(){we()}),[l]),Object(a.useEffect)((function(){if(ke){var e,n,a=null;a=ke&&(null===ke||void 0===ke||null===(e=ke.view_notifications)||void 0===e?void 0:e.length)>0?null===ke||void 0===ke||null===(n=ke.view_notifications[0])||void 0===n?void 0:n.viewed_at:"1970-01-01T06:37:57.079147+00:00","administrator"==(null===t||void 0===t?void 0:t.role)?(X({viewed_at:a}),Ie()):(X({user_id:t.id,viewed_at:a}),Te())}}),[ke]),Object(a.useEffect)((function(){var e;if(null===Ne||void 0===Ne?void 0:Ne.notifications)ne(null===Ne||void 0===Ne||null===(e=Ne.notifications)||void 0===e?void 0:e.length),se(null===Ne||void 0===Ne?void 0:Ne.notifications);else if(null===$e||void 0===$e?void 0:$e.notifications){var t;ne(null===$e||void 0===$e||null===(t=$e.notifications)||void 0===t?void 0:t.length),se(null===$e||void 0===$e?void 0:$e.notifications)}}),[Ne,$e]),Object(a.useEffect)((function(){me(),window.onbeforeunload=function(){Ue()},"administrator"===t.role&&fe()}),[]);var Ae=function(){var e=Object(j.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(!0),Ue(),e.next=4,be();case 4:a=e.sent,R(!1),n(!1),i.current="/dashboard",a.data.action_auth_sign_out.success&&o.replace("/sign-in"),s();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ue(),n(!1),i.current="/dashboard",o.replace("/sign-in"),s();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e,t=Object(m.a)(u.current);try{for(t.s();!(e=t.n()).done;){var n=e.value;null===n||void 0===n||n.close()}}catch(a){t.e(a)}finally{t.f()}};return!1===t&&o.replace("/sign-in"),Object(W.jsxs)("div",{className:c.root,children:[Object(W.jsx)(zl,{lastWindowActivityAt:V,doLogout:Fe}),Object(W.jsx)(f.a,{}),Object(W.jsx)(_.a,{position:"absolute",className:Object(g.a)(c.appBar,x&&c.appBarShift),children:Object(W.jsxs)(y.a,{className:c.toolbar,children:[Object(W.jsx)(w.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(){A(!0)},className:Object(g.a)(c.menuButton,x&&c.menuButtonHidden),children:Object(W.jsx)(U.a,{})}),Object(W.jsx)(v.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:c.title,children:"Privileged Access Management"}),Object(W.jsx)(Pu,{notifications:ie,countNotifications:te,user_id:t.id,setNotificationsCount:ne}),Object(W.jsx)(k.a,{title:"Profile",children:Object(W.jsx)(w.a,{color:"inherit",onClick:function(e){H(e.currentTarget)},children:Object(W.jsx)(B.a,{})})}),Object(W.jsx)(S.a,{id:"simple-menu",anchorEl:K,keepMounted:!0,open:Boolean(K),onClose:function(){H(null)},children:Object(W.jsxs)(C.a,{onClick:function(){o.push("/dashboard/my-profile"),H(null)},children:[t.username," (Profile Settings)"]})}),Object(W.jsx)(k.a,{title:"Sign Out",children:Object(W.jsx)(w.a,{color:"inherit",onClick:Ae,children:Object(W.jsx)(q.a,{})})})]})}),Object(W.jsxs)(T.a,{variant:"permanent",classes:{paper:Object(g.a)(c.drawerPaper,!x&&c.drawerPaperClose)},open:x,children:[Object(W.jsx)("div",{className:c.toolbarIcon,children:Object(W.jsx)(w.a,{onClick:function(){A(!1)},children:Object(W.jsx)(L.a,{})})}),Object(W.jsx)(He,{loggedInUser:t})]}),Object(W.jsxs)("main",{className:c.content,children:[Object(W.jsx)("div",{className:c.appBarSpacer}),Object(W.jsxs)(N.a,{maxWidth:"lg",className:c.container,children:[Object(W.jsxs)(P.a,{container:!0,spacing:3,children:[Object(W.jsx)(ad,{licenseInfo:ve}),Object(W.jsxs)(Oe.d,{children:[Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/user-groups",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Xn,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/user-groups/add",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(ra,{insertMode:!0})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/user-groups/:id",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(ra,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/users",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Wt,{loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/users/add",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Mn,{loggedInUser:t,insertMode:!0})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/users/:id",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Mn,{loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/users/:id/view",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Dl,{loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/users/:id/access-rules",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Al,{loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/users-locked",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Zo,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/connection-groups",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Za,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/connection-groups/add",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(ir,{insertMode:!0})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/connection-groups/:id",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(ir,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/connections",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(ja,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/connections/add",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(La,{insertMode:!0,licenseInfo:ve})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/connections/:id",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(La,{licenseInfo:ve})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/connections/:id/access-rules",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Ml,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/access-rules",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(jr,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/access-rules/add",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)($r,{licenseInfo:ve,insertMode:!0})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/access-rules/:id",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)($r,{licenseInfo:ve})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/tickets/:id/view",children:le.includes(t.role)&&Object(W.jsx)(Ru,{loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/tickets",children:le.includes(t.role)&&Object(W.jsx)(sb,{loggedInUser:t})}),["administrator"].includes(t.role)&&Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/notifications",children:Object(W.jsx)(lu,{licenseInfo:ve,loggedInUser:t,countNotifications:te,setNotificationsCount:ne})}),["moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/notifications",children:Object(W.jsx)(mu,{loggedInUser:t,countNotifications:te,setNotificationsCount:ne})}),["administrator"].includes(t.role)&&Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/notifications/:id/view",children:Object(W.jsx)(Cu,{loggedInUser:t})}),["moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/notifications/:id/view",children:Object(W.jsx)(yu,{loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/notifications/add",children:["administrator","moderator","supervisor","auditor"].includes(t.role)&&Object(W.jsx)(xu,{licenseInfo:ve,loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools",children:["administrator","moderator"].includes(t.role)&&Object(W.jsx)(Id,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/ping",children:["administrator","moderator"].includes(t.role)&&Object(W.jsx)(xd,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/traceroute",children:["administrator","moderator"].includes(t.role)&&Object(W.jsx)(wd,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/netstat",children:["administrator","moderator"].includes(t.role)&&Object(W.jsx)(Cd,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/network-tools/network-scan",children:["administrator","moderator"].includes(t.role)&&Object(W.jsx)(Id,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/live-sessions",children:["administrator","auditor","sessionMonitoring"].includes(t.role)&&Object(W.jsx)(zo,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/sessions-history",children:["administrator","auditor"].includes(t.role)&&Object(W.jsx)(di,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/sessions-search",children:["administrator","auditor"].includes(t.role)&&Object(W.jsx)(Bl,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/sessions-player",children:["administrator","auditor"].includes(t.role)&&Object(W.jsx)(od,{})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/sessions-history/:id/view",children:["administrator","auditor"].includes(t.role)&&Object(W.jsx)(td,{licenseInfo:ve})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/sessions-history/:id/view-transparent",children:["administrator","auditor"].includes(t.role)&&Object(W.jsx)(bb,{licenseInfo:ve})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/logs",children:["administrator","moderator","auditor"].includes(t.role)&&Object(W.jsx)(kl,{})}),Object(W.jsx)(Oe.b,{path:"/dashboard/user-behavior-analytics",children:["administrator","moderator"].includes(t.role)&&Object(W.jsx)(Ob,{licenseInfo:ve})}),Object(W.jsx)(Oe.b,{path:"/dashboard/settings",children:["administrator","moderator"].includes(t.role)&&Object(W.jsx)(Eo,{licenseInfo:ve,loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/my-profile",children:Object(W.jsx)(Ei,{loggedInUser:t})}),Object(W.jsx)(Oe.b,{exact:!0,path:"/dashboard/change-password",children:Object(W.jsx)(Ei,{loggedInUser:t})})]})]}),Object(W.jsx)(D.a,{pt:4,children:Object(W.jsx)(yb,{})})]})]}),Object(W.jsx)(I.a,{className:c.backdrop,open:E,children:Object(W.jsx)($.a,{color:"inherit"})})]})}var Sb=Object(x.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},cont:{backgroundColor:"#fafafa;"}}}));function Cb(e){var t=e.authError,n=e.loggedInUser,r=e.intendedUrl,i=Sb(),s=Object(a.useState)(""),c=Object(d.a)(s,2),o=c[0],l=c[1];return Object(a.useEffect)((function(){l(t?"Error accessing authentication service":null)}),[t]),Object(W.jsxs)(N.a,{component:"main",maxWidth:!1,className:i.cont,children:[""===(null===n||void 0===n?void 0:n.id)&&Object(W.jsx)(Oe.a,{to:"/sign-in"}),(null===n||void 0===n?void 0:n.id)&&Object(W.jsx)(Oe.a,{to:r}),Object(W.jsx)(f.a,{}),Object(W.jsxs)("div",{className:i.root,children:[Object(W.jsx)("div",{className:i.paper,children:Object(W.jsx)(v.a,{component:"h1",variant:"h5",style:{marginTop:"30px"},children:o||"Loading..."})}),Object(W.jsx)("div",{style:{maxWidth:"400px",margin:"2em auto"},children:o?Object(W.jsx)(xt.a,{variant:"determinate",value:100}):Object(W.jsx)(xt.a,{})})]})]})}var Tb,Nb,Pb,Db=n(686),Ib=n.p+"static/media/tower.627276f2.jpg",$b=Object(Z.a)(Tb||(Tb=Object(p.a)(["\nmutation ACTION_AUTH_SIGN_IN ($password: String!, $username: String!, $extra: json, $panel: String) {\n    action_auth_sign_in(credentials: {password: $password, username: $username, extra: $extra, panel: $panel}) {\n      success\n      authToken\n    }\n}  \n"]))),Ab=Object(Z.a)(Nb||(Nb=Object(p.a)(['\n  {\n    settings (where: {name: { _eq: "brandingLogo"}}) {\n      value\n    }\n  }  \n']))),Fb=Object(Z.a)(Pb||(Pb=Object(p.a)(['\n  {\n    settings (where: {name: { _eq: "brandingBackground"}}) {\n      value\n    }\n  }  \n'])));function Ub(){return Object(W.jsxs)(v.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 Raja IT ",(new Date).getFullYear(),Object(W.jsx)("i",{children:" - v1.32.3 "})]})}var Mb=Object(x.a)((function(e){return{root:{height:"100vh"},image:{backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(2,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},wrapper:{margin:e.spacing(1),position:"relative"},buttonProgress:{color:e.palette.primary.main,position:"absolute",top:"50%",left:"50%",marginTop:-7,marginLeft:-12},brandingLogo:{maxWidth:"100%",maxHeight:"26vh"}}}));function Lb(e){var t=e.onSignIn,n=Mb(),i=Object(a.useRef)(),s=Object(a.useRef)(),c=Object(a.useRef)(),o=Object(a.useRef)(),l=Object(a.useState)(!1),u=Object(d.a)(l,2),p=u[0],m=u[1],O=r.a.useState(!1),h=Object(d.a)(O,2),g=h[0],x=h[1],_=Object(Je.a)($b),y=Object(d.a)(_,1)[0],w=Object(a.useState)(!1),k=Object(d.a)(w,2),S=k[0],C=k[1],T=Object(a.useState)(""),N=Object(d.a)(T,2),I=N[0],A=N[1],F=Object(a.useState)(""),U=Object(d.a)(F,2),M=U[0],L=U[1],E=Object(a.useState)(""),q=Object(d.a)(E,2),R=q[0],B=q[1],G=Object(ee.a)(Ab).data,K=Object(ee.a)(Fb).data;r.a.useEffect((function(){var e,t,n=null===G||void 0===G||null===(e=G.settings)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.value;n&&((n.startsWith("data:image/jpeg")||n.startsWith("data:image/png"))&&L(n))}),[G]),r.a.useEffect((function(){var e,t,n=null===K||void 0===K||null===(e=K.settings)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.value;n&&((n.startsWith("data:image/jpeg")||n.startsWith("data:image/png"))&&B(n))}),[K]);var H=function(){var e=Object(j.a)(b.a.mark((function e(n){var a,r,l,d,u,j,p,O;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),a=i.current.value,r=s.current.value,l=c.current.checked,d=o.current.value,x(!0),e.prev=6,e.next=9,y({variables:{username:a,password:r,extra:{remember:l,oneTimePassword:d},panel:"admin"}});case 9:p=e.sent,(O=null===p||void 0===p||null===(u=p.data)||void 0===u||null===(j=u.action_auth_sign_in)||void 0===j?void 0:j.authToken)&&window.localStorage.setItem("AuthToken",O),setTimeout(t,100),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(6),"One time password missing"===e.t0.message?m(!0):(C(!0),A(e.t0.message));case 18:x(!1);case 19:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}(),V=R?'url("'.concat(R,'")'):"url(".concat(Ib,")");return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(P.a,{container:!0,component:"main",className:n.root,children:[Object(W.jsx)(f.a,{}),Object(W.jsx)(P.a,{item:!0,xs:!1,sm:4,md:7,className:n.image,style:{backgroundImage:V}}),Object(W.jsx)(P.a,{item:!0,xs:12,sm:8,md:5,component:X.a,elevation:6,square:!0,children:Object(W.jsxs)("div",{className:n.paper,children:[M&&Object(W.jsx)("img",{src:M,className:n.brandingLogo}),Object(W.jsx)(Db.a,{className:n.avatar,children:Object(W.jsx)(Ut.a,{})}),Object(W.jsx)(v.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(W.jsxs)("form",{className:n.form,noValidate:!0,onSubmit:H,children:[Object(W.jsx)(je.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,inputRef:i}),Object(W.jsx)(Nn,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",id:"password",autoComplete:"current-password",inputRef:s}),Object(W.jsx)(je.a,{style:{display:p?"block":"none"},variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"oneTimePassword",label:"One time password",type:"text",id:"oneTimePassword",autoComplete:"off",inputRef:o}),Object(W.jsx)(hn.a,{control:Object(W.jsx)(bt.a,{value:"remember",color:"primary"}),label:"Remember me",inputRef:c}),Object(W.jsxs)("div",{className:n.wrapper,children:[Object(W.jsx)(z.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:g,className:n.submit,children:"Sign In"}),g&&Object(W.jsx)($.a,{size:24,className:n.buttonProgress})]}),Object(W.jsx)(D.a,{mt:5,children:Object(W.jsx)(Ub,{})})]})]})})]}),Object(W.jsx)(bi,{isOpen:S,closeMe:function(){C(!1)},message:I})]})}var Eb,qb=Object(x.a)({depositContext:{flex:1},wrapper:{margin:"1em 0",position:"relative"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}});function Rb(e){var t=e.onSubmit,n=(e.defaultDomain,e.loading),i=qb(),s=Object(a.useRef)(),c=Object(a.useRef)();Object(a.useRef)();return Object(W.jsx)(r.a.Fragment,{children:Object(W.jsxs)("form",{className:i.form,noValidate:!0,onSubmit:function(e){e.preventDefault();var n=s.current.value,a=c.current.value;t(n,a)},children:[Object(W.jsx)(v.a,{className:i.title,variant:"h6",id:"tableTitle",component:"div",style:{textAlign:"left"},children:"Connection Login"}),Object(W.jsx)("br",{}),Object(W.jsxs)(P.a,{container:!0,spacing:0,children:[Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(je.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,inputRef:s})}),Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsx)(je.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",inputRef:c})}),Object(W.jsx)(P.a,{item:!0,xs:12,children:Object(W.jsxs)("div",{className:i.wrapper,children:[Object(W.jsx)(z.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:n,className:i.submit,children:"Connect"}),n&&Object(W.jsx)($.a,{size:24,className:i.buttonProgress})]})})]})]})})}var Bb,Wb,zb=Object(Z.b)(Eb||(Eb=Object(p.a)(["\nmutation ($accessRuleId: String!, $connectionId: String!, $extra: json) {\n  action_sess_connect(accessRuleId: $accessRuleId, connectionId: $connectionId, extra: $extra) {\n    tokenPayload\n    meta\n  }\n}\n"]))),Gb=Object(x.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},cont:{backgroundColor:"#fafafa;"}}}));function Kb(e){var t=e.error,n=Object(Je.a)(zb),a=Object(d.a)(n,1)[0],i=Gb(),s=r.a.useState({shown:!1,loading:!1,username:"",domain:"",password:""}),c=Object(d.a)(s,2),o=c[0],u=c[1],p=new URLSearchParams(window.location.search),m=p.get("c"),O=p.get("a"),h=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,r,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){return new Promise((function(t){return setTimeout(t,e)}))},e.next=3,n(1e3);case 3:return e.prev=3,e.next=6,a({variables:{connectionId:m,accessRuleId:O,extra:t}});case 6:(null===(i=e.sent)||void 0===i||null===(r=i.data)||void 0===r?void 0:r.action_sess_connect.tokenPayload)&&(s=i.data.action_sess_connect.tokenPayload,window.localStorage.setItem("GUAC_AUTH",s),window.location="/tunnel-service/"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),"credentials_required"===e.t0.message?u((function(e){return Object(l.a)(Object(l.a)({},e),{},{shown:!0})})):(alert(e.t0.message),window.close());case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();r.a.useEffect((function(){h()}),[]);var g=function(){var e=Object(j.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u((function(e){return Object(l.a)(Object(l.a)({},e),{},{loading:!0})})),e.next=3,h({credentials:{username:t,password:n}});case 3:u((function(e){return Object(l.a)(Object(l.a)({},e),{},{loading:!1})}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(W.jsxs)(N.a,{component:"main",maxWidth:"s",className:i.cont,children:[Object(W.jsx)(f.a,{}),o.shown?Object(W.jsx)(P.a,{item:!0,xs:12,md:4,lg:3,style:{textAlign:"center",margin:"20px auto "},children:Object(W.jsx)(X.a,{style:{padding:"15px"},children:Object(W.jsx)(Rb,{onSubmit:g,loading:o.loading})})}):Object(W.jsxs)("div",{className:i.root,children:[Object(W.jsx)("div",{className:i.paper,children:Object(W.jsx)(v.a,{component:"h1",variant:"h5",style:{marginTop:"30px"},children:t||"Connecting..."})}),Object(W.jsx)("div",{style:{maxWidth:"400px",margin:"2em auto"},children:t?Object(W.jsx)(xt.a,{variant:"determinate",value:100}):Object(W.jsx)(xt.a,{})})]})]})}var Hb=Object(Z.b)(Bb||(Bb=Object(p.a)(["\nmutation {\n  action_auth_sign_out {\n    success\n  }\n}\n"]))),Vb=Object(Z.b)(Wb||(Wb=Object(p.a)(["\nquery ACTION_AUTH_STATUS {\n    action_auth_status {\n        id\n        role\n        username\n        meta\n    }\n}\n"]))),Yb=Object(a.forwardRef)((function(e,t){Object(a.useImperativeHandle)(t,(function(){return{recheckAuth:function(){return Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g();case 1:case"end":return e.stop()}}),e)})))()}}}));var n=Object(a.useRef)("/dashboard"),r=Object(Je.a)(Hb),i=Object(d.a)(r,1)[0],s=Object(a.useState)({id:null,role:"",username:""}),c=Object(d.a)(s,2),o=c[0],l=c[1],u=Object(Oe.h)(),p=Object(Oe.g)(),m=Object(ee.a)(Vb),O=m.data,h=m.error,g=m.refetch;Object(a.useEffect)((function(){l(null===O||void 0===O?void 0:O.action_auth_status)}),[O,l]),Object(a.useEffect)(Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("user"!==(null===O||void 0===O||null===(t=O.action_auth_status)||void 0===t?void 0:t.role)){e.next=7;break}return l(!1),n.current="/dashboard",e.next=5,i();case 5:e.sent.data.action_auth_sign_out.success&&p.replace("/sign-in");case 7:case"end":return e.stop()}}),e)})))),["/","/connect","/sign-in"].includes(u.pathname)||(n.current=u.pathname);return Object(W.jsx)("div",{className:"App",children:Object(W.jsxs)(Oe.d,{children:[Object(W.jsx)(Oe.b,{exact:!0,path:"/",children:Object(W.jsx)(Cb,{authError:h,authLoading:h,loggedInUser:o,intendedUrl:n.current})}),Object(W.jsxs)(Oe.b,{exact:!0,path:"/sign-in",children:[(null===o||void 0===o?void 0:o.id)&&Object(W.jsx)(Oe.a,{to:n.current}),null===(null===o||void 0===o?void 0:o.id)&&Object(W.jsx)(Oe.a,{to:n.current}),!(null===o||void 0===o?void 0:o.id)&&Object(W.jsx)(Lb,{onSignIn:function(){g()}})]}),Object(W.jsx)(Oe.b,{exact:!0,path:"/connect",children:Object(W.jsx)(Kb,{})}),Object(W.jsxs)(Oe.b,{path:"/dashboard",children:[!(null===o||void 0===o?void 0:o.id)&&Object(W.jsx)(Oe.a,{to:"/"}),(null===o||void 0===o?void 0:o.id)&&Object(W.jsx)(kb,{loggedInUser:o,setLoggedInUser:l,intendedUrl:n,refetchAuthStatus:g})]})]})})})),Qb=n(675),Jb=n(231),Xb=n(674),Zb=n(676),ej=n(671),tj=n(672),nj=n(485);var aj=function(){var e=r.a.useRef(),t=new Qb.a({uri:"/data-service"}),n=Object(nj.a)((function(e){if(e.graphQLErrors){var t,n,a,r=null!==(t=null===e||void 0===e||null===(n=e.graphQLErrors)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.message)&&void 0!==t?t:"";if("ACTION_AUTH_SIGN_IN"===e.operation)return;if(!r.includes("not found in type: 'query_root'")&&!r.includes("not found in type: 'mutation_root'"))return;console.log("gql sign-out suspicious error: ",e)}})),a=new Jb.a((function(e,t){return e.setContext((function(e){var t=window.localStorage.getItem("AuthToken");if(t)return{headers:Object(l.a)(Object(l.a)({},e.headers),{},{authorization:"Bearer ".concat(t)})}})),t(e)})),i=new Xb.a({cache:new Zb.a,link:Object(ej.a)([n,a,t]),defaultOptions:{query:{fetchPolicy:"no-cache"},watchQuery:{fetchPolicy:"no-cache"}}});return Object(W.jsx)(tj.a,{client:i,children:Object(W.jsx)(Yb,{ref:e})})};s.a.render(Object(W.jsx)(r.a.StrictMode,{children:Object(W.jsx)(o.a,{children:Object(W.jsx)(aj,{})})}),document.getElementById("root")),c()}},[[564,1,2]]]);